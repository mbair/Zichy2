"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[9474],{9474:(v,_,l)=>{l.d(_,{w:()=>s});var r=l(2029),m=l(6223),C=l(7394),p=l(219),g=l(5219),f=l(4055),u=l(9515);const S=["conferenceSelector"];function O(t,c){1&t&&r._uU(0),2&t&&r.hij(" ",c.$implicit.name," ")}function d(t,c){1&t&&r._uU(0),2&t&&r.hij(" ",c.$implicit.name," ")}const b={id:-1,name:"\u2014 Nincs, vagy nincs enged\xe9lyezett konferenci\xe1ja \u2014",__none__:!0};let s=(()=>{class t{set preselectIds(e){const i=(Array.isArray(e)?e:null!=e?[e]:[]).map(o=>"string"==typeof o?Number(o):o).filter(o=>Number.isFinite(o));this._pendingSelectIds=i.length?i:void 0,this.preselectByIds()}runSilently(e){this.suppress++;try{return e()}finally{this.suppress--}}constructor(e,n,i){this.conferenceService=e,this.messageService=n,this.cdr=i,this.selectFirstOption=!1,this.showClear=!0,this.showNoneOption=!0,this.style={},this.disabledOptions=[],this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new r.vpe,this.loading=!0,this.disabled=!1,this.conferences=[],this.originalConferences=[],this.selectedConferences=[],this.subscriptions=new C.w0,this.suppress=0,this.isNone=o=>!!o?.__none__||-1===o?.id,this.getNone=()=>b,this.onChange=o=>{},this.onTouched=()=>{}}ngOnInit(){const e=this.conferenceService.getSelector$({sort:"beginDate",order:"asc",enabled:1}).subscribe({next:n=>{const i=n??[],o=this.showNoneOption?[b,...i]:[...i];this.conferences=o,this.originalConferences=[...o],this.syncSelectedConferences(),this.handleSelectFirstOption(),this.updateDisabledFlags(),this.preselectByIds(),this.loading=!1},error:()=>{this.conferences=[],this.originalConferences=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load conferences. Please try again later."})}});this.subscriptions.add(e)}ngOnChanges(e){e.disabledOptions&&this.originalConferences.length>0&&this.updateDisabledFlags(),e.preselectIds&&this.preselectByIds()}ngOnDestroy(){this.subscriptions.unsubscribe()}updateDisabledFlags(){const e=Array.isArray(this.disabledOptions)?this.disabledOptions:[];this.conferences=this.originalConferences.map(n=>({...n,disabled:!this.isNone(n)&&e.some(i=>i?.id===n.id)})),this.cdr.markForCheck()}setSelection(e,n){const i=n?.source??"programmatic";this.runSilently(()=>{this.selectedConferences=this.normalizeSelection(e)}),n?.emit?this.emit(this.selectedConferences,i,!0):this.cdr.markForCheck()}handleSelectFirstOption(){if(!this.selectFirstOption||this.selectedConferences.length||!this.conferences.length)return;const e=this.conferences.find(n=>!this.isNone(n)&&!n.disabled);e?(this.runSilently(()=>{this.selectedConferences=[e]}),this.emitOnSelectFirstOption?this.emit(this.selectedConferences,"auto-select-first",!0):this.cdr.markForCheck()):this.cdr.markForCheck()}preselectByIds(){if(!this.conferences?.length||!this._pendingSelectIds?.length)return;const e=new Set(this._pendingSelectIds),n=this.conferences.filter(i=>!this.isNone(i)&&e.has(Number(i.id)));this.runSilently(()=>{this.selectedConferences=n.slice(0,this.selectionLimit??n.length),this.conferenceSelectorRef?.writeValue(this.selectedConferences)}),this.emitOnPreselectId?this.emit(this.selectedConferences,"preselect-id",!0):this.cdr.markForCheck()}setDisabledState(e){this.disabled=e}syncSelectedConferences(){const e=Array.isArray(this.selectedConferences)?this.selectedConferences:[];this.selectedConferences=this.conferences.filter(n=>e.some(i=>i?.id===n?.id)),this.onChange(this.selectedConferences),this.cdr.markForCheck()}onSelectionChange(e){const n=Array.isArray(e?.value)?e.value:[];this.selectedConferences=this.normalizeSelection(n),this.emit(this.selectedConferences,"user"),1==this.selectionLimit&&this.selectedConferences?.length>=1&&setTimeout(()=>this.conferenceSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedConferences=[],this.conferenceSelectorRef?.writeValue([])}),this.emit(this.selectedConferences,"user",!0)}normalizeSelection(e){const n=Array.isArray(e)?e:[];return n.some(a=>this.isNone(a))?[this.getNone()]:n.slice(0,this.selectionLimit??n.length)}emit(e,n,i=!1){this.suppress&&!i||(this.onChange(e),this.onTouched(),this.change.emit({value:e,source:n}),this.cdr.markForCheck())}writeValue(e){const n=Array.isArray(e)?e:e?[e]:[];this.runSilently(()=>{this.selectedConferences=this.normalizeSelection(n)}),this.emitOnWriteValue?this.emit(this.selectedConferences,"programmatic",!0):this.cdr.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static#e=this.\u0275fac=function(n){return new(n||t)(r.Y36(p.Z),r.Y36(g.ez),r.Y36(r.sBO))};static#t=this.\u0275cmp=r.Xpm({type:t,selectors:[["app-conference-selector"]],viewQuery:function(n,i){if(1&n&&r.Gf(S,5),2&n){let o;r.iGM(o=r.CRH())&&(i.conferenceSelectorRef=o.first)}},inputs:{selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",showNoneOption:"showNoneOption",style:"style",disabledOptions:"disabledOptions",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[r._Bn([{provide:m.JU,useExisting:(0,r.Gpc)(()=>t),multi:!0}]),r.TTD],decls:5,vars:14,consts:[["dataKey","id","optionLabel","name","optionDisabled","disabled","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","resetFilterOnHide","ngModelChange","onChange","onClear"],["conferenceSelector",""],["pTemplate","item"],["pTemplate","selectedItem"]],template:function(n,i){1&n&&(r.TgZ(0,"p-multiSelect",0,1),r.NdJ("ngModelChange",function(a){return i.selectedConferences=a})("onChange",function(a){return i.onSelectionChange(a)})("onClear",function(){return i.onSelectionClear()}),r.ALo(2,"translate"),r.YNc(3,O,1,1,"ng-template",2),r.YNc(4,d,1,1,"ng-template",3),r.qZA()),2&n&&(r.Akn(i.style),r.s9C("emptyMessage",r.lcZ(2,12,"Nincs tal\xe1lat...")),r.Q6J("options",i.conferences)("ngModel",i.selectedConferences)("disabled",i.disabled)("selectionLimit",i.selectionLimit)("placeholder",i.placeholder)("virtualScroll",!0)("virtualScrollItemSize",43)("showClear",i.showClear)("resetFilterOnHide",!0))},dependencies:[m.JJ,m.On,g.jx,f.NU,u.X$],encapsulation:2,changeDetection:0})}return t})()},219:(v,_,l)=>{l.d(_,{Z:()=>O});var r=l(5619),m=l(7398),C=l(6306),p=l(2096),g=l(940),f=l(9862),u=l(2029),S=l(8814);let O=(()=>{class d{constructor(s,t){this.apiService=s,this.http=t,this.apiURL=s.apiURL,this.data$=new r.X(null),this.message$=new r.X(null)}get conferenceObs(){return this.data$.asObservable()}get messageObs(){return this.message$.asObservable()}get(s,t,c,e){const n=localStorage.getItem("userrole"),i=localStorage.getItem("userid");if("Szervezo"===n&&i){const h=`organizer_user_id=${i}`;e=e?`${e}&${h}`:h}e.includes("enabled=")||(e=e?`${e}&enabled=1`:"enabled=1");let o="";""!==c&&(o=`sort=${c.sortField&&""!==c.sortField?c.sortField:"beginDate"}&order=${1===c.sortOrder?"ASC":"DESC"}`);const a=""!==o&&""!==e?o+"&"+e:""!==o&&""===e?o:""===o&&""!==e?e:"";this.apiService.get(`conference/get/${s}/${t}${""!==a?"?"+a:""}`).subscribe({next:h=>{this.data$.next(h)},error:h=>{this.message$.next(h)}})}getBySearch(s,t){let c="";""!==t&&(c=""!=t.sortField?`?sort=${t.sortField}&order=${1===t.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`conference/search/${s}${c}`).subscribe({next:e=>{this.data$.next(e)},error:e=>{this.message$.next(e)}})}getBySearchQuery(s){this.apiService.get(`conference/searchquery?${s}`).subscribe({next:t=>{this.data$.next(t)},error:t=>{this.message$.next(t)}})}create(s){this.apiService.post("conference/create/",s).subscribe({next:t=>{this.message$.next({severity:"success",summary:"Sikeres konferencia r\xf6gz\xedt\xe9s",detail:`${s.name} r\xf6gz\xedtve`})},error:t=>{this.message$.next(t)}})}update(s){this.apiService.put(`conference/update/${s.id}`,s).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres konferencia m\xf3dos\xedt\xe1s",detail:`${s.name} m\xf3dos\xedtva`})},error:t=>{this.message$.next(t)}})}delete(s){this.apiService.delete(`conference/delete/${s.id}`).subscribe({next:t=>{this.message$.next({severity:"success",summary:"Sikeres konferencia t\xf6rl\xe9s",detail:`${s.name} t\xf6r\xf6lve`})},error:t=>{this.message$.next(t)}})}bulkdelete(s){let t={ids:s.map(c=>c.id)};this.apiService.post("conference/bulkdelete",t).subscribe({next:c=>{this.message$.next({severity:"success",summary:"Sikeres konferencia t\xf6rl\xe9s",detail:`${s.length} konferencia t\xf6r\xf6lve`})},error:c=>{this.message$.next(c)}})}getById(s){return this.apiService.get(`conference/getbyid/${s}`)}isSlugValid(s){return this.get(0,20,"slug=","sort"),this.data$.pipe((0,m.U)(t=>t&&t.data&&t.rows.length>0),(0,C.K)(()=>(0,p.of)(!1)))}assignRoomsToConference(s,t){return this.apiService.post(`conferencesroom/addroom/${s.id}`,{roomIds:t})}removeRoomsFromConference(s,t){return this.apiService.post(`conferencesroom/removeroom/${s}`,{roomIds:t})}saveFormFieldInfos(s){this.apiService.post(`conference/saveFormFieldInfos/${s.conferenceId}`,s.fields).subscribe({next:t=>{this.message$.next({severity:"success",summary:"Mez\u0151 inform\xe1ci\xf3k mentve",detail:"\u0170rlap mez\u0151 inform\xe1ci\xf3k sikeresen mentve"})},error:t=>{this.message$.next(t)}})}getSelector$(s={}){const c=this.buildSelectorParams(s).toString();return this.apiService.get("conference/selector"+(c?`?${c}`:"")).pipe((0,g.d)(1))}clearSelectorCache(){this.selectorCache$=void 0}buildSelectorParams(s){let t=new f.LE;if(void 0!==s.enabled){const c="boolean"==typeof s.enabled?s.enabled?"1":"0":String(s.enabled);t=t.set("enabled",c)}else t=t.set("enabled","1");return s.sort&&(t=t.set("sort",s.sort)),s.order&&(t=t.set("order",s.order)),t}getConferenceStatsByIds(s){if(!s||0===s.length)return(0,p.of)({});const c=(new f.LE).set("ids",s.join(",")).toString();return this.apiService.get(`conference/stats?${c}`)}getConferenceStat(s){return this.getConferenceStatsByIds([s]).pipe((0,m.U)(t=>t[s]??t[String(s)]??{guests:0,beds:0}))}static#e=this.\u0275fac=function(t){return new(t||d)(u.LFG(S.s),u.LFG(f.eN))};static#t=this.\u0275prov=u.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);