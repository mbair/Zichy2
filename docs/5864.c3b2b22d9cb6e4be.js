"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[5864],{5864:(V,f,o)=>{o.r(f),o.d(f,{ReservationModule:()=>$e});var p=o(6814),u=o(6223),_=o(1640),b=o(7582),h=o(8645),d=o(5619),E=o(3997),K=o(3620),y=o(7398),P=o(4279),C=o(5219),q=o(1116),j=o(217),T=o(6676),e=o(2029),H=o(2096),G=o(8814),X=o(9862),Z=o(9515);let A=(()=>{class i{constructor(n,t,r){this.apiService=n,this.http=t,this.translate=r,this.cache=[],this.apiURL=n.apiURL,this.data$=new d.X(null),this.message$=new d.X(null)}get reservationObs(){return this.data$.asObservable()}get messageObs(){return this.message$.asObservable()}get(n,t,r,a){let l="";""!==r&&(l=""!=r.sortField?`sort=${r.sortField}&order=${1===r.sortOrder?"ASC":"DESC"}`:"");const g=""!==l&&""!==a?l+"&"+a:""!==l&&""===a?l:""===l&&""!==a?a:"";this.apiService.get(`reservation/get/${n}/${t}${""!==g?"?"+g:""}`).subscribe({next:c=>{this.data$.next(c)},error:c=>{this.message$.next(c)}})}getBySearch(n,t){let r="";""!==t&&(r=""!=t.sortField?`?sort=${t.sortField}&order=${1===t.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`reservation/search/${n}${r}`).subscribe({next:a=>{this.data$.next(a)},error:a=>{this.message$.next(a)}})}getBySearchQuery(n){this.apiService.get(`reservation/searchquery?${n}`).subscribe({next:t=>{this.data$.next(t)},error:t=>{this.message$.next(t)}})}create(n){this.apiService.post("reservation/create/",n).subscribe({next:t=>{this.message$.next({severity:"success",summary:"Sikeres szoba r\xf6gz\xedt\xe9s",detail:`${n.id} sz\xe1m\xfa szoba r\xf6gz\xedtve`})},error:t=>{this.message$.next(t)}})}update(n){this.apiService.put(`reservation/update/${n.id}`,n).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres szoba m\xf3dos\xedt\xe1s",detail:`${n.id} sz\xe1m\xfa szoba m\xf3dos\xedtva`})},error:t=>{this.message$.next(t)}})}delete(n){this.apiService.delete(`reservation/delete/${n.id}`).subscribe({next:t=>{this.message$.next({severity:"success",summary:"Sikeres szoba t\xf6rl\xe9s",detail:`${n.id} sz\xe1m\xfa szoba t\xf6r\xf6lve`})},error:t=>{this.message$.next(t)}})}bulkdelete(n){let t={ids:n.map(r=>r.id)};this.apiService.post("reservation/bulkdelete",t).subscribe({next:r=>{this.message$.next({severity:"success",summary:"Sikeres szoba t\xf6rl\xe9s",detail:`${n.length} szoba t\xf6r\xf6lve`})},error:r=>{this.message$.next(r)}})}getReservationsForSelector(){return this.cache.length>0?(0,H.of)(this.cache):(this.get(0,999,{sortField:"reservationNum",sortOrder:1},""),this.data$.asObservable().pipe((0,y.U)(n=>{const t=n?n.rows:[];return this.cache=t,t})))}getReservationTypeByCode(n,t){return[{code:"KB",beds:4,label:this.translate.instant("ROOMTYPES.CASTLE"),description:this.translate.instant("ROOMTYPES.4-BED-ROOM"),value:"Kast\xe9ly sz\xe1ll\xe1s 4 \xe1gyas szoba",color:"teal"},{code:"KB",beds:6,label:this.translate.instant("ROOMTYPES.CASTLE"),description:this.translate.instant("ROOMTYPES.6-BED-ROOM"),value:"Kast\xe9ly sz\xe1ll\xe1s 6 \xe1gyas szoba",color:"teal"},{code:"KB",beds:8,label:this.translate.instant("ROOMTYPES.CASTLE"),description:this.translate.instant("ROOMTYPES.8-BED-ROOM"),value:"Kast\xe9ly sz\xe1ll\xe1s 8 \xe1gyas szoba",color:"teal"},{code:"MD",beds:2,label:this.translate.instant("ROOMTYPES.MARANATHA-PENSION-HOUSE"),description:this.translate.instant("ROOMTYPES.2-BED-ROOM"),value:"Maranatha Panzi\xf3h\xe1z 2 \xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{code:"MQ",beds:2,label:this.translate.instant("ROOMTYPES.MARANATHA-PENSION-HOUSE"),description:this.translate.instant("ROOMTYPES.DOUBLE-BED-ROOM"),value:"Maranatha Panzi\xf3h\xe1z francia\xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{code:"MB",beds:4,label:this.translate.instant("ROOMTYPES.MARANATHA-PENSION-HOUSE"),description:this.translate.instant("ROOMTYPES.M-4-BED-ROOM"),value:"Maranatha Panzi\xf3h\xe1z 4 \xe1gyas szoba (emeletes \xe1gyas, k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{code:"A",label:this.translate.instant("ROOMTYPES.FAMILY-ROOM"),description:this.translate.instant("ROOMTYPES.WITH-KITCHEN"),value:"Csal\xe1di szoba (k\xf6z\xf6s konyh\xe1val, f\xfcrd\u0151vel \xe9s nappalival)",color:"orange"}].find(l=>l.code===n&&(void 0===l.beds||l.beds===t))}static#e=this.\u0275fac=function(t){return new(t||i)(e.LFG(G.s),e.LFG(X.eN),e.LFG(Z.sK))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var W=o(1206),ee=o(219),te=o(8022),m=o(9552),R=o(707),S=o(4480),O=o(4104),D=o(3714),M=o(7213),z=o(7680),k=o(4204),N=o(9246),ne=o(9474),se=o(3069),re=o(2991),U=o(3259),I=o(6651),J=o(8039),w=o(8676),$=o(3212),L=o(2169);const ie=function(){return{minWidth:"35rem"}};function oe(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"div",36)(1,"h5",37),e._uU(2,"Foglal\xe1sok"),e.qZA(),e.TgZ(3,"span",38)(4,"app-conference-selector",39),e.NdJ("ngModelChange",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.selectedConferences=r)})("ngModelChange",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.doQuery())}),e.qZA()(),e.TgZ(5,"span",40)(6,"div",41)(7,"div",42)(8,"div",43),e.O4$(),e.TgZ(9,"svg",44),e._UZ(10,"g",45)(11,"g",46),e.TgZ(12,"g",47)(13,"g",48)(14,"g",49),e._UZ(15,"path",50),e.qZA()()()(),e.kcU(),e.TgZ(16,"span",51),e._uU(17),e.qZA()()()()(),e.TgZ(18,"span",38)(19,"button",52),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.create())}),e.qZA(),e.TgZ(20,"button",53),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.bulkDeleteDialog=!0)}),e.qZA()()()}if(2&i){const n=e.oxw();e.xp6(4),e.Akn(e.DdM(8,ie)),e.Q6J("ngModel",n.selectedConferences)("showClear",!0),e.xp6(2),e.MGl("pTooltip","\xc1gyak sz\xe1ma: ",n.numberOfBeds,""),e.xp6(11),e.hij(" ",n.numberOfBeds," "),e.xp6(2),e.Q6J("disabled",!n.canCreate),e.xp6(1),e.Q6J("disabled",!n.selected||!n.selected.length||!n.canDelete)}}function ae(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th",54),e._uU(3,"Szoba "),e._UZ(4,"p-sortIcon",55),e.qZA(),e.TgZ(5,"th",56),e._uU(6,"Vend\xe9gek "),e._UZ(7,"p-sortIcon",57),e.qZA(),e.TgZ(8,"th",58),e._uU(9,"\xc9rkez\xe9s "),e._UZ(10,"p-sortIcon",59),e.qZA(),e.TgZ(11,"th",60),e._uU(12,"T\xe1voz\xe1s "),e._UZ(13,"p-sortIcon",61),e.qZA(),e.TgZ(14,"th",62),e._uU(15,"St\xe1tusz "),e._UZ(16,"p-sortIcon",63),e.qZA(),e.TgZ(17,"th",64),e._uU(18,"Megjegyz\xe9s "),e._UZ(19,"p-sortIcon",65),e.qZA(),e._UZ(20,"th"),e.qZA(),e.TgZ(21,"tr")(22,"th",66),e._UZ(23,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(24,"th")(25,"input",67),e.NdJ("input",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"reservationNum"))}),e.qZA(),e.TgZ(26,"app-building-selector",68),e.NdJ("change",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"building"))}),e.qZA(),e.TgZ(27,"app-bedtype-selector",69),e.NdJ("change",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"bedType"))}),e.qZA()(),e.TgZ(28,"th")(29,"input",70),e.NdJ("input",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"guests"))}),e.qZA()(),e.TgZ(30,"th")(31,"p-calendar",71),e.NdJ("onSelect",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"dateOfArrival"))})("onClearClick",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"dateOfArrival"))}),e.qZA()(),e.TgZ(32,"th")(33,"p-calendar",71),e.NdJ("onSelect",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"dateOfDeparture"))})("onClearClick",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"dateOfDeparture"))}),e.qZA()(),e._UZ(34,"th"),e.TgZ(35,"th")(36,"input",72),e.NdJ("input",function(r){e.CHM(n);const a=e.oxw();return e.KtG(a.onFilter(r,"comment"))}),e.qZA()(),e._UZ(37,"th"),e.qZA()}2&i&&(e.xp6(26),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("showClear",!0),e.xp6(4),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showButtonBar",!0))}function le(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const n=e.oxw().$implicit;e.Gre("sparebed-badge ",n.spareBeds,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"SPAREBEDS."+(null==n.spareBeds?null:n.spareBeds.toUpperCase()))," ")}}function ue(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"div")(1,"p-chip",82),e.NdJ("onRemove",function(){const a=e.CHM(n).$implicit,l=e.oxw(2).$implicit,g=e.oxw();return e.KtG(g.onConferenceRemove(a,l))}),e.qZA()()}if(2&i){const n=s.$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("label",n.name)("removable",!t.isOrganizer)}}function ce(i,s){if(1&i&&(e.TgZ(0,"td")(1,"span",74),e._uU(2,"Konferenci\xe1k"),e.qZA(),e.YNc(3,ue,2,2,"div",81),e.qZA()),2&i){const n=e.oxw().$implicit;e.xp6(3),e.Q6J("ngForOf",n.conferences)}}function de(i,s){1&i&&e._UZ(0,"p-avatar",84),2&i&&e.s9C("pTooltip",s.$implicit.guestName)}function pe(i,s){if(1&i&&(e.TgZ(0,"td")(1,"span",74),e._uU(2,"Vend\xe9gek"),e.qZA(),e.TgZ(3,"p-avatarGroup"),e.YNc(4,de,1,1,"p-avatar",83),e.qZA()()),2&i){const n=e.oxw().$implicit;e.xp6(4),e.Q6J("ngForOf",n.guests)}}const me=function(){return{height:".5rem"}};function ge(i,s){if(1&i&&(e.TgZ(0,"td")(1,"span",74),e._uU(2,"Tel\xedtetts\xe9g"),e.qZA(),e._UZ(3,"p-progressBar",85),e.qZA()),2&i){const n=e.oxw().$implicit;e.xp6(3),e.Akn(e.DdM(6,me)),e.hYB("pTooltip","\xc1gy/vend\xe9g: ",n.beds,"/",null==n.guests?null:n.guests.length,""),e.Q6J("value",(null==n.guests?null:n.guests.length)/n.beds*100)("showValue",!1)}}function he(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",73),e.qZA(),e.TgZ(3,"td")(4,"span",74),e._uU(5,"Szoba sz\xe1m"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"span",74),e._uU(9,"P\xf3t\xe1gy"),e.qZA(),e.YNc(10,le,3,6,"span",75),e.qZA(),e.TgZ(11,"td",76)(12,"span",74),e._uU(13,"Komment"),e.qZA(),e._uU(14),e.qZA(),e.YNc(15,ce,4,1,"td",77),e.YNc(16,pe,5,1,"td",77),e.YNc(17,ge,4,7,"td",77),e.TgZ(18,"td")(19,"div",78)(20,"button",79),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.edit(a))}),e.qZA(),e.TgZ(21,"button",80),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return l.tableItem=a,e.KtG(l.deleteDialog=!0)}),e.qZA()()()()}if(2&i){const n=s.$implicit,t=e.oxw();e.xp6(2),e.Q6J("value",n),e.xp6(4),e.hij(" ",n.room.roomNum," "),e.xp6(4),e.Q6J("ngIf",n.spareBeds),e.xp6(4),e.hij(" ",n.comment," "),e.xp6(1),e.Q6J("ngIf",!t.selectedConferences.length),e.xp6(1),e.Q6J("ngIf",t.selectedConferences.length),e.xp6(1),e.Q6J("ngIf",t.selectedConferences.length),e.xp6(3),e.Q6J("disabled",!t.canEdit),e.xp6(1),e.Q6J("disabled",!t.canDelete)}}function ve(i,s){1&i&&(e.TgZ(0,"tr")(1,"td",86),e._uU(2,"Nincs tal\xe1lat..."),e.qZA()()),2&i&&(e.xp6(1),e.uIk("colspan",6))}function fe(i,s){if(1&i&&(e.TgZ(0,"span",87),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",null!=n.id&&n.id.value?"Foglal\xe1s adatai":"\xdaj foglal\xe1s"," ")}}function _e(i,s){1&i&&(e.TgZ(0,"div",88),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function be(i,s){1&i&&(e.TgZ(0,"div",88),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function Ce(i,s){1&i&&(e.TgZ(0,"div",88),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function Te(i,s){1&i&&(e.TgZ(0,"div",89),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function Ze(i,s){1&i&&(e.TgZ(0,"div",89),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function xe(i,s){1&i&&(e.TgZ(0,"div",89),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function Fe(i,s){1&i&&(e.TgZ(0,"div",89),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function Ee(i,s){1&i&&(e.TgZ(0,"div",88),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function ye(i,s){1&i&&(e.TgZ(0,"div",88),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function Ae(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"div",90)(1,"button",91),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.cancel())}),e.qZA(),e.TgZ(2,"button",92),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.save())}),e.qZA()()}if(2&i){const n=e.oxw();e.xp6(1),e.Q6J("disabled",!n.reservationForm.dirty),e.xp6(1),e.Q6J("disabled",!n.reservationForm.valid||!n.reservationForm.dirty)}}function Re(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"button",93),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.deleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",94),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.delete())}),e.qZA()}}function Se(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"button",93),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.bulkDeleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",94),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.deleteSelected())}),e.qZA()}}const Oe=function(){return["roomNum"]},De=function(){return{"min-height":"calc(100vh - 320px)"}},Y=function(i){return{"ng-invalid":i}},B=function(){return{width:"450px"}};T.locale("hu");let x=class F{constructor(s,n,t,r,a,l){this.reservationService=s,this.userService=n,this.conferenceService=t,this.messageService=r,this.responsiveService=a,this.fb=l,this.loading=!0,this.tableItem={},this.tableData=[],this.rowsPerPageOptions=[20,50,100,200],this.rowsPerPage=20,this.totalRecords=0,this.page=0,this.sortField="id",this.sortOrder=1,this.globalFilter="",this.filterValues={},this.debounce={},this.sidebar=!1,this.deleteDialog=!1,this.bulkDeleteDialog=!1,this.selected=[],this.canCreate=!1,this.canEdit=!1,this.canDelete=!1,this.isMobile=!1,this.isOrganizer=!1,this.selectedConferences=[],this.numberOfBeds=0,this.conferenceStart=null,this.conferenceEnd=null,this.initialFormValues={id:null,room_id:null,conference:null,conference_id:null,startDate:"",endDate:"",status:"",notes:"",guestIds:[]},this.formChanges$=new h.x,this.reservationForm=this.fb.group({id:[this.initialFormValues.id],room_id:[this.initialFormValues.room_id,u.kI.required],conference:[this.initialFormValues.conference,u.kI.required],conference_id:[this.initialFormValues.conference_id,u.kI.required],startDate:[this.initialFormValues.startDate,u.kI.required],endDate:[this.initialFormValues.endDate,u.kI.required],status:[this.initialFormValues.status,u.kI.required],notes:[this.initialFormValues.notes],guestIds:[this.initialFormValues.guestIds,u.kI.required]},{validators:(0,q.W)("startDate","endDate")}),this.isFormValid$=new d.X(!1)}ngOnInit(){this.userService.hasRole(["Super Admin","Nagy Admin"]).subscribe(s=>this.canCreate=s),this.userService.hasRole(["Super Admin","Nagy Admin"]).subscribe(s=>this.canEdit=s),this.userService.hasRole(["Super Admin","Nagy Admin"]).subscribe(s=>this.canDelete=s),this.userService.hasRole(["Szervezo"]).subscribe(s=>this.isOrganizer=s),this.reservationObs$=this.reservationService.reservationObs,this.reservationObs$.subscribe(s=>{this.loading=!1,s&&(this.tableData=s.rows||[],this.totalRecords=s.totalItems||0,this.page=s.currentPage||0,this.numberOfBeds=s.numberOfBeds||0)}),this.conference?.valueChanges.pipe((0,E.x)()).subscribe(s=>{this.reservationForm.patchValue({conference_id:s?s[0]?.id:null},{emitEvent:!1}),this.reservationForm.patchValue({startDate:s?s[0]?.beginDate:null,endDate:s?s[0]?.endDate:null},{emitEvent:!1})}),this.responsiveService.isMobile$.subscribe(s=>{this.isMobile=s}),this.isFormValid$=this.formChanges$.pipe((0,K.b)(300),(0,E.x)(),(0,y.U)(()=>this.reservationForm.valid)),this.serviceMessageObs$=this.reservationService.messageObs,this.conferenceMessageObs$=this.conferenceService.messageObs,this.serviceMessageObs$.subscribe(s=>this.handleMessage(s)),this.conferenceMessageObs$.subscribe(s=>this.handleMessage(s))}get id(){return this.reservationForm.get("id")}get room_id(){return this.reservationForm.get("room_id")}get conference(){return this.reservationForm.get("conference")}get conference_id(){return this.reservationForm.get("conference_id")}get startDate(){return this.reservationForm.get("startDate")}get endDate(){return this.reservationForm.get("endDate")}get status(){return this.reservationForm.get("status")}get notes(){return this.reservationForm.get("notes")}get guestIds(){return this.reservationForm.get("guestIds")}doQuery(){if(this.isOrganizer&&!this.selectedConferences.length)return;this.loading=!0,this.filterValues.conferences=this.selectedConferences.map(t=>t.id).join(",");const n=Object.keys(this.filterValues).map(t=>this.filterValues[t].length>0?`${t}=${this.filterValues[t]}`:"").filter(t=>t.length>0).join("&");return""!==this.globalFilter?this.reservationService.getBySearch(this.globalFilter,{sortField:this.sortField,sortOrder:this.sortOrder}):this.reservationService.get(this.page,this.rowsPerPage,{sortField:this.sortField,sortOrder:this.sortOrder},n)}onFilter(s,n){if(this.isOrganizer&&!this.selectedConferences)return;let r="";s instanceof Date?r=T(s).format("YYYY.MM.DD"):s&&(s.value||s.target?.value)?(r=s.value||s.target?.value,r=r.toString()):this.filterValues[n]="",this.filterValues[n]=r,["conferenceName","building","bedType","spareBeds"].includes(n)?this.filterValues[n]===r&&this.doQuery():(this.debounce[n]&&clearTimeout(this.debounce[n]),this.debounce[n]=setTimeout(()=>{this.filterValues[n]===r&&this.doQuery()},500))}onLazyLoad(s){this.page=s.first/s.rows,this.rowsPerPage=s.rows??this.rowsPerPage,this.sortField=s.sortField??"",this.sortOrder=s.sortOrder??1,this.globalFilter=s.globalFilter??"",this.doQuery()}onGlobalFilter(s,n){s.filterGlobal(n.target.value,"contains")}create(){this.reservationForm.reset(this.initialFormValues),this.sidebar=!0}edit(s){this.reservationForm.reset(this.initialFormValues),this.reservationForm.patchValue(s),this.originalFormValues=this.reservationForm.value,this.sidebar=!0}delete(){this.loading=!0,this.deleteDialog=!1,this.reservationService.delete(this.tableItem)}deleteSelected(){this.loading=!0,this.bulkDeleteDialog=!1,this.reservationService.bulkdelete(this.selected)}save(){if(this.reservationForm.valid){this.loading=!0;const s=this.reservationForm.value;console.log("SAVE",s),s.id?this.reservationService.update(s):this.reservationService.create(s),this.sidebar=!1}}cancel(){this.reservationForm.reset(this.originalFormValues)}handleMessage(s){s&&(this.loading=!1,"ERROR"==s?this.messageService.add({severity:"error",summary:"Error",detail:"Hiba t\xf6rt\xe9nt!"}):(this.messageService.add(s),this.tableItem={},this.selected=[],this.doQuery()))}onConferenceRemove(s,n){}exportExcel(){o.e(1486).then(o.bind(o,1486)).then(s=>{const n=[{key:"reservationNum",label:"Szoba-sz\xe1m"},{key:"reservationCode",label:"Szoba k\xf3d"},{key:"beds",label:"\xc1gyak sz\xe1ma"},{key:"spareBeds",label:"Matrac / gyerek\xe1gy"},{key:"building",label:"\xc9p\xfclet / folyos\xf3"},{key:"bedType",label:"\xc1gy t\xedpus"},{key:"bathreservation",label:"F\xfcrd\u0151szoba"},{key:"notes",label:"Megjegyz\xe9s"}],r=(this.selected.length>0?this.selected:this.tableData).map(v=>{let c={};return n.forEach(Q=>{c[Q.label]=v[Q.key]??""}),c}),l={Sheets:{data:s.utils.json_to_sheet(r,{header:n.map(v=>v.label)})},SheetNames:["data"]},g=s.write(l,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(g,"reservations")})}saveAsExcelFile(s,n){const a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});j.saveAs(a,n+"_export_"+T().format("YYYYMMDD")+".xlsx")}fromYMD(s){const[n,t,r]=s.split("-").map(Number);return new Date(n,t-1,r)}toYMD(s){return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}ngOnDestroy(){}static#e=this.\u0275fac=function(n){return new(n||F)(e.Y36(A),e.Y36(W.K),e.Y36(ee.Z),e.Y36(C.ez),e.Y36(te.k),e.Y36(u.qu))};static#t=this.\u0275cmp=e.Xpm({type:F,selectors:[["reservation-component"]],features:[e._Bn([C.ez])],decls:67,vars:56,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-0","py-0"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","{first} - {last} bejegyz\xe9s a(z) {totalRecords}-b\xf3l megjelen\xedt\xe9se","selectionMode","multiple",3,"value","rows","totalRecords","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","tableStyle","rowHover","lazy","selectionChange","onLazyLoad"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["id","sidebar","position","right","styleClass","p-sidebar-md",3,"visible","transitionOptions","fullScreen","blockScroll","visibleChange"],["novalidate","",1,"grid","formgrid","p-fluid",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden"],["formControlName","conference_id","type","hidden"],[1,"field","mb-4","col-12"],["for","conference",1,"font-medium","text-900"],["formControlName","conference","placeholder","V\xe1lasszon konferenci\xe1t...",3,"selectionLimit","showClear"],["class","block p-error",4,"ngIf"],["for","room_id",1,"font-medium","text-900"],["id","room_id","type","text","pInputText","","formControlName","room_id"],["for","guestIds",1,"font-medium","text-900"],["id","guestIds","type","text","pInputText","","formControlName","guestIds"],[1,"field","mb-4","col-6"],["for","startDate",1,"font-medium","text-900"],["id","startDate","formControlName","startDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass","disabled"],["class","p-error",4,"ngIf"],["for","endDate",1,"font-medium","text-900"],["id","endDate","formControlName","endDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass","disabled"],["for","status",1,"font-medium","text-900"],["id","status","type","text","pInputText","","formControlName","status"],["for","notes",1,"font-medium","text-900"],["id","notes","type","text","pInputText","","formControlName","notes"],["pTemplate","footer"],["header","T\xf6rl\xe9s",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[3,"autoZIndex","blocked"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0"],["placeholder","V\xe1lasszon konferenci\xe1t...",3,"ngModel","showClear","ngModelChange"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0",2,"background-color","#E2E8F0",3,"pTooltip"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],["width","24px","height","24px","viewBox","0 0 24 24","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#000000"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","ic_fluent_bed_24_filled","fill","#334155","fill-rule","nonzero"],["d","M19.25,11 C20.7125318,11 21.9084043,12.1417046 21.9949812,13.5824777 L22,13.75 L22,20.25 C22,20.6642136 21.6642136,21 21.25,21 C20.8703042,21 20.556509,20.7178461 20.5068466,20.3517706 L20.5,20.25 L20.5,18 L3.5,18 L3.5,20.25 C3.5,20.6296958 3.21784612,20.943491 2.85177056,20.9931534 L2.75,21 C2.37030423,21 2.05650904,20.7178461 2.00684662,20.3517706 L2,20.25 L2,13.75 C2,12.2874682 3.1417046,11.0915957 4.58247767,11.0050188 L4.75,11 L19.25,11 Z M6.75,4 L17.25,4 C18.7125318,4 19.9084043,5.1417046 19.9949812,6.58247767 L20,6.75 L20,10 L17,10 L16.9932723,9.88337887 C16.9399506,9.42429701 16.575703,9.06004937 16.1166211,9.00672773 L16,9 L14,9 C13.4871642,9 13.0644928,9.38604019 13.0067277,9.88337887 L13,10 L11,10 L10.9932723,9.88337887 C10.9399506,9.42429701 10.575703,9.06004937 10.1166211,9.00672773 L10,9 L8,9 C7.48716416,9 7.06449284,9.38604019 7.00672773,9.88337887 L7,10 L4,10 L4,6.75 C4,5.28746816 5.1417046,4.09159572 6.58247767,4.00501879 L6.75,4 Z"],[1,"text-2xl","font-normal","white-space-nowrap","vertical-align-middle"],["pButton","","pRipple","","label","\xdaj","icon","pi pi-plus",1,"p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","label","T\xf6rl\xe9s","icon","pi pi-trash",1,"p-button-danger","mr-2",3,"disabled","click"],["pSortableColumn","roomNum"],["field","roomNum"],["pSortableColumn","guests"],["field","guests"],["pSortableColumn","dateOfArrival"],["field","dateOfArrival"],["pSortableColumn","dateOfDeparture"],["field","dateOfDeparture"],["pSortableColumn","status"],["field","status"],["pSortableColumn","comment"],["field","comment"],["styleClass","w-3rem"],["pInputText","","type","text","placeholder","Szobasz\xe1m...",1,"mr-2",2,"width","8rem",3,"input"],["placeholder","\xc9p\xfclet...",1,"mr-2",3,"showClear","change"],["placeholder","\xc1gytipus...",3,"showClear","change"],["pInputText","","type","text","placeholder","Vend\xe9g...",2,"width","7rem",3,"input"],["appendTo","body","dataType","string","placeholder","Keres\xe9s...",3,"showButtonBar","onSelect","onClearClick"],["pInputText","","type","text","placeholder","Keres\xe9s...",2,"width","7rem",3,"input"],[3,"value"],[1,"p-column-title"],[3,"class",4,"ngIf"],[2,"max-width","300px"],[4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"disabled","click"],[4,"ngFor","ngForOf"],["styleClass","m-1","icon","pi pi-calendar",3,"label","removable","onRemove"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip",4,"ngFor","ngForOf"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip"],["tooltipPosition","top",3,"value","showValue","pTooltip"],[1,"text-center"],[1,"font-semibold","text-xl"],[1,"block","p-error"],[1,"p-error"],[1,"flex","justify-content-end","ap-2"],["pButton","","pRipple","","label","M\xe9gsem","icon","pi pi-times",1,"p-button-outlined",3,"disabled","click"],["pButton","","pRipple","","label","Ment\xe9s","icon","pi pi-check",1,"p-button","ml-2",3,"disabled","click"],["pButton","","pRipple","","label","Nem","icon","pi pi-times",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Igen","icon","pi pi-check",1,"p-button","ml-2",3,"click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(a){return t.selected=a})("onLazyLoad",function(a){return t.onLazyLoad(a)}),e.YNc(5,oe,21,9,"ng-template",5),e.YNc(6,ae,38,4,"ng-template",6),e.YNc(7,he,22,9,"ng-template",7),e.YNc(8,ve,3,1,"ng-template",8),e.qZA()(),e.TgZ(9,"p-sidebar",9),e.NdJ("visibleChange",function(a){return t.sidebar=a}),e.YNc(10,fe,2,1,"ng-template",6),e.TgZ(11,"form",10),e.NdJ("ngSubmit",function(){return t.save()}),e._UZ(12,"input",11)(13,"input",12),e.TgZ(14,"div",13)(15,"label",14),e._uU(16),e.qZA(),e._UZ(17,"app-conference-selector",15),e.YNc(18,_e,2,0,"div",16),e.qZA(),e.TgZ(19,"div",13)(20,"label",17),e._uU(21,"Szoba ID"),e.qZA(),e._UZ(22,"input",18),e.YNc(23,be,2,0,"div",16),e.qZA(),e.TgZ(24,"div",13)(25,"label",19),e._uU(26,"Vend\xe9g ID"),e.qZA(),e._UZ(27,"input",20),e.YNc(28,Ce,2,0,"div",16),e.qZA(),e.TgZ(29,"div",21)(30,"label",22),e._uU(31),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"p-calendar",23),e.YNc(34,Te,3,3,"div",24),e.YNc(35,Ze,3,3,"div",24),e.qZA(),e.TgZ(36,"div",21)(37,"label",25),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"p-calendar",26),e.YNc(41,xe,3,3,"div",24),e.YNc(42,Fe,3,3,"div",24),e.qZA(),e.TgZ(43,"div",13)(44,"label",27),e._uU(45,"St\xe1tusz"),e.qZA(),e._UZ(46,"input",28),e.YNc(47,Ee,2,0,"div",16),e.qZA(),e.TgZ(48,"div",13)(49,"label",29),e._uU(50,"Megjegyz\xe9s"),e.qZA(),e._UZ(51,"input",30),e.YNc(52,ye,2,0,"div",16),e.qZA()(),e.YNc(53,Ae,3,2,"ng-template",31),e.qZA(),e.TgZ(54,"p-dialog",32),e.NdJ("visibleChange",function(a){return t.deleteDialog=a}),e.TgZ(55,"div",33),e._UZ(56,"i",34),e.qZA(),e.YNc(57,Re,2,0,"ng-template",31),e.qZA(),e.TgZ(58,"p-dialog",32),e.NdJ("visibleChange",function(a){return t.bulkDeleteDialog=a}),e.TgZ(59,"div",33),e._UZ(60,"i",34),e.TgZ(61,"span"),e._uU(62,"Biztosan t\xf6r\xf6lni akarja a kiv\xe1lasztott foglal\xe1sokat?"),e.qZA()(),e.YNc(63,Se,2,0,"ng-template",31),e.qZA()()(),e.TgZ(64,"p-blockUI",35),e._UZ(65,"p-progressSpinner"),e.qZA(),e._UZ(66,"p-toast")),2&n){let r;e.xp6(3),e.Q6J("value",t.tableData)("rows",t.rowsPerPage)("totalRecords",t.totalRecords)("globalFilterFields",e.DdM(48,Oe))("paginator",!0)("rowsPerPageOptions",t.rowsPerPageOptions)("showCurrentPageReport",!0)("selection",t.selected)("tableStyle",e.DdM(49,De))("rowHover",!0)("lazy",!0),e.xp6(6),e.Q6J("visible",t.sidebar)("transitionOptions",".3s cubic-bezier(0, 0, 0.2, 1)")("fullScreen",t.isMobile)("blockScroll",!0),e.xp6(2),e.Q6J("formGroup",t.reservationForm),e.xp6(5),e.hij("Konferencia ",null!==(r=null==(r=t.reservationForm.get("conference_id"))?null:r.value)&&void 0!==r?r:"\u2014",""),e.xp6(1),e.Q6J("selectionLimit",1)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.conference?null:t.conference.dirty)&&(null==t.conference||null==t.conference.errors?null:t.conference.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.room_id?null:t.room_id.dirty)&&(null==t.room_id||null==t.room_id.errors?null:t.room_id.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.guestIds?null:t.guestIds.dirty)&&(null==t.guestIds||null==t.guestIds.errors?null:t.guestIds.errors.required)),e.xp6(3),e.hij(" ",e.lcZ(32,44,"\xc9rkez\xe9s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(50,Y,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid))("disabled",!t.conferenceStart),e.xp6(1),e.Q6J("ngIf",(null==t.startDate?null:t.startDate.dirty)&&(null==t.startDate||null==t.startDate.errors?null:t.startDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(3),e.hij(" ",e.lcZ(39,46,"T\xe1voz\xe1s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(52,Y,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid))("disabled",!t.conferenceEnd),e.xp6(1),e.Q6J("ngIf",(null==t.endDate?null:t.endDate.dirty)&&(null==t.endDate||null==t.endDate.errors?null:t.endDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(5),e.Q6J("ngIf",(null==t.status?null:t.status.dirty)&&(null==t.status||null==t.status.errors?null:t.status.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.notes?null:t.notes.dirty)&&(null==t.notes||null==t.notes.errors?null:t.notes.errors.required)),e.xp6(2),e.Akn(e.DdM(54,B)),e.Q6J("visible",t.deleteDialog)("modal",!0),e.xp6(4),e.Akn(e.DdM(55,B)),e.Q6J("visible",t.bulkDeleteDialog)("modal",!0),e.xp6(6),e.Q6J("autoZIndex",!0)("blocked",t.loading)}},dependencies:[p.mk,p.sg,p.O5,m.iA,C.jx,m.lQ,m.fz,m.UA,m.Mo,u._Y,u.Fj,u.JJ,u.JL,u.On,u.sg,u.u,R.Hq,S.H,O.FN,D.o,M.V,z.G,k.b,N.Y,ne.w,se.n,re.p,U.u,I.k,J.q,w.H,$.f,L.A,Z.X$],encapsulation:2})};x=(0,b.gn)([(0,P.k)()],x);let Me=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[_.Bz.forChild([{path:"",component:x}]),_.Bz]})}return i})();var ze=o(3965),ke=o(6263),Ne=o(9502),Ue=o(5609),Ie=o(7902),Je=o(1865),we=o(2285);let $e=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({providers:[A],imports:[p.ez,Me,m.U$,u.u5,u.UX,R.hJ,S.T,O.EV,D.j,ze.kW,M.S,ke.W,Ne.$,z.L,k.u,N.l,we.L,Ue.Iu,U.z,I.q,J.F,w.Q,Ie.JH,Je.cc,Z.aw,$._8,L.o]})}return i})()},1116:(V,f,o)=>{function p(u,_){return b=>{const h=b.get(u)?.value,d=b.get(_)?.value;return h&&d&&(new Date(h)>new Date(d)||new Date(d)<new Date(h))?{dateRangeInvalid:!0}:null}}o.d(f,{W:()=>p})}}]);