"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[8359],{8359:(ee,$,c)=>{c.r($),c.d($,{ReservationModule:()=>zs});var f=c(6814),_=c(6223),O=c(1640),U=c(7582),D=c(8645),w=c(5619),J=c(2181),E=c(7398),A=c(3997),z=c(2832),d=c(9360),p=c(4829),v=c(8251),x=c(4825);var te=c(4664),j=c(3620),Ee=c(8180),Ae=c(4279),S=c(5219),Ze=c(1116);const oe=()=>function we(n){const i=t=>(t??[]).map(s=>{const o=n(s);return null==o?"\u2400":"number"==typeof o?`#${o}`:`@${o}`}).sort().join("|");return(0,A.x)((t,s)=>i(t)===i(s))}(n=>n.id);var re=c(9474),Fe=c(217),F=c(6676),e=c(2029),Re=c(2096),Ne=c(9397),ke=c(8814),Y=c(9515);let ae=(()=>{class n{get messageObs(){return this.message$.asObservable()}constructor(t,s){this.apiService=t,this.translate=s,this.cache=[],this.message$=new w.X(null),this.apiURL=t.apiURL}get$(t,s,o,r){let a="";""!==o&&(a=o.sortField?`sort=${o.sortField}&order=${1===o.sortOrder?"ASC":"DESC"}`:"");const l=a&&r?`${a}&${r}`:a||r||"";return this.apiService.get(`reservation/get/${t}/${s}${l?`?${l}`:""}`)}getBySearch$(t,s){let o="";return""!==s&&(o=""!==s.sortField?`?sort=${s.sortField}&order=${1===s.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`reservation/search/${t}${o}`)}getBySearchQuery$(t){return this.apiService.get(`reservation/searchquery?${t}`)}getReservationsForSelector(){return this.cache.length?(0,Re.of)(this.cache):this.apiService.get("reservation/get/0/999?sort=reservationNum&order=ASC").pipe((0,E.U)(t=>t?.rows??[]),(0,Ne.b)(t=>{this.cache=t}))}create(t){this.apiService.post("reservation/create/",t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s r\xf6gz\xedt\xe9s",detail:"Foglal\xe1s r\xf6gz\xedtve"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem menthet\u0151",detail:this.localizeError(s)})}})}update(t){this.apiService.put(`reservation/update/${t.id}`,t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s m\xf3dos\xedt\xe1s",detail:"Foglal\xe1s m\xf3dos\xedtva"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem m\xf3dos\xedthat\xf3",detail:this.localizeError(s)})}})}delete(t){this.apiService.delete(`reservation/delete/${t.id}`).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:"Foglal\xe1s t\xf6r\xf6lve"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(s)})}})}bulkdelete(t){const s={ids:t.map(o=>o.id)};this.apiService.post("reservation/bulkdelete",s).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:`${t.length} foglal\xe1s t\xf6r\xf6lve`})},error:o=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(o)})}})}getRawBackendMessage(t){const s=t?.error;if(s&&"object"==typeof s&&"message"in s&&s.message)return String(s.message);if("string"==typeof s)try{const o=JSON.parse(s);if(o?.message)return String(o.message)}catch{return s}return t?.message??"Unknown error"}localize(t){return this.translate.instant(t)}localizeError(t){return this.localize(this.getRawBackendMessage(t))}static#e=this.\u0275fac=function(s){return new(s||n)(e.LFG(ke.s),e.LFG(Y.sK))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Me=c(1206),Oe=c(219),De=c(8022),V=c(9552),P=c(707),H=c(4480),le=c(4104),ce=c(3714),ue=c(7213),de=c(7680),pe=c(4204),me=c(9246),Le=c(3069),Ge=c(2991),he=c(3965);function ze(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=i.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function Be(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=i.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function $e(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",2),e.NdJ("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(o))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,ze,3,6,"ng-template",3),e.YNc(4,Be,3,6,"ng-template",4),e.qZA()}if(2&n){const t=i.ngIf,s=e.oxw();e.s9C("placeholder",e.lcZ(1,5,s.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("formControl",t)("options",s.statuses)("showClear",s.showClear)}}function Ue(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=i.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function je(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=i.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function Ye(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",5),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedStatus=o)})("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(o))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,Ue,3,6,"ng-template",3),e.YNc(4,je,3,6,"ng-template",4),e.qZA()}if(2&n){const t=e.oxw();e.s9C("placeholder",e.lcZ(1,5,t.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("ngModel",t.selectedStatus)("options",t.statuses)("showClear",t.showClear)}}let Je=(()=>{class n{constructor(t,s){this.translate=t,this.cdRef=s,this.change=new e.vpe,this.statuses=[],this.selectedStatus="",this.disabled=!1,this.onChange=o=>{},this.onTouched=()=>{},this.placeholder||(this.placeholder="V\xe1lasszon...")}ngOnInit(){this.translate.onLangChange.subscribe(()=>{this.setReservationStatuses()}),this.setReservationStatuses()}ngOnChanges(t){this.setReservationStatuses()}getFormControl(){return this.parentForm&&this.controlName?this.parentForm.get(this.controlName):null}setReservationStatuses(){this.statuses=[{label:"tentative",value:"tentative"},{label:"confirmed",value:"confirmed"},{label:"in_house",value:"in_house"},{label:"checked_out",value:"checked_out"},{label:"cancelled",value:"cancelled"}]}handleOnChange(t){this.selectedStatus=t.value,this.onChange(t.value),this.onTouched(),this.change.emit({value:t.value,field:this.controlName})}setDisabledState(t){this.disabled=t,this.cdRef.detectChanges()}writeValue(t){this.selectedStatus=t,this.cdRef.detectChanges()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(Y.sK),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-reservation-status-selector"]],inputs:{parentForm:"parentForm",controlName:"controlName",placeholder:"placeholder",showClear:"showClear"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:3,vars:2,consts:[["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange",4,"ngIf","ngIfElse"],["useNgModel",""],["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange"],["pTemplate","item"],["pTemplate","selectedItem"],["optionLabel","label","optionValue","value","appendTo","body",3,"ngModel","options","placeholder","emptyMessage","showClear","ngModelChange","onChange"]],template:function(s,o){if(1&s&&(e.YNc(0,$e,5,9,"p-dropdown",0),e.YNc(1,Ye,5,9,"ng-template",null,1,e.W1O)),2&s){const r=e.MAs(2);e.Q6J("ngIf",o.getFormControl())("ngIfElse",r)}},dependencies:[f.O5,_.JJ,_.On,_.oH,S.jx,he.Lt,Y.X$],encapsulation:2})}return n})();var ge=c(7394),Qe=c(4520),fe=c(4055),W=c(3259);const Ve=["roomSelector"];function Pe(n,i){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function qe(n,i){1&n&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function Ke(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function He(n,i){if(1&n&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,Pe,2,1,"span",11),e.YNc(12,qe,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,Ke,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&n){const t=i.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function We(n,i){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function Xe(n,i){1&n&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function et(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function tt(n,i){if(1&n&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,We,2,1,"span",11),e.YNc(12,Xe,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,et,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&n){const t=i.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}let st=(()=>{class n{set preselectIds(t){const o=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=o.length?o:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,s,o){this.roomService=t,this.messageService=s,this.cdr=o,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.rooms=[],this.originalRooms=[],this.selectedRooms=[],this.subscriptions=new ge.w0,this.suppress=0,this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.rooms=[],this.loading=!1,void this.cdr.markForCheck();const s=(this.selectedRooms??[]).map(u=>this.toNumId(u?.id)).filter(u=>null!=u),r=Array.from(new Set([...s,...this._pendingSelectIds??[]])),a={...t,...r.length?{includeRoomIds:r}:{}},l=this.roomService.searchRoomsForSelector$(a).subscribe({next:u=>{this.rooms=u??[],this.originalRooms=this.rooms.slice(),this.loading=!1,this.syncSelectedRooms(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:u=>{this.rooms=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rooms."})}});this.subscriptions.add(l)}setSelection(t,s){const o=s?.source??"programmatic";this.runSilently(()=>{this.selectedRooms=t?.slice(0,this.selectionLimit??t.length)??[]}),s?.emit&&this.emit(this.selectedRooms,o,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedRooms.length&&this.rooms.length&&(this.runSilently(()=>{this.selectedRooms=this.rooms.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedRooms,"auto-select-first",!0))}preselectByIds(){if(!this.rooms?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),s=this.rooms.filter(l=>{const u=this.toNumId(l?.id);return null!=u&&t.has(u)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length,a=s.slice(0,r);this.runSilently(()=>{this.selectedRooms=a,this.roomSelectorRef?.writeValue(this.selectedRooms)}),this.onChange(this.selectedRooms),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedRooms,"preselect-id",!0),this._pendingSelectIds=void 0}setDisabledState(t){this.disabled=t,this.roomSelectorRef&&(this.roomSelectorRef.disabled=t)}syncSelectedRooms(){this.selectedRooms=this.rooms.filter(t=>{const s=this.toNumId(t?.id);return null!=s&&this.selectedRooms.some(o=>this.toNumId(o?.id)===s)}),this.onChange(this.selectedRooms)}onSelectionChange(t){this.selectedRooms=t.value||[],this.emit(this.selectedRooms,"user"),1==this.selectionLimit&&this.selectedRooms?.length>=1&&setTimeout(()=>this.roomSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedRooms=[],this.roomSelectorRef&&this.roomSelectorRef.writeValue([])}),this.emit(this.selectedRooms,"user",!0)}emit(t,s,o=!1){this.suppress&&!o||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:s}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}writeValue(t){const s=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length;this.runSilently(()=>{this.selectedRooms=s.slice(0,r),this.roomSelectorRef&&this.roomSelectorRef.writeValue(this.selectedRooms)}),this.emitOnWriteValue&&this.emit(this.selectedRooms,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(Qe.X),e.Y36(S.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-room-selector"]],viewQuery:function(s,o){if(1&s&&e.Gf(Ve,5),2&s){let r;e.iGM(r=e.CRH())&&(o.roomSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:5,vars:13,consts:[["dataKey","id","optionLabel","roomNum","optionDisabled","disabled","filterBy","roomNum","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["roomSelector",""],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"]],template:function(s,o){1&s&&(e.TgZ(0,"p-multiSelect",0,1),e.NdJ("ngModelChange",function(a){return o.selectedRooms=a})("onChange",function(a){return o.onSelectionChange(a)})("onClear",function(){return o.onSelectionClear()}),e.ALo(2,"translate"),e.YNc(3,He,17,14,"ng-template",2),e.YNc(4,tt,17,14,"ng-template",3),e.qZA()),2&s&&(e.Akn(o.style),e.s9C("emptyMessage",e.lcZ(2,11,"Nincs tal\xe1lat...")),e.Q6J("options",o.rooms)("ngModel",o.selectedRooms)("disabled",o.disabled)("selectionLimit",o.selectionLimit)("placeholder",o.placeholder)("virtualScroll",!0)("virtualScrollItemSize",50)("showClear",o.showClear))},dependencies:[f.O5,_.JJ,_.On,S.jx,fe.NU,W.u,Y.X$],encapsulation:2,changeDetection:0})}return n})();var it=c(746),_e=c(2169);const nt=["guestSelector"];function ot(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-chip",8),e.NdJ("onRemove",function(){const r=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.removeGuest(r))}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(2);e.s9C("pTooltip",t.roomMate),e.Q6J("label",t.lastName+" "+t.firstName)("removable",!0)("styleClass","cursor-pointer color-badge "+s.getColorByRoomType((null==t?null:t.roomType)||""))}}function rt(n,i){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,ot,1,4,"p-chip",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.selectedGuests)("ngForTrackBy",t.trackByGuestId)}}const at=function(n,i,t){return{"pi-check-square":n,"pi-minus-square":i,"pi-square":t}};function lt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(o){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.toggleGroupSelection(a,o))}),e._UZ(1,"i",10),e.TgZ(2,"span",11),e._uU(3),e.qZA(),e.TgZ(4,"span",12),e._uU(5),e.qZA()()}if(2&n){const t=i.$implicit,s=e.oxw();e.Q6J("pTooltip",t.explanation),e.xp6(1),e.Q6J("ngClass",e.kEZ(4,at,s.isGroupFullySelected(t),s.isGroupPartiallySelected(t),!s.isGroupFullySelected(t)&&!s.isGroupPartiallySelected(t))),e.xp6(2),e.Oqu(t.label),e.xp6(2),e.hij("(",t.items.length," f\u0151)")}}function ct(n,i){1&n&&(e.TgZ(0,"span",21),e._uU(1,"\u2744\ufe0f"),e.qZA())}function ut(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function dt(n,i){if(1&n&&(e.TgZ(0,"div")(1,"div",13)(2,"div",14)(3,"div",15)(4,"span",16),e._uU(5),e.TgZ(6,"span",17),e._uU(7),e.qZA(),e.YNc(8,ct,2,0,"span",18),e.qZA(),e.TgZ(9,"span",19),e._uU(10),e.YNc(11,ut,2,1,"span",20),e._uU(12,") "),e.qZA()()()()()),2&n){const t=i.$implicit,s=e.oxw();e.Gre("building-badge ",s.getColorByRoomType(t.roomType)," border-round-xl w-min p-0"),e.xp6(2),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",s.getAge(t.birthDate),")"),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function pt(n,i){if(1&n&&(e.TgZ(0,"div")(1,"div",13)(2,"div",22)(3,"div",15)(4,"span",16),e._uU(5),e.TgZ(6,"span",17),e._uU(7),e.qZA()(),e.TgZ(8,"span",19),e._uU(9),e.qZA(),e.TgZ(10,"div",23),e._uU(11),e.qZA()()()()()),2&n){const t=i.$implicit,s=e.oxw();e.Gre("color-badge ",s.getColorByRoomType(t.roomType)," border-round-xl w-min p-0"),e.xp6(2),e.s9C("pTooltip",t.roomMate),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",s.getAge(t.birthDate),")"),e.xp6(2),e.hij(" ",t.roomType," "),e.xp6(2),e.hij(" ",t.roomMate," ")}}F.locale("hu");let mt=(()=>{class n{set preselectIds(t){const o=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=o.length?o:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,s,o){this.guestService=t,this.messageService=s,this.cdr=o,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.groupByRoomMate=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.guests=[],this.originalGuests=[],this.selectedGuests=[],this.groupedGuests=[],this.roomTypes=[{value:"Nem k\xe9rek sz\xe1ll\xe1st",color:"gray"},{value:"Kast\xe9ly sz\xe1ll\xe1s 4 \xe1gyas szoba",color:"teal"},{value:"Kast\xe9ly sz\xe1ll\xe1s 6 \xe1gyas szoba",color:"teal"},{value:"Kast\xe9ly sz\xe1ll\xe1s 8 \xe1gyas szoba",color:"teal"},{value:"Maranatha Panzi\xf3h\xe1z 2 \xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Maranatha Panzi\xf3h\xe1z francia\xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Maranatha Panzi\xf3h\xe1z 4 \xe1gyas szoba (emeletes \xe1gyas, k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Csal\xe1di szoba (k\xf6z\xf6s konyh\xe1val, f\xfcrd\u0151vel \xe9s nappalival)",color:"orange"}],this.subscriptions=new ge.w0,this.suppress=0,this.roomTypeColorMap=new Map(this.roomTypes.map(r=>[r.value.toLowerCase(),r.color])),this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload(),t.preselectIds&&this.preselectByIds()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.guests=[],this.loading=!1,void this.cdr.markForCheck();const s=(this.selectedGuests??[]).map(l=>this.toNumId(l?.id)).filter(l=>null!=l),r=Array.from(new Set([...s,...this._pendingSelectIds??[]])),a={...t,...r.length?{includeGuestIds:r}:{}};this.reloadSub?.unsubscribe(),this.reloadSub=this.guestService.searchGuestsForSelector$(a).subscribe({next:l=>{let u=(l??[]).map(m=>({...m,fullName:`${m.lastName??""} ${m.firstName??""}`.trim()}));this.guests=u,this.groupedGuests=this.groupByRoomMate?this.buildRoomMateGroups(u):[],this.loading=!1,this.syncSelectedGuests(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:l=>{this.guests=[],this.loading=!1,this.cdr.markForCheck(),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load guests."})}}),this.subscriptions.add(this.reloadSub)}preselectByIds(){if(!this.guests?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),s=this.guests.filter(l=>{const u=this.toNumId(l?.id);return null!=u&&t.has(u)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length,a=s.slice(0,r);this.runSilently(()=>{this.selectedGuests=a,this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.onChange(this.selectedGuests),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedGuests,"preselect-id",!0),this._pendingSelectIds=void 0}buildRoomMateGroups(t){const s=h=>(h??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g," ").trim(),o=h=>`${h.lastName??""} ${h.firstName??""}`.trim()||(h.fullName??""),r=[];for(const h of t){const C=this.toNumId(h?.id);null!=C&&r.push({id:C,name:s(`${h.lastName??""} ${h.firstName??""}`),mates:s(h.roomMate),guest:h})}const a=new Map,l=new Map;r.forEach(h=>l.set(h.id,h));const u=h=>{let C=a.get(h);return C||(C=new Set,a.set(h,C)),C};for(let h=0;h<r.length;h++){const C=r[h];for(let g=h+1;g<r.length;g++){const I=r[g];C.name&&I.name&&(C.mates&&C.mates.includes(I.name)||I.mates&&I.mates.includes(C.name))&&(u(C.id).add(I.id),u(I.id).add(C.id))}}const m=new Set,b=new Set,T=[],N=h=>{const C=[h],g=[];for(m.add(h);C.length;){const I=C.pop();g.push(I);const Z=a.get(I);if(Z)for(const G of Z)m.has(G)||(m.add(G),C.push(G))}return g.forEach(I=>b.add(I)),g};for(const h of a.keys()){if(m.has(h))continue;const C=N(h);if(C.length>=2){const g=C.map(R=>l.get(R)).filter(R=>!!R);let I,Z=-1;for(const R of g){let M=0;for(const K of g)K.id!==R.id&&K.mates&&K.mates.includes(R.name)&&M++;(M>Z||M===Z&&I&&R.id<I.id)&&(Z=M,I=R)}const G=o(I?I.guest:g[0].guest),ie=g.map(R=>R.guest).sort((R,M)=>s(o(R)).localeCompare(s(o(M)))),q=[];for(const R of g){const M=R.guest.roomMate;if(M&&"string"==typeof M&&M.trim().length>0){const K=o(R.guest);q.push(`${K}: "${M.trim()}"`)}}const Bs=q.length>0?q.join("\n"):"K\xf6zvetett kapcsolat r\xe9v\xe9n";T.push({groupId:T.length,label:G?`${G} csoport`:"Szobat\xe1rs csoport",items:ie,explanation:Bs})}}const L=[];return r.forEach(h=>{b.has(h.id)||L.push(h.guest)}),L.length&&(L.sort((h,C)=>s(o(h)).localeCompare(s(o(C)))),T.push({groupId:T.length,label:"Nincs megadott szobat\xe1rs / egyed\xfcl lakna",items:L})),T.sort((h,C)=>{const g=C.items.length-h.items.length;return 0!==g?g:h.label.localeCompare(C.label)}),T}getGroupIds(t){return(t.items??[]).map(s=>this.toNumId(s?.id)).filter(s=>null!=s)}isGroupFullySelected(t){const s=this.getGroupIds(t);if(!s.length||!this.selectedGuests?.length)return!1;const o=new Set((this.selectedGuests??[]).map(r=>this.toNumId(r?.id)).filter(r=>null!=r));return s.every(r=>o.has(r))}isGroupPartiallySelected(t){const s=this.getGroupIds(t);if(!s.length||!this.selectedGuests?.length)return!1;const o=new Set((this.selectedGuests??[]).map(a=>this.toNumId(a?.id)).filter(a=>null!=a)),r=s.filter(a=>o.has(a)).length;return r>0&&r<s.length}toggleGroupSelection(t,s){s&&(s.stopPropagation(),s.preventDefault());const o=t.items??[],r=this.selectedGuests??[],a=new Set(r.map(b=>this.toNumId(b?.id)).filter(b=>null!=b)),l=this.getGroupIds(t),u=l.length>0&&l.every(b=>a.has(b));let m=r.slice();if(u)m=m.filter(b=>{const T=this.toNumId(b?.id);return null==T||!l.includes(T)});else{for(const N of o){const L=this.toNumId(N?.id);null!=L&&!a.has(L)&&m.push(N)}const T=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:m.length;m.length>T&&(m=m.slice(0,T))}this.runSilently(()=>{this.selectedGuests=m,this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.emit(this.selectedGuests,"user",!0),this.cdr.markForCheck()}setSelection(t,s){const o=s?.source??"programmatic";this.runSilently(()=>{this.selectedGuests=t?.slice(0,this.selectionLimit??t.length)??[]}),s?.emit&&this.emit(this.selectedGuests,o,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedGuests.length&&this.guests.length&&(this.runSilently(()=>{this.selectedGuests=this.guests.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedGuests,"auto-select-first",!0))}setDisabledState(t){this.disabled=t,this.guestSelectorRef&&(this.guestSelectorRef.disabled=t)}syncSelectedGuests(){this.selectedGuests=this.guests.filter(t=>{const s=this.toNumId(t?.id);return null!=s&&this.selectedGuests.some(o=>this.toNumId(o?.id)===s)}),this.onChange(this.selectedGuests)}onSelectionChange(t){this.selectedGuests=t.value,this.emit(this.selectedGuests,"user"),1==this.selectionLimit&&this.selectedGuests?.length>=1&&setTimeout(()=>this.guestSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedGuests=[],this.guestSelectorRef?.writeValue([])}),this.emit(this.selectedGuests,"user",!0)}emit(t,s,o=!1){this.suppress&&!o||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:s}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}getAge(t){if(!t)return"";const s=F(t);return F().diff(s,"years").toString()}getColorByRoomType(t){return t?this.roomTypeColorMap.get(t.trim().toLowerCase())??"":""}removeGuest(t){const s=(this.selectedGuests??[]).filter(o=>o.id!==t.id);this.selectedGuests=s,"function"==typeof this.onChange&&this.onChange(this.selectedGuests)}clearAllGuests(){this.selectedGuests=[],"function"==typeof this.onChange&&this.onChange(this.selectedGuests)}trackByGuestId(t,s){return s.id}writeValue(t){const s=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length;this.runSilently(()=>{this.selectedGuests=s.slice(0,r),this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.emitOnWriteValue&&this.emit(this.selectedGuests,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(it.Q),e.Y36(S.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-guest-selector"]],viewQuery:function(s,o){if(1&s&&e.Gf(nt,5),2&s){let r;e.iGM(r=e.CRH())&&(o.guestSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",groupByRoomMate:"groupByRoomMate",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:7,vars:15,consts:[["class","flex flex-wrap gap-2 mb-2",4,"ngIf"],["panelStyleClass","guest-multiselect-panel","dataKey","id","optionLabel","fullName","optionDisabled","disabled","optionGroupChildren","items","filterBy","lastName,firstName,roomMate","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","group","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["guestSelector",""],["pTemplate","group"],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","flex-wrap","gap-2","mb-2"],["icon","pi pi-user","tooltipPosition","top",3,"label","removable","styleClass","pTooltip","onRemove",4,"ngFor","ngForOf","ngForTrackBy"],["icon","pi pi-user","tooltipPosition","top",3,"label","removable","styleClass","pTooltip","onRemove"],["tooltipPosition","top",1,"flex","align-items-center","px-1","cursor-pointer","bg-surface-100",3,"pTooltip","click"],[1,"pi","mr-2",2,"font-size","1.3rem",3,"ngClass"],[1,"font-semibold"],[1,"ml-2","text-xs","text-500"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],[1,"font-normal","text-sm","uppercase"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"pl-1"],["tooltipPosition","top",1,"block","min-w-max",3,"pTooltip"],[1,"font-light","text-xs","white-space-nowrap","overflow-hidden","text-overflow-ellipsis","max-w-30rem"]],template:function(s,o){1&s&&(e.YNc(0,rt,2,2,"div",0),e.TgZ(1,"p-multiSelect",1,2),e.NdJ("ngModelChange",function(a){return o.selectedGuests=a})("onChange",function(a){return o.onSelectionChange(a)})("onClear",function(){return o.onSelectionClear()}),e.ALo(3,"translate"),e.YNc(4,lt,6,8,"ng-template",3),e.YNc(5,dt,13,11,"ng-template",4),e.YNc(6,pt,12,9,"ng-template",5),e.qZA()),2&s&&(e.Q6J("ngIf",null==o.selectedGuests?null:o.selectedGuests.length),e.xp6(1),e.Akn(o.style),e.s9C("emptyMessage",e.lcZ(3,13,"Nincs tal\xe1lat...")),e.Q6J("options",o.groupByRoomMate?o.groupedGuests:o.guests)("group",o.groupByRoomMate)("ngModel",o.selectedGuests)("disabled",o.disabled)("selectionLimit",o.selectionLimit)("placeholder",o.placeholder)("virtualScroll",!o.groupByRoomMate)("virtualScrollItemSize",o.groupByRoomMate?0:65)("showClear",o.showClear))},dependencies:[f.mk,f.sg,f.O5,_.JJ,_.On,_e.A,S.jx,fe.NU,W.u,Y.X$],styles:['@charset "UTF-8";[_nghost-%COMP%]     .guest-multiselect-panel .p-multiselect-items .p-multiselect-item{padding:.15rem .5rem!important}[_nghost-%COMP%]     .guest-multiselect-panel .p-multiselect-item-group{padding:.2rem .5rem!important}'],changeDetection:0})}return n})();var ve=c(8039),be=c(8676),ye=c(3212),Ce=c(6218),k=c(6825),B=c(2076),xe=c(2591),Se=c(7778),X=c(2332);const ht=["content"];function gt(n,i){1&n&&e.GkF(0)}function ft(n,i){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,gt,1,0,"ng-container",11),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngTemplateOutlet",t.headerTemplate)}}function _t(n,i){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Oqu(t.option("header"))}}const vt=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function bt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw(4);return e.KtG(r.close(o))})("keydown.enter",function(o){e.CHM(t);const r=e.oxw(4);return e.KtG(r.close(o))}),e._UZ(1,"TimesIcon"),e.qZA()}2&n&&e.Q6J("ngClass",e.DdM(1,vt))}function yt(n,i){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,_t,2,1,"span",12),e.TgZ(2,"div",13),e.YNc(3,bt,2,2,"button",14),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.option("header")),e.xp6(2),e.Q6J("ngIf",t.closable)}}function Ct(n,i){if(1&n&&e._UZ(0,"i",1),2&n){const t=e.oxw(3);e.Tol(t.option("icon")),e.Q6J("ngClass","p-confirm-dialog-icon")}}function xt(n,i){1&n&&e.GkF(0)}function St(n,i){if(1&n&&(e.TgZ(0,"div",17),e.Hsn(1),e.YNc(2,xt,1,0,"ng-container",11),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngTemplateOutlet",t.footerTemplate)}}function Tt(n,i){if(1&n&&e._UZ(0,"i"),2&n){const t=e.oxw(6);e.Tol(t.option("rejectIcon"))}}function It(n,i){1&n&&e._UZ(0,"TimesIcon",24),2&n&&e.Q6J("styleClass","p-button-icon-left")}function Et(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Tt,1,2,"i",22),e.YNc(2,It,1,1,"TimesIcon",23),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngIf",t.option("rejectIcon")),e.xp6(1),e.Q6J("ngIf",!t.option("rejectIcon"))}}function At(n,i){}function Zt(n,i){1&n&&e.YNc(0,At,0,0,"ng-template")}function wt(n,i){if(1&n&&(e.TgZ(0,"span",25),e.YNc(1,Zt,1,0,null,11),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngTemplateOutlet",t.rejectIconTemplate)}}function Ft(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.reject())}),e.YNc(1,Et,3,2,"ng-container",20),e.YNc(2,wt,2,1,"span",21),e.qZA()}if(2&n){const t=e.oxw(4);e.Tol(t.option("rejectButtonStyleClass")),e.Q6J("label",t.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),e.uIk("aria-label",t.rejectAriaLabel),e.xp6(1),e.Q6J("ngIf",!t.rejectIconTemplate),e.xp6(1),e.Q6J("ngIf",t.rejectIconTemplate)}}function Rt(n,i){if(1&n&&e._UZ(0,"i"),2&n){const t=e.oxw(6);e.Tol(t.option("acceptIcon"))}}function Nt(n,i){1&n&&e._UZ(0,"CheckIcon",24),2&n&&e.Q6J("styleClass","p-button-icon-left")}function kt(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Rt,1,2,"i",22),e.YNc(2,Nt,1,1,"CheckIcon",23),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngIf",t.option("acceptIcon")),e.xp6(1),e.Q6J("ngIf",!t.option("acceptIcon"))}}function Mt(n,i){}function Ot(n,i){1&n&&e.YNc(0,Mt,0,0,"ng-template")}function Dt(n,i){if(1&n&&(e.TgZ(0,"span",25),e.YNc(1,Ot,1,0,null,11),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngTemplateOutlet",t.acceptIconTemplate)}}function Lt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.accept())}),e.YNc(1,kt,3,2,"ng-container",20),e.YNc(2,Dt,2,1,"span",21),e.qZA()}if(2&n){const t=e.oxw(4);e.Tol(t.option("acceptButtonStyleClass")),e.Q6J("label",t.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),e.uIk("aria-label",t.acceptAriaLabel),e.xp6(1),e.Q6J("ngIf",!t.acceptIconTemplate),e.xp6(1),e.Q6J("ngIf",t.acceptIconTemplate)}}function Gt(n,i){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,Ft,3,7,"button",18),e.YNc(2,Lt,3,7,"button",18),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.option("rejectVisible")),e.xp6(1),e.Q6J("ngIf",t.option("acceptVisible"))}}const zt=function(n){return{"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":n}},Bt=function(n,i){return{transform:n,transition:i}},$t=function(n){return{value:"visible",params:n}};function Ut(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("@animation.start",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onAnimationStart(o))})("@animation.done",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onAnimationEnd(o))}),e.YNc(1,ft,2,1,"div",4),e.YNc(2,yt,4,2,"div",4),e.TgZ(3,"div",5,6),e.YNc(5,Ct,1,3,"i",7),e._UZ(6,"span",8),e.qZA(),e.YNc(7,St,3,1,"div",9),e.YNc(8,Gt,3,2,"div",9),e.qZA()}if(2&n){const t=e.oxw(2);e.Tol(t.styleClass),e.Q6J("ngClass",e.VKq(11,zt,t.rtl))("ngStyle",t.style)("@animation",e.VKq(16,$t,e.WLB(13,Bt,t.transformOptions,t.transitionOptions))),e.xp6(1),e.Q6J("ngIf",t.headerTemplate),e.xp6(1),e.Q6J("ngIf",!t.headerTemplate),e.xp6(3),e.Q6J("ngIf",t.option("icon")),e.xp6(1),e.Q6J("innerHTML",t.option("message"),e.oJD),e.xp6(1),e.Q6J("ngIf",t.footer||t.footerTemplate),e.xp6(1),e.Q6J("ngIf",!t.footer&&!t.footerTemplate)}}function jt(n,i){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,Ut,9,18,"div",2),e.qZA()),2&n){const t=e.oxw();e.Tol(t.maskStyleClass),e.Q6J("ngClass",t.getMaskClass()),e.xp6(1),e.Q6J("ngIf",t.visible)}}const Yt=[[["p-footer"]]],Jt=["p-footer"],Qt=(0,k.oQ)([(0,k.oB)({transform:"{{transform}}",opacity:0}),(0,k.jt)("{{transition}}",(0,k.oB)({transform:"none",opacity:1}))]),Vt=(0,k.oQ)([(0,k.jt)("{{transition}}",(0,k.oB)({transform:"{{transform}}",opacity:0}))]);let Pt=(()=>{class n{el;renderer;confirmationService;zone;cd;config;document;header;icon;message;get style(){return this._style}set style(t){this._style=t,this.cd.markForCheck()}styleClass;maskStyleClass;acceptIcon;acceptLabel;acceptAriaLabel;acceptVisible=!0;rejectIcon;rejectLabel;rejectAriaLabel;rejectVisible=!0;acceptButtonStyleClass;rejectButtonStyleClass;closeOnEscape=!0;dismissableMask;blockScroll=!0;rtl=!1;closable=!0;appendTo;key;autoZIndex=!0;baseZIndex=0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";focusTrap=!0;defaultFocus="accept";breakpoints;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(t){switch(this._position=t,t){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onHide=new e.vpe;footer;contentViewChild;templates;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"rejecticon":this.rejectIconTemplate=t.template;break;case"accepticon":this.acceptIconTemplate=t.template}})}headerTemplate;footerTemplate;rejectIconTemplate;acceptIconTemplate;confirmation;_visible;_style;maskVisible;documentEscapeListener;container;wrapper;contentContainer;subscription;maskClickListener;preWidth;_position="center";transformOptions="scale(0.7)";styleElement;id=(0,X.Th)();confirmationOptions;translationSubscription;constructor(t,s,o,r,a,l,u){this.el=t,this.renderer=s,this.confirmationService=o,this.zone=r,this.cd=a,this.config=l,this.document=u,this.subscription=this.confirmationService.requireConfirmation$.subscribe(m=>{m?m.key===this.key&&(this.confirmation=m,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:!1===this.confirmation.closeOnEscape||!0===this.confirmation.closeOnEscape?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:!1===this.confirmation.dismissableMask||!0===this.confirmation.dismissableMask?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new e.vpe,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new e.vpe,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}option(t){const s=this.confirmationOptions||this;if(s.hasOwnProperty(t))return s[t]}onAnimationStart(t){if("visible"===t.toState){this.container=t.element,this.wrapper=this.container?.parentElement,this.contentContainer=B.p.findSingle(this.container,".p-dialog-content"),this.container?.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();const s=this.getElementToFocus();s&&s.focus()}}onAnimationEnd(t){"void"===t.toState&&this.onOverlayHide()}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":default:return B.p.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return B.p.findSingle(this.container,".p-confirm-dialog-reject");case"close":return B.p.findSingle(this.container,".p-dialog-header-close");case"none":return null}}appendContainer(){this.appendTo&&("body"===this.appendTo?this.document.body.appendChild(this.wrapper):B.p.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&B.p.addClass(this.document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&B.p.removeClass(this.document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=this.document.createElement("style"),this.styleElement.type="text/css",this.document.head.appendChild(this.styleElement);let t="";for(let s in this.breakpoints)t+=`\n                    @media screen and (max-width: ${s}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[s]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=t}}close(t){this.confirmation?.rejectEvent&&this.confirmation.rejectEvent.emit(S.wB.CANCEL),this.hide(S.wB.CANCEL),t.preventDefault()}hide(t){this.onHide.emit(t),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(X.P9.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let t={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return t[this.getPositionClass().toString()]=!0,t}getPositionClass(){const s=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(o=>o===this.position);return s?`p-dialog-${s}`:""}bindGlobalListeners(){(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",s=>{if(27==s.which&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===X.P9.get(this.container)&&this.visible&&this.close(s),9===s.which&&this.focusTrap){s.preventDefault();let o=B.p.getFocusableElements(this.container);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);s.shiftKey?-1==r||0===r?o[o.length-1].focus():o[r-1].focus():-1==r||r===o.length-1?o[0].focus():o[r+1].focus()}else o[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&X.P9.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(this.document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(S.wB.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(S.wB.REJECT),this.hide(S.wB.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(S.ws.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(S.ws.REJECT)}static \u0275fac=function(s){return new(s||n)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(S.YP),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(S.b4),e.Y36(f.K0))};static \u0275cmp=e.Xpm({type:n,selectors:[["p-confirmDialog"]],contentQueries:function(s,o,r){if(1&s&&(e.Suo(r,S.$_,5),e.Suo(r,S.jx,4)),2&s){let a;e.iGM(a=e.CRH())&&(o.footer=a.first),e.iGM(a=e.CRH())&&(o.templates=a)}},viewQuery:function(s,o){if(1&s&&e.Gf(ht,5),2&s){let r;e.iGM(r=e.CRH())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:"acceptVisible",rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:"rejectVisible",acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",blockScroll:"blockScroll",rtl:"rtl",closable:"closable",appendTo:"appendTo",key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",transitionOptions:"transitionOptions",focusTrap:"focusTrap",defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},ngContentSelectors:Jt,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-dialog-message",3,"innerHTML"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button",3,"ngClass","click","keydown.enter"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"label","ngClass","click"],[4,"ngIf"],["class","p-button-icon-left",4,"ngIf"],[3,"class",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon-left"]],template:function(s,o){1&s&&(e.F$t(Yt),e.YNc(0,jt,2,4,"div",0)),2&s&&e.Q6J("ngIf",o.maskVisible)},dependencies:function(){return[f.mk,f.O5,f.tP,f.PC,P.Hq,H.H,Se.q,xe.n]},styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[(0,k.X$)("animation",[(0,k.eR)("void => visible",[(0,k._7)(Qt)]),(0,k.eR)("visible => void",[(0,k._7)(Vt)])])]},changeDetection:0})}return n})(),qt=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[f.ez,P.hJ,H.T,Se.q,xe.n,P.hJ,S.m8]})}return n})();const Kt=function(){return{minWidth:"35rem"}};function Ht(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"h5",18),e._uU(2,"Foglal\xe1sok"),e.qZA(),e.TgZ(3,"span",19)(4,"app-conference-selector",20),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedConferences=o)})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.doQuery())}),e.qZA()(),e.TgZ(5,"span",21)(6,"div",22)(7,"div",23)(8,"div",24),e.O4$(),e.TgZ(9,"svg",25),e._UZ(10,"g",26)(11,"g",27),e.TgZ(12,"g",28)(13,"g",29)(14,"g",30),e._UZ(15,"path",31),e.qZA()()()(),e.kcU(),e.TgZ(16,"span",32),e._uU(17),e.qZA()()()()(),e.TgZ(18,"span",21)(19,"div",22)(20,"div",23)(21,"div",24),e._UZ(22,"i",33),e.TgZ(23,"span",32),e._uU(24),e.qZA()()()()(),e.TgZ(25,"span",21)(26,"div",34)(27,"div",23)(28,"div",24),e._UZ(29,"i",33),e.TgZ(30,"span",32),e._uU(31),e.qZA()()()()(),e.TgZ(32,"span",21)(33,"div",35)(34,"div",23)(35,"div",24),e._UZ(36,"i",33),e.TgZ(37,"span",32),e._uU(38),e.qZA()()()()(),e.TgZ(39,"span",19)(40,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.create())}),e.qZA(),e.TgZ(41,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.bulkDeleteDialog=!0)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Akn(e.DdM(17,Kt)),e.Q6J("ngModel",t.selectedConferences)("emitOnSelectFirstOption",!0)("showNoneOption",!1)("selectionLimit",1)("showClear",!0),e.xp6(2),e.MGl("pTooltip","\xc1gyak sz\xe1ma: ",t.totalBeds,""),e.xp6(11),e.hij(" ",t.totalBeds," "),e.xp6(2),e.MGl("pTooltip","Regisztr\xe1lt vend\xe9gek: ",t.registeredGuests,""),e.xp6(5),e.hij(" ",t.registeredGuests," "),e.xp6(2),e.MGl("pTooltip","Vend\xe9gek foglal\xe1ssal: ",t.reservedGuests,""),e.xp6(5),e.hij(" ",t.reservedGuests," "),e.xp6(2),e.MGl("pTooltip","Szob\xe1ra v\xe1r\xf3k: ",t.waitingForRoom,""),e.xp6(5),e.hij(" ",t.waitingForRoom," "),e.xp6(2),e.Q6J("disabled",!t.canCreate),e.xp6(1),e.Q6J("disabled",!t.selected||!t.selected.length||!t.canDelete)}}function Wt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th",38),e._uU(3,"Szoba "),e._UZ(4,"p-sortIcon",39),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Vend\xe9gek"),e.qZA(),e.TgZ(7,"th",40),e._uU(8,"\xc9rkez\xe9s "),e._UZ(9,"p-sortIcon",41),e.qZA(),e.TgZ(10,"th",42),e._uU(11,"T\xe1voz\xe1s "),e._UZ(12,"p-sortIcon",43),e.qZA(),e.TgZ(13,"th",44),e._uU(14,"St\xe1tusz "),e._UZ(15,"p-sortIcon",45),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Megjegyz\xe9s"),e.qZA(),e._UZ(18,"th"),e.qZA(),e.TgZ(19,"tr")(20,"th",46),e._UZ(21,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(22,"th")(23,"input",47),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.roomNum"))}),e.qZA(),e.TgZ(24,"app-building-selector",48),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.building"))}),e.qZA(),e.TgZ(25,"app-bedtype-selector",49),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.bedType"))}),e.qZA()(),e.TgZ(26,"th")(27,"input",50),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"guests"))}),e.qZA()(),e.TgZ(28,"th")(29,"p-calendar",51),e.NdJ("onSelect",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"startDate"))})("onClearClick",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"startDate"))}),e.qZA()(),e.TgZ(30,"th")(31,"p-calendar",51),e.NdJ("onSelect",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"endDate"))})("onClearClick",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"endDate"))}),e.qZA()(),e.TgZ(32,"th")(33,"app-reservation-status-selector",52),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"status"))}),e.qZA()(),e.TgZ(34,"th")(35,"input",53),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"notes"))}),e.qZA()(),e._UZ(36,"th"),e.qZA()}2&n&&(e.xp6(24),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("showClear",!0),e.xp6(4),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showClear",!0))}function Xt(n,i){if(1&n&&(e.TgZ(0,"span",74),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.room.floor,")")}}function es(n,i){1&n&&(e.TgZ(0,"span",75),e._uU(1,"\u2744\ufe0f"),e.qZA())}function ts(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.room.bathroom,"")}}function ss(n,i){if(1&n&&(e.ynx(0),e._UZ(1,"img",81),e.BQk()),2&n){const t=e.oxw(2).ngIf,s=e.oxw(2);e.xp6(1),e.cQ8("pTooltip","Baba\xe1gyra ker\xfcl: ",t[0].lastName," ",t[0].firstName," (",s.getAge(t[0].birthDate),")")}}function is(n,i){if(1&n&&(e._UZ(0,"img",81),e.TgZ(1,"span",82),e._uU(2),e.qZA()),2&n){const t=e.oxw(2).ngIf,s=e.oxw(2);e.MGl("pTooltip","Baba\xe1gyra ker\xfclnek: ",s.getBabyBedTooltip(t),""),e.xp6(2),e.hij(" ",t.length," ")}}function ns(n,i){if(1&n&&(e.TgZ(0,"div",77)(1,"div",23)(2,"div",78),e.YNc(3,ss,2,3,"ng-container",79),e.YNc(4,is,3,2,"ng-template",null,80,e.W1O),e.qZA()()()),2&n){const t=e.MAs(5),s=e.oxw().ngIf;e.xp6(3),e.Q6J("ngIf",1===s.length)("ngIfElse",t)}}function os(n,i){if(1&n&&(e.ynx(0),e.YNc(1,ns,6,2,"div",76),e.BQk()),2&n){const t=i.ngIf;e.xp6(1),e.Q6J("ngIf",t.length>0)}}function rs(n,i){if(1&n&&(e.TgZ(0,"div",84)(1,"div",23)(2,"div",78),e._UZ(3,"img",85),e.TgZ(4,"span",82),e._uU(5),e.qZA()()()()),2&n){const t=e.oxw().ngIf;e.xp6(3),e.MGl("pTooltip","Matrac ",t," f\u0151 r\xe9sz\xe9re"),e.xp6(2),e.hij(" ",t," ")}}function as(n,i){if(1&n&&(e.ynx(0),e.YNc(1,rs,6,2,"div",83),e.BQk()),2&n){const t=i.ngIf;e.xp6(1),e.Q6J("ngIf",t>0)}}function ls(n,i){if(1&n&&e._UZ(0,"p-avatar",86),2&n){const t=i.$implicit,s=e.oxw(2);e.hYB("pTooltip","",t.lastName+" "+t.firstName," (",s.getAge(t.birthDate),")")}}function cs(n,i){if(1&n&&e._UZ(0,"p-avatar",87),2&n){const t=i.ngIf,s=e.oxw(2);e.Akn(s.capacityStyle(t)),e.s9C("pTooltip",s.capacityTooltip(t)),e.Q6J("label",s.formatCapacityLabel(t))}}function us(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit;e.Gre("reservation-status-badge ",t.status,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.status?null:t.status.toUpperCase()))," ")}}function ds(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",54),e.qZA(),e.TgZ(3,"td")(4,"span",55),e._uU(5,"Szoba"),e.qZA(),e.TgZ(6,"div",56)(7,"div")(8,"div",23)(9,"div",24),e._UZ(10,"i",57),e.TgZ(11,"span",58),e._uU(12),e.qZA()(),e.TgZ(13,"div",59)(14,"div",60)(15,"span",61),e._uU(16),e.ALo(17,"translate"),e.YNc(18,Xt,2,1,"span",62),e.YNc(19,es,2,0,"span",63),e.qZA(),e.TgZ(20,"span",64),e._uU(21),e.YNc(22,ts,2,1,"span",10),e._uU(23,") "),e.qZA()()()()(),e.YNc(24,os,2,1,"ng-container",10),e.YNc(25,as,2,1,"ng-container",10),e.qZA()(),e.TgZ(26,"td")(27,"span",55),e._uU(28,"Vend\xe9gek"),e.qZA(),e.TgZ(29,"p-avatarGroup"),e.YNc(30,ls,1,2,"p-avatar",65),e.YNc(31,cs,1,4,"p-avatar",66),e.qZA()(),e.TgZ(32,"td",67)(33,"span",55),e._uU(34,"\xc9rkez\xe9s"),e.qZA(),e.TgZ(35,"span",68),e._UZ(36,"i",69),e._uU(37),e.ALo(38,"date"),e.qZA()(),e.TgZ(39,"td",67)(40,"span",55),e._uU(41,"T\xe1voz\xe1s"),e.qZA(),e.TgZ(42,"span",68),e._UZ(43,"i",69),e._uU(44),e.ALo(45,"date"),e.qZA()(),e.TgZ(46,"td",67)(47,"span",55),e._uU(48,"St\xe1tusz"),e.qZA(),e.YNc(49,us,3,6,"span",70),e.qZA(),e.TgZ(50,"td")(51,"span",55),e._uU(52,"Megjegyz\xe9s"),e.qZA(),e._uU(53),e.qZA(),e.TgZ(54,"td")(55,"div",71)(56,"button",72),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.edit(r))}),e.qZA(),e.TgZ(57,"button",73),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return a.tableItem=r,e.KtG(a.deleteDialog=!0)}),e.qZA()()()()}if(2&n){const t=i.$implicit,s=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(5),e.Gre("building-badge ",t.room.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.room.roomNum,""),e.xp6(1),e.hij(" ",t.room.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.room.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(17,23,"BUILDINGS."+t.room.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.room.floor),e.xp6(1),e.Q6J("ngIf",t.room.climate),e.xp6(2),e.AsE(" ",t.room.beds," SZEM\xc9LYES (",t.room.bedType,""),e.xp6(1),e.Q6J("ngIf",t.room.bathroom),e.xp6(2),e.Q6J("ngIf",s.getBabyBedGuests(t)),e.xp6(1),e.Q6J("ngIf",s.getMattressCount(t)),e.xp6(5),e.Q6J("ngForOf",t.guests),e.xp6(1),e.Q6J("ngIf",s.getFreeCapacity(t)),e.xp6(6),e.hij(" ",e.xi3(38,25,t.startDate,"yyyy.MM.dd")," "),e.xp6(7),e.hij(" ",e.xi3(45,28,t.endDate,"yyyy.MM.dd")," "),e.xp6(5),e.Q6J("ngIf",t.status),e.xp6(4),e.hij(" ",t.notes," "),e.xp6(3),e.Q6J("disabled",!s.canEdit),e.xp6(1),e.Q6J("disabled",!s.canDelete)}}function ps(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",88),e._uU(2,"Nincs tal\xe1lat..."),e.qZA()()),2&n&&(e.xp6(1),e.uIk("colspan",8))}function ms(n,i){if(1&n&&(e.TgZ(0,"span",89),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",null!=t.id&&t.id.value?"Foglal\xe1s adatai":"\xdaj foglal\xe1s"," ")}}function hs(n,i){1&n&&(e.TgZ(0,"div",113),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function gs(n,i){1&n&&(e.TgZ(0,"div",113),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function fs(n,i){1&n&&(e.TgZ(0,"div",113),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function _s(n,i){1&n&&(e.TgZ(0,"div",114),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function vs(n,i){1&n&&(e.TgZ(0,"div",114),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function bs(n,i){1&n&&(e.TgZ(0,"div",114),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function ys(n,i){1&n&&(e.TgZ(0,"div",114),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function Cs(n,i){1&n&&(e.TgZ(0,"div",113),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function xs(n,i){1&n&&(e.TgZ(0,"div",113),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}const Te=function(n){return{"ng-invalid":n}};function Ss(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",90),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._UZ(2,"input",91)(3,"input",92)(4,"input",93)(5,"input",94),e.TgZ(6,"div",95)(7,"label",96),e._uU(8,"Konferencia"),e.qZA(),e._UZ(9,"app-conference-selector",97),e.YNc(10,hs,2,0,"div",98),e.qZA(),e.TgZ(11,"div",95)(12,"label",99),e._uU(13,"Vend\xe9g"),e.qZA(),e._UZ(14,"app-guest-selector",100),e.YNc(15,gs,2,0,"div",98),e.qZA(),e.TgZ(16,"div",95)(17,"label",101),e._uU(18,"Szoba"),e.qZA(),e._UZ(19,"app-room-selector",102),e.YNc(20,fs,2,0,"div",98),e.qZA(),e.TgZ(21,"div",103)(22,"label",104),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"p-calendar",105),e.YNc(26,_s,3,3,"div",106),e.YNc(27,vs,3,3,"div",106),e.qZA(),e.TgZ(28,"div",103)(29,"label",107),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"p-calendar",108),e.YNc(33,bs,3,3,"div",106),e.YNc(34,ys,3,3,"div",106),e.qZA(),e.TgZ(35,"div",95)(36,"label",109),e._uU(37,"St\xe1tusz"),e.qZA(),e._UZ(38,"app-reservation-status-selector",110),e.YNc(39,Cs,2,0,"div",98),e.qZA(),e.TgZ(40,"div",95)(41,"label",111),e._uU(42,"Megjegyz\xe9s"),e.qZA(),e._UZ(43,"textarea",112),e.YNc(44,xs,2,0,"div",98),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.reservationForm),e.xp6(8),e.Q6J("preselectIds",t.preselectConferenceId)("showNoneOption",!1)("selectionLimit",1)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.conference?null:t.conference.dirty)&&(null==t.conference||null==t.conference.errors?null:t.conference.errors.required)),e.xp6(4),e.Q6J("filter",t.guestFilter)("preselectIds",t.preselectGuestIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("groupByRoomMate",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.guests?null:t.guests.dirty)&&(null==t.guests||null==t.guests.errors?null:t.guests.errors.required)),e.xp6(4),e.Q6J("filter",t.roomFilter)("selectionLimit",1)("preselectIds",t.preselectRoomIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.room?null:t.room.dirty)&&(null==t.room||null==t.room.errors?null:t.room.errors.required)),e.xp6(3),e.hij(" ",e.lcZ(24,31,"\xc9rkez\xe9s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(35,Te,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.startDate?null:t.startDate.dirty)&&(null==t.startDate||null==t.startDate.errors?null:t.startDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(3),e.hij(" ",e.lcZ(31,33,"T\xe1voz\xe1s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(37,Te,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.endDate?null:t.endDate.dirty)&&(null==t.endDate||null==t.endDate.errors?null:t.endDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(4),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.status?null:t.status.dirty)&&(null==t.status||null==t.status.errors?null:t.status.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.notes?null:t.notes.dirty)&&(null==t.notes||null==t.notes.errors?null:t.notes.errors.required))}}function Ts(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",115)(1,"button",116),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancel())}),e.qZA(),e.TgZ(2,"button",117),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.reservationForm.dirty),e.xp6(1),e.Q6J("disabled",!t.reservationForm.valid||!t.reservationForm.dirty)}}function Is(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1,"Biztosan t\xf6r\xf6lni akarja a(z) "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4," szoba foglal\xe1s\xe1t?"),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(null==t.tableItem.room?null:t.tableItem.room.roomNum)}}function Es(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",118),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",119),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.delete())}),e.qZA()}}function As(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",118),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.bulkDeleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",119),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteSelected())}),e.qZA()}}const Zs=function(){return["roomNum"]},ws=function(){return{"min-height":"calc(100vh - 320px)"}},Ie=function(){return{width:"450px"}},Fs=function(){return{width:"28rem"}};F.locale("hu");let se=class ne{constructor(i,t,s,o,r,a,l,u){this.reservationService=i,this.userService=t,this.conferenceService=s,this.confirmationService=o,this.messageService=r,this.responsiveService=a,this.route=l,this.fb=u,this.loading=!0,this.tableItem={},this.tableData=[],this.rowsPerPageOptions=[20,50,100,200],this.rowsPerPage=20,this.totalRecords=0,this.page=0,this.sortField="id",this.sortOrder=1,this.globalFilter="",this.filterValues={},this.debounce={},this.sidebar=!1,this.deleteDialog=!1,this.bulkDeleteDialog=!1,this.selected=[],this.canCreate=!1,this.canEdit=!1,this.canDelete=!1,this.isMobile=!1,this.isOrganizer=!1,this.selectedConferences=[],this.totalBeds=0,this.registeredGuests=0,this.reservedGuests=0,this.waitingForRoom=0,this.datesTouchedByUser=!1,this.conferenceStart=null,this.conferenceEnd=null,this.preselectGuestIds=[],this.roomFilter={enabled:!0},this.guestFilter={enabled:!0},this.suppressEmits=!1,this.initialFormValues={id:null,room:null,room_id:null,conference:[],conference_id:null,startDate:"",endDate:"",status:"confirmed",notes:"",guests:[],guestIds:[]},this.INITIAL_FORM_STATE_CLOSED={id:{value:null,disabled:!1},room:{value:null,disabled:!0},room_id:{value:null,disabled:!1},conference:{value:[],disabled:!1},conference_id:{value:null,disabled:!1},startDate:{value:null,disabled:!0},endDate:{value:null,disabled:!0},status:{value:"confirmed",disabled:!1},notes:{value:"",disabled:!1},guests:{value:[],disabled:!0},guestIds:{value:[],disabled:!1}},this.BABY_ONLY_ROOM_NUMS=new Set(["207","212","20A","G11B","K12B","L11A","L11D*","L11E*","S11A","S12A","S12C","V11A*"]),this.BABY_PLUS_MATTRESS_ROOM_NUMS=new Set(["S11B*","S11C*","S11D*","S21A*","S21B*"]),this.lastSelectionByRoom=new Map,this.bedFullWarnedByGuest=new Set,this.query$=new D.x,this.formChanges$=new D.x,this.reservationForm=this.fb.group({id:this.INITIAL_FORM_STATE_CLOSED.id,room:[this.INITIAL_FORM_STATE_CLOSED.room,_.kI.required],room_id:[this.INITIAL_FORM_STATE_CLOSED.room_id,_.kI.required],conference:[this.INITIAL_FORM_STATE_CLOSED.conference,_.kI.required],conference_id:[this.INITIAL_FORM_STATE_CLOSED.conference_id,_.kI.required],startDate:[this.INITIAL_FORM_STATE_CLOSED.startDate,_.kI.required],endDate:[this.INITIAL_FORM_STATE_CLOSED.endDate,_.kI.required],status:this.INITIAL_FORM_STATE_CLOSED.status,notes:this.INITIAL_FORM_STATE_CLOSED.notes,guests:[this.INITIAL_FORM_STATE_CLOSED.guests,_.kI.required],guestIds:[this.INITIAL_FORM_STATE_CLOSED.guestIds,_.kI.required]},{validators:(0,Ze.W)("startDate","endDate")}),this.isFormValid$=new w.X(!1)}ngOnInit(){this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canCreate=i),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canEdit=i),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canDelete=i),this.userService.hasRole(["Szervezo"]).subscribe(i=>this.isOrganizer=i),this.room?.disable({emitEvent:!1}),this.querySub=this.query$.pipe((0,J.h)(()=>(this.selectedConferences?.length??0)>0),(0,E.U)(i=>({key:this.buildQueryKey(),force:!!i?.force})),(0,A.x)((i,t)=>!t.force&&i.key===t.key),function Q(n,i=z.z){return function y(n){return(0,d.e)((i,t)=>{let s=!1,o=null,r=null,a=!1;const l=()=>{if(r?.unsubscribe(),r=null,s){s=!1;const m=o;o=null,t.next(m)}a&&t.complete()},u=()=>{r=null,a&&t.complete()};i.subscribe((0,v.x)(t,m=>{s=!0,o=m,r||(0,p.Xf)(n(m)).subscribe(r=(0,v.x)(t,l,u))},()=>{a=!0,(!s||!r||r.closed)&&t.complete()}))})}(()=>(0,x.H)(n,i))}(50),(0,te.w)(()=>{this.loading=!0,this.filterValues.conference_id=(this.selectedConferences??[]).map(s=>s.id).join(",");const i=Object.keys(this.filterValues).map(s=>this.filterValues[s]?.length?`${s}=${this.filterValues[s]}`:"").filter(Boolean).join("&"),t=this.sortField?{sortField:this.sortField,sortOrder:this.sortOrder}:"";return""!==this.globalFilter?this.reservationService.getBySearch$(this.globalFilter,t):this.reservationService.get$(this.page,this.rowsPerPage,t,i)})).subscribe({next:i=>{this.loading=!1,this.tableData=i?.rows??[],this.totalRecords=i?.totalItems??0,this.page=i?.currentPage??0,this.totalBeds=i?.summary?.totalBeds??0,this.registeredGuests=i?.summary?.registeredGuests??0,this.reservedGuests=i?.summary?.reservedGuests??0,this.waitingForRoom=i?.summary?.waitingForRoom??0},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Hiba t\xf6rt\xe9nt!"})}}),this.conference?.valueChanges.pipe(oe(),(0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(i=>{const t=i?.[0];this.applyConferenceSideEffects(t)}),this.room?.valueChanges.pipe(oe()).subscribe(i=>{const t=i?.[0];this.reservationForm.patchValue({room_id:t?.id??null},{emitEvent:!1}),null!=t?.id&&this.validateCapacityForCurrentSelection(t)}),this.guests?.valueChanges.pipe((0,E.U)(i=>Array.isArray(i)?i:i?[i]:[]),(0,E.U)(i=>({guestsArr:i,ids:Array.from(new Set(i.map(t=>t?.id).filter(t=>null!=t)))})),(0,A.x)((i,t)=>i.ids.length===t.ids.length&&i.ids.every((s,o)=>s===t.ids[o]))).subscribe(({guestsArr:i,ids:t})=>{const s=this.getSelectedRoom();if(s&&!this.onGuestsSelectionChange(s,i)||(this.reservationForm.patchValue({guestIds:t},{emitEvent:!1}),!this.sidebar||this.suppressEmits||this.datesTouchedByUser)||this.datesTouchedByUser)return;const o=this.computeGuestDateRange(i);if(o.minArrival&&o.maxDeparture){const a=o.minArrival.format("YYYY-MM-DD"),l=o.maxDeparture.format("YYYY-MM-DD"),u=this.startDate?.value,m=this.endDate?.value;(u!==a||m!==l)&&this.reservationForm.patchValue({startDate:a,endDate:l},{emitEvent:!1})}else{const a=Array.isArray(this.conference?.value)?this.conference.value:[],l=a.length?a[0]:null;if(l){const u=l.beginDate?F(l.beginDate).format("YYYY-MM-DD"):null,m=l.endDate?F(l.endDate).format("YYYY-MM-DD"):null;this.reservationForm.patchValue({startDate:u,endDate:m},{emitEvent:!1})}}}),this.startDate?.valueChanges.pipe((0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(()=>{this.datesTouchedByUser=!0}),this.endDate?.valueChanges.pipe((0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(()=>{this.datesTouchedByUser=!0}),this.responsiveService.isMobile$.subscribe(i=>{this.isMobile=i}),this.isFormValid$=this.formChanges$.pipe((0,j.b)(300),(0,A.x)(),(0,E.U)(()=>this.reservationForm.valid)),this.serviceMessageObs$=this.reservationService.messageObs,this.conferenceMessageObs$=this.conferenceService.messageObs,this.serviceMessageObs$.subscribe(i=>this.handleMessage(i)),this.conferenceMessageObs$.subscribe(i=>this.handleMessage(i)),this.initDeepLinkFromReservationId()}initDeepLinkFromReservationId(){this.route.queryParamMap.pipe((0,E.U)(i=>{const t=i.get("conference_id"),s=i.get("reservation_id"),o=i.get("open"),r=null!=t?Number(t):null,a=null!=s?Number(s):null,l="1"===o||"true"===o||"yes"===o;return{conferenceId:Number.isFinite(r)?r:null,reservationId:Number.isFinite(a)?a:null,autoOpen:l}}),(0,A.x)((i,t)=>i.conferenceId===t.conferenceId&&i.reservationId===t.reservationId&&i.autoOpen===t.autoOpen)).subscribe(({conferenceId:i,reservationId:t,autoOpen:s})=>{if(!t)return this.filterValues.id&&(delete this.filterValues.id,this.doQuery(!0)),void(this.sidebar&&this.closeSidebar());i&&(this.selectedConferences=[{id:i}]),this.reservationService.get$(0,1,{sortField:"id",sortOrder:1},`id=${t}`).pipe((0,E.U)(r=>r?.rows?.[0]||null),(0,Ee.q)(1)).subscribe({next:r=>{if(!r)return void this.messageService.add({severity:"warn",summary:"Figyelem",detail:"A megadott foglal\xe1s nem tal\xe1lhat\xf3."});const a=r.conference_id??r.conference?.id??null;!i&&a&&(this.selectedConferences=[{id:a}]),this.filterValues={...this.filterValues,id:String(r.id)},this.page=0,this.doQuery(!0),s&&this.edit(r)},error:()=>{this.messageService.add({severity:"warn",summary:"Figyelem",detail:"A megadott foglal\xe1s nem tal\xe1lhat\xf3."})}})})}get id(){return this.reservationForm.get("id")}get room(){return this.reservationForm.get("room")}get room_id(){return this.reservationForm.get("room_id")}get conference(){return this.reservationForm.get("conference")}get conference_id(){return this.reservationForm.get("conference_id")}get startDate(){return this.reservationForm.get("startDate")}get endDate(){return this.reservationForm.get("endDate")}get status(){return this.reservationForm.get("status")}get notes(){return this.reservationForm.get("notes")}get guests(){return this.reservationForm.get("guests")}get guestIds(){return this.reservationForm.get("guestIds")}doQuery(i=!1){if(!this.selectedConferences?.length)return this.tableData=[],this.totalRecords=0,void(this.loading=!1);this.query$.next({force:i})}onFilter(i,t){if(this.isOrganizer&&0===this.selectedConferences.length)return;let o="";i instanceof Date?o=F(i).format("YYYY.MM.DD"):i&&(i.value||i.target?.value)?(o=i.value||i.target?.value,o=o.toString()):this.filterValues[t]="",this.filterValues[t]=o,["conferenceName","room.building","room.bedType","status"].includes(t)?this.filterValues[t]===o&&this.doQuery():(this.debounce[t]&&clearTimeout(this.debounce[t]),this.debounce[t]=setTimeout(()=>{this.filterValues[t]===o&&this.doQuery()},500))}onLazyLoad(i){this.page=i.first/i.rows,this.rowsPerPage=i.rows??this.rowsPerPage,this.sortField=i.sortField??"",this.sortOrder=-1===i.sortOrder?-1:1,this.globalFilter=i.globalFilter??"",this.doQuery()}onGlobalFilter(i,t){i.filterGlobal(t.target.value,"contains")}onSidebarShow(){this.sidebar=!0;const i=!this.id?.value,t=this.selectedConferences?.[0];i&&t?(this.preselectConferenceId=t.id,this.reservationForm.patchValue({conference:[t]},{emitEvent:!0}),queueMicrotask(()=>this.applyConferenceSideEffects(t))):(this.preselectConferenceId=void 0,queueMicrotask(()=>this.applyConferenceSideEffects()))}onSidebarHide(){this.suppressEmits=!0,this.sidebar=!1,this.datesTouchedByUser=!1,this.reservationForm.reset(this.INITIAL_FORM_STATE_CLOSED,{emitEvent:!0}),this.preselectConferenceId=void 0,this.preselectRoomIds=void 0,this.preselectGuestIds=[],this.originalFormValues=void 0,this.preselectConferenceId=void 0,this.reservationForm.markAsPristine(),this.reservationForm.markAsUntouched(),queueMicrotask(()=>this.suppressEmits=!1)}closeSidebar(){this.sidebar=!1}onGuestsSelectionChange(i,t){const s=Number(i?.id),o=Number(i?.beds??0),r=Number(i?.extraBeds??0),a=o+r,l=this.lastSelectionByRoom.get(s)??[],u=t.map(g=>g.id).filter(g=>null!=g),m=u.length,b=this.evaluateExtraGuests(i,t);if("default"!==b.policy.kind&&b.totalCapacity>0&&m>b.totalCapacity)return this.revertGuestsToPrevious(s,t,l),this.messageService.add({severity:"warn",summary:"Szoba megtelt",detail:`A(z) ${b.roomNum} szoba maxim\xe1lis kapacit\xe1sa ${b.totalCapacity} f\u0151. T\xf6bb vend\xe9g nem helyezhet\u0151 el ebben a szob\xe1ban.`,life:8e3}),!1;if("babyOnly"===b.policy.kind){if(b.adultExtraCount>0)return this.revertGuestsToPrevious(s,t,l),this.messageService.add({severity:"warn",summary:"Csak baba\xe1gy f\xe9r",detail:`A(z) ${b.roomNum} szob\xe1ban p\xf3t\xe1gy csak baba\xe1gy (0\u20133 \xe9v). 3 \xe9v feletti (vagy ismeretlen kor\xfa) vend\xe9g nem tehet\u0151 p\xf3t\xe1gyra.`,life:1e4}),!1}else if("babyPlusMattress"===b.policy.kind&&b.adultExtraCount>b.policy.allowedAdultExtra)return this.revertGuestsToPrevious(s,t,l),this.messageService.add({severity:"warn",summary:"P\xf3t\xe1gy korl\xe1toz\xe1s",detail:`A(z) ${b.roomNum} szob\xe1ban legfeljebb 1 matrac haszn\xe1lhat\xf3; a tov\xe1bbi p\xf3t\xe1gy(ak) csak baba\xe1gy (0\u20133 \xe9v).`,life:1e4}),!1;if(this.isOrganizer&&a>0&&m>a){const g=new Map(t.filter(Z=>Z&&null!=Z.id).map(Z=>[Z.id,Z])),I=l.map(Z=>g.get(Z)).filter(Z=>!!Z);return this.suppressEmits=!0,this.reservationForm.patchValue({guests:I,guestIds:l},{emitEvent:!1}),this.suppressEmits=!1,this.lastSelectionByRoom.set(s,l),this.messageService.add({severity:"warn",summary:"Szoba megtelt",detail:`A szoba maxim\xe1lis kapacit\xe1sa ${a} f\u0151. T\xf6bb vend\xe9g nem helyezhet\u0151 el ebben a szob\xe1ban.`,life:8e3}),!1}const T=new Set(l),N=u.filter(g=>!T.has(g)),L=N.length?N[N.length-1]:null,h=Math.max(0,m-o);if(N.map((g,I)=>({id:g,pos:l.length+I+1})).filter(g=>g.pos>o).map(g=>g.id).filter(g=>!this.bedFullWarnedByGuest.has(`${s}:${g}`)).forEach(g=>this.bedFullWarnedByGuest.add(`${s}:${g}`)),h>0){const g=this.getExtraBedPolicyByRoom(i),Z="babyOnly"===g.kind?"Csak baba\xe1gy haszn\xe1lhat\xf3 (0\u20133 \xe9v).":"babyPlusMattress"===g.kind?h>=2?"A 2. p\xf3t\xe1gy csak baba\xe1gy (0\u20133 \xe9v).":"Matracra vagy baba\xe1gyra ker\xfclhet (max 1 matrac).":"Matracra vagy gyerek\xe1gyra ker\xfclhet.";if(1===h&&null!=L){const G=t.find(q=>q.id===L),ie=G&&`${G.lastName??""} ${G.firstName??""}`.trim()||"A vend\xe9g";this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${ie} m\xe1r nem f\xe9r \xe1gyra! ${Z}`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1})}else this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${h} f\u0151 m\xe1r nem f\xe9r \xe1gyra! ${Z}`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1})}return this.lastSelectionByRoom.set(s,u),m<=o&&[...this.bedFullWarnedByGuest].filter(g=>g.startsWith(`${s}:`)).forEach(g=>this.bedFullWarnedByGuest.delete(g)),!0}create(){this.suppressEmits=!0,this.datesTouchedByUser=!1,this.preselectConferenceId=void 0,this.preselectRoomIds=void 0,this.preselectGuestIds=[],this.bedFullWarnedByGuest.clear(),this.lastSelectionByRoom.clear(),this.roomFilter={enabled:!0},this.guestFilter={enabled:!0},this.reservationForm.reset(this.INITIAL_FORM_STATE_CLOSED,{emitEvent:!1}),this.reservationForm.markAsPristine(),this.reservationForm.markAsUntouched(),this.originalFormValues=this.reservationForm.getRawValue(),this.suppressEmits=!1,this.sidebar=!0}edit(i){this.datesTouchedByUser=!1,this.reservationForm.reset(this.initialFormValues,{emitEvent:!1});const t=i.conference??(i.conference_id?{id:i.conference_id}:null);this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null},{emitEvent:!0});const s=i.room??(i.room_id?{id:i.room_id}:null),o=Array.isArray(i.guests)?i.guests:[],r=Array.from(new Set(o.map(a=>"string"==typeof a?.id?Number(a.id):a?.id).filter(a=>Number.isFinite(a))));this.suppressEmits=!0,this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null,guests:o,guestIds:r,startDate:i.startDate??null,endDate:i.endDate??null},{emitEvent:!1}),this.preselectGuestIds=r,this.roomFilter={...this.roomFilter,conferenceId:t?.id??null,includeRoomIds:s?.id?[s.id]:[]},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null,includeGuestIds:this.preselectGuestIds},this.room?.enable({emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1}),this.reservationForm.patchValue({id:i.id??null,room:s?[s]:[],room_id:s?.id??null,guests:o,guestIds:Array.from(new Set(r)),status:i.status??"confirmed",notes:i.notes??null},{emitEvent:!1}),this.preselectRoomIds=s?.id??null,this.preselectGuestIds=Array.from(new Set(r)),this.suppressEmits=!1,this.originalFormValues=this.reservationForm.getRawValue(),this.sidebar=!0,s?.id&&this.lastSelectionByRoom.set(s.id,this.preselectGuestIds??[])}delete(){this.loading=!0,this.deleteDialog=!1,this.reservationService.delete(this.tableItem)}deleteSelected(){this.loading=!0,this.bulkDeleteDialog=!1,this.reservationService.bulkdelete(this.selected)}save(){if(!this.reservationForm.valid)return;const i=this.getSelectedRoom(),t=Array.isArray(this.guests?.value)?this.guests.value:[];if(i){const l=this.evaluateExtraGuests(i,t);if("default"!==l.policy.kind){if(l.totalCapacity>0&&t.length>l.totalCapacity)return void this.messageService.add({severity:"warn",summary:"Szoba megtelt",detail:`A(z) ${l.roomNum} szoba maxim\xe1lis kapacit\xe1sa ${l.totalCapacity} f\u0151. T\xf6bb vend\xe9g nem menthet\u0151 ebbe a szob\xe1ba.`,life:1e4});if("babyOnly"===l.policy.kind&&l.adultExtraCount>0||"babyPlusMattress"===l.policy.kind&&l.adultExtraCount>l.policy.allowedAdultExtra){const m=t.length===l.totalCapacity&&l.requiredBabyExtra>0?this.buildRoomPolicySaveMessage(l.totalCapacity,l.requiredBabyExtra):"babyOnly"===l.policy.kind?`A(z) ${l.roomNum} szob\xe1ban p\xf3t\xe1gy csak baba\xe1gy (0\u20133 \xe9v). 3+ vend\xe9g nem menthet\u0151 p\xf3t\xe1gyra.`:`A(z) ${l.roomNum} szob\xe1ban legfeljebb 1 matrac haszn\xe1lhat\xf3; a tov\xe1bbi p\xf3t\xe1gy(ak) csak baba\xe1gy (0\u20133 \xe9v).`;return void this.messageService.add({severity:"warn",summary:"Nem menthet\u0151",detail:m,life:12e3})}}}this.loading=!0;const s=this.reservationForm.value,o=l=>Array.isArray(l)?l[0]?.id??null:l?.id??null,r=Array.isArray(s.guestIds)?Array.from(new Set(s.guestIds.map(l=>Number(l)).filter(l=>Number.isFinite(l)))):Array.isArray(s.guests)?Array.from(new Set(s.guests.map(l=>Number(l?.id)).filter(l=>Number.isFinite(l)))):s.guests?.id?[Number(s.guests.id)]:[],a={room_id:o(s.room)??s.room_id??null,conference_id:o(s.conference)??s.conference_id??null,startDate:s.startDate,endDate:s.endDate,status:s.status??"confirmed",notes:s.notes??null};if(s.id){const l={id:s.id,...a,guestIds:r};this.reservationService.update(l)}else{const l={...a,guestIds:r};this.reservationService.create(l)}this.doQuery()}cancel(){this.reservationForm.reset(this.originalFormValues)}handleMessage(i){if(i){if(this.loading=!1,"ERROR"==i||"error"===i?.severity)return void this.messageService.add({severity:"error",summary:i?.summary??"Error",detail:i?.detail??"Hiba t\xf6rt\xe9nt!"});this.messageService.add(i),this.tableItem={},this.selected=[],this.doQuery(!0),this.closeSidebar()}}onConfChange(i){this.selectedConferences=i.value,("user"===i.source||"auto-select-first"===i.source)&&(this.tableData=[],this.doQuery())}getAge(i){if(!i)return"";const t=F(i);return F().diff(t,"years").toString()}getBabyBedCount(i){if(!i?.guests||!i.guests.length)return 0;const t=F();return i.guests.reduce((s,o)=>{if(!o?.birthDate)return s;const r=t.diff(F(o.birthDate),"years");return r>=0&&r<3?s+1:s},0)}getBabyBedGuests(i){if(!i?.guests||!i.guests.length)return[];const t=F();return i.guests.filter(s=>{if(!s?.birthDate)return!1;const o=t.diff(F(s.birthDate),"years");return o>=0&&o<3})}getFreeCapacity(i){const t=i?.guests?.length??0;return(i?.room?.beds??0)+(i?.room?.extraBeds??0)-t}capacityStyle(i){return{"background-color":i<0?"#EF4444":"#22C55E",color:"#ffffff"}}capacityTooltip(i){return i<0?`T\xfalfoglalva ${Math.abs(i)} f\u0151vel`:`Szabad f\xe9r\u0151hely ${i} f\u0151 r\xe9sz\xe9re`}formatCapacityLabel(i){return i>0?`+${i}`:i<0?`${Math.abs(i)}`:""}exportExcel(){c.e(1486).then(c.bind(c,1486)).then(i=>{const t=[{key:"reservationNum",label:"Szoba-sz\xe1m"},{key:"reservationCode",label:"Szoba k\xf3d"},{key:"beds",label:"\xc1gyak sz\xe1ma"},{key:"spareBeds",label:"Matrac / gyerek\xe1gy"},{key:"building",label:"\xc9p\xfclet / folyos\xf3"},{key:"bedType",label:"\xc1gy t\xedpus"},{key:"bathreservation",label:"F\xfcrd\u0151szoba"},{key:"notes",label:"Megjegyz\xe9s"}],o=(this.selected.length>0?this.selected:this.tableData).map(u=>{let m={};return t.forEach(b=>{m[b.label]=u[b.key]??""}),m}),a={Sheets:{data:i.utils.json_to_sheet(o,{header:t.map(u=>u.label)})},SheetNames:["data"]},l=i.write(a,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(l,"reservations")})}saveAsExcelFile(i,t){const r=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Fe.saveAs(r,t+"_export_"+F().format("YYYYMMDD")+".xlsx")}fromYMD(i){const[t,s,o]=i.split("-").map(Number);return new Date(t,s-1,o)}toYMD(i){return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`}buildQueryKey(){const i=(this.selectedConferences??[]).map(s=>s.id).sort().join(","),t=Object.keys(this.filterValues).map(s=>this.filterValues[s]?`${s}=${this.filterValues[s]}`:"").filter(Boolean).join("&");return[this.page,this.rowsPerPage,this.sortField,this.sortOrder,this.globalFilter||"",i,t].join("|")}getSelectedRoom(){const i=this.room?.value;return Array.isArray(i)&&i.length?i[0]:null}validateCapacityForCurrentSelection(i){const t=Number(i?.id),s=Number(i?.beds??0),o=Number(i?.extraBeds??0),r=Array.isArray(this.guests?.value)?this.guests.value:[],a=r.map(u=>u?.id).filter(u=>null!=u);[...this.bedFullWarnedByGuest].filter(u=>u.startsWith(`${t}:`)).forEach(u=>this.bedFullWarnedByGuest.delete(u));const l=Math.max(0,a.length-s);if(l<=0)this.lastSelectionByRoom.set(t,a);else{for(let u=s;u<a.length;u++)this.bedFullWarnedByGuest.add(`${t}:${a[u]}`);if(1===l){const u=a[s],m=r.find(T=>T.id===u),b=m&&`${m.lastName??""} ${m.firstName??""}`.trim()||"A vend\xe9g";this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${b} m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1,accept:()=>{const T=s+o;a.length>T&&this.messageService.add({severity:"warn",summary:"Kev\xe9s f\xe9r\u0151hely",detail:`\xd6sszes kapacit\xe1s: ${T} (\xe1gy + matrac/gyerek\xe1gy), kijel\xf6lve: ${a.length}. ${a.length-T} f\u0151 t\xe9nylegesen nem f\xe9r be.`,life:15e3})}})}else this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${l} f\u0151 m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1,accept:()=>{const u=s+o;a.length>u&&this.messageService.add({severity:"warn",summary:"Kev\xe9s f\xe9r\u0151hely",detail:`\xd6sszes kapacit\xe1s: ${u} (\xe1gy + matrac/gyerek\xe1gy), kijel\xf6lve: ${a.length}. ${a.length-u} f\u0151 t\xe9nylegesen nem f\xe9r be.`,life:15e3})}});this.lastSelectionByRoom.set(t,a)}}applyConferenceSideEffects(i){const t=i??(Array.isArray(this.conference?.value)&&this.conference.value.length?this.conference.value[0]:null),s=!this.id?.value,o=u=>u?F(u).format("YYYY-MM-DD"):null;this.reservationForm.patchValue({conference_id:t?.id??null},{emitEvent:!1}),this.roomFilter={...this.roomFilter,conferenceId:t?.id??null},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null};const r=this.startDate?.value,a=this.endDate?.value,l={};t?((s||!r)&&(l.startDate=o(t.beginDate)),(s||!a)&&(l.endDate=o(t.endDate)),Object.keys(l).length&&this.reservationForm.patchValue(l,{emitEvent:!1}),this.room?.enable({emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1})):(s&&this.reservationForm.patchValue({startDate:null,endDate:null},{emitEvent:!1}),this.room?.disable({emitEvent:!1}),this.guests?.disable({emitEvent:!1}),this.startDate?.disable({emitEvent:!1}),this.endDate?.disable({emitEvent:!1}))}computeGuestDateRange(i){let t=null,s=null;for(const o of i??[]){const r=o.dateOfArrival,a=o.dateOfDeparture,l=r?F(r,"YYYY-MM-DD",!0):null,u=a?F(a,"YYYY-MM-DD",!0):null;l&&l.isValid()&&(!t||l.isBefore(t))&&(t=l),u&&u.isValid()&&(!s||u.isAfter(s))&&(s=u)}return{minArrival:t,maxDeparture:s}}isBabyGuest(i){if(!i?.birthDate)return!1;const s=F().diff(F(i.birthDate),"years");return s>=0&&s<3}getBabyBedTooltip(i){return i?.length?i.map(t=>{const s=`${t.lastName??""} ${t.firstName??""}`.trim(),o=this.getAge(t.birthDate);return o?`${s} (${o})`:s}).join(", "):""}getMattressCount(i){const t=Number(i?.room?.beds??0),s=i?.guests??[];if(!s.length)return 0;const o=this.getBabyBedGuests(i).length,r=Math.max(0,s.length-o);return Math.max(0,r-t)}getExtraBedPolicyByRoom(i){const t=i?.roomNum;return this.BABY_ONLY_ROOM_NUMS.has(t)?{kind:"babyOnly",allowedAdultExtra:0}:this.BABY_PLUS_MATTRESS_ROOM_NUMS.has(t)?{kind:"babyPlusMattress",allowedAdultExtra:1}:{kind:"default",allowedAdultExtra:Number.POSITIVE_INFINITY}}evaluateExtraGuests(i,t){const s=this.getExtraBedPolicyByRoom(i),o=i?.roomNum,r=Number(i?.beds??0),a=Number(i?.extraBeds??0),l=r+a,u=t.slice(r),m=u.filter(N=>this.isBabyGuest(N)).length;return{policy:s,roomNum:o,beds:r,extraBeds:a,totalCapacity:l,extraGuests:u,babyExtraCount:m,adultExtraCount:u.length-m,requiredBabyExtra:Math.max(0,u.length-s.allowedAdultExtra)}}revertGuestsToPrevious(i,t,s){const o=new Map(t.filter(a=>a&&null!=a.id).map(a=>[a.id,a])),r=s.map(a=>o.get(a)).filter(a=>!!a);this.suppressEmits=!0,this.reservationForm.patchValue({guests:r,guestIds:s},{emitEvent:!1}),this.suppressEmits=!1,this.lastSelectionByRoom.set(i,s)}buildRoomPolicySaveMessage(i,t){return t<=0?"":1===t?`Ebbe a szob\xe1ba \xf6sszesen ${i} f\u0151 ker\xfclhet, amib\u0151l az egyik 0\u20133 \xe9v k\xf6z\xf6tti!`:`Ebbe a szob\xe1ba \xf6sszesen ${i} f\u0151 ker\xfclhet, amib\u0151l legal\xe1bb ${t} f\u0151 0\u20133 \xe9v k\xf6z\xf6tti!`}ngOnDestroy(){}static#e=this.\u0275fac=function(t){return new(t||ne)(e.Y36(ae),e.Y36(Me.K),e.Y36(Oe.Z),e.Y36(S.YP),e.Y36(S.ez),e.Y36(De.k),e.Y36(O.gz),e.Y36(_.qu))};static#t=this.\u0275cmp=e.Xpm({type:ne,selectors:[["reservation-component"]],viewQuery:function(t,s){if(1&t&&e.Gf(re.w,5),2&t){let o;e.iGM(o=e.CRH())&&(s.conferenceSelector=o.first)}},features:[e._Bn([S.ez,S.YP])],decls:28,vars:35,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-0","py-0"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","{first} - {last} bejegyz\xe9s a(z) {totalRecords}-b\xf3l megjelen\xedt\xe9se","selectionMode","multiple",3,"value","rows","totalRecords","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","tableStyle","rowHover","lazy","selectionChange","onLazyLoad"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["id","sidebar","position","right","styleClass","p-sidebar-md",3,"visible","transitionOptions","fullScreen","blockScroll","visibleChange","onHide","onShow"],[4,"ngIf"],["pTemplate","footer"],["header","T\xf6rl\xe9s",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[3,"autoZIndex","blocked"],[3,"closable"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0"],["placeholder","V\xe1lasszon konferenci\xe1t...",3,"ngModel","emitOnSelectFirstOption","showNoneOption","selectionLimit","showClear","ngModelChange"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0",2,"background-color","#E2E8F0",3,"pTooltip"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],["width","24px","height","24px","viewBox","0 0 24 24","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#000000"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","ic_fluent_bed_24_filled","fill","#334155","fill-rule","nonzero"],["d","M19.25,11 C20.7125318,11 21.9084043,12.1417046 21.9949812,13.5824777 L22,13.75 L22,20.25 C22,20.6642136 21.6642136,21 21.25,21 C20.8703042,21 20.556509,20.7178461 20.5068466,20.3517706 L20.5,20.25 L20.5,18 L3.5,18 L3.5,20.25 C3.5,20.6296958 3.21784612,20.943491 2.85177056,20.9931534 L2.75,21 C2.37030423,21 2.05650904,20.7178461 2.00684662,20.3517706 L2,20.25 L2,13.75 C2,12.2874682 3.1417046,11.0915957 4.58247767,11.0050188 L4.75,11 L19.25,11 Z M6.75,4 L17.25,4 C18.7125318,4 19.9084043,5.1417046 19.9949812,6.58247767 L20,6.75 L20,10 L17,10 L16.9932723,9.88337887 C16.9399506,9.42429701 16.575703,9.06004937 16.1166211,9.00672773 L16,9 L14,9 C13.4871642,9 13.0644928,9.38604019 13.0067277,9.88337887 L13,10 L11,10 L10.9932723,9.88337887 C10.9399506,9.42429701 10.575703,9.06004937 10.1166211,9.00672773 L10,9 L8,9 C7.48716416,9 7.06449284,9.38604019 7.00672773,9.88337887 L7,10 L4,10 L4,6.75 C4,5.28746816 5.1417046,4.09159572 6.58247767,4.00501879 L6.75,4 Z"],[1,"text-2xl","font-normal","white-space-nowrap","vertical-align-middle"],[1,"pi","pi-users",2,"font-size","1.5rem"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0","bg-green-100",3,"pTooltip"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0","bg-yellow-100",3,"pTooltip"],["pButton","","pRipple","","label","\xdaj","icon","pi pi-plus",1,"p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","label","T\xf6rl\xe9s","icon","pi pi-trash",1,"p-button-danger","mr-2",3,"disabled","click"],["pSortableColumn","roomNum"],["field","roomNum"],["pSortableColumn","startDate"],["field","startDate"],["pSortableColumn","endDate"],["field","endDate"],["pSortableColumn","status"],["field","status"],["styleClass","w-3rem"],["pInputText","","type","text","placeholder","Szobasz\xe1m...",1,"mr-2",2,"width","8rem",3,"input"],["placeholder","\xc9p\xfclet...",1,"mr-2",3,"showClear","change"],["placeholder","\xc1gytipus...",3,"showClear","change"],["pInputText","","type","text","placeholder","Vend\xe9g...",2,"width","10rem",3,"input"],["appendTo","body","dataType","string","placeholder","Keres\xe9s...","inputStyleClass","w-6rem",3,"showButtonBar","onSelect","onClearClick"],["placeholder","St\xe1tusz...",3,"showClear","change"],["pInputText","","type","text","placeholder","Keres\xe9s...",2,"width","8rem",3,"input"],[3,"value"],[1,"p-column-title"],[1,"flex","align-items-center","gap-2"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip",4,"ngFor","ngForOf"],["shape","circle","size","large","tooltipPosition","top",3,"label","style","pTooltip",4,"ngIf"],[2,"max-width","300px"],[1,"calendar-badge"],[1,"pi","pi-calendar","mr-1"],[3,"class",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"disabled","click"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"],["class","border-round-xl w-min p-0 bg-purple-100",4,"ngIf"],[1,"border-round-xl","w-min","p-0","bg-purple-100"],[1,"flex","align-items-center","justify-content-center","gap-1","px-2"],[4,"ngIf","ngIfElse"],["multipleBabyBeds",""],["src","/assets/demo/images/baby-bed.svg","alt","Baby bed","tooltipPosition","top",2,"max-width","20px",3,"pTooltip"],[1,"text-sm","font-semibold","pl-1"],["class","border-round-xl w-min p-0","style","background-color: #FFEDD5;",4,"ngIf"],[1,"border-round-xl","w-min","p-0",2,"background-color","#FFEDD5"],["src","/assets/demo/images/mattress.svg","alt","Matrac","tooltipPosition","top",2,"max-width","20px",3,"pTooltip"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip"],["shape","circle","size","large","tooltipPosition","top",3,"label","pTooltip"],[1,"text-center"],[1,"font-semibold","text-xl"],["novalidate","",1,"grid","formgrid","p-fluid",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden"],["formControlName","conference_id","type","hidden"],["formControlName","room_id","type","hidden"],["formControlName","guestIds","type","hidden"],[1,"field","mb-4","col-12"],["for","conference",1,"font-medium","text-900"],["formControlName","conference","placeholder","V\xe1lasszon konferenci\xe1t...",3,"preselectIds","showNoneOption","selectionLimit","showClear"],["class","block p-error",4,"ngIf"],["for","guest",1,"font-medium","text-900"],["formControlName","guests","placeholder","Vend\xe9g...",3,"filter","preselectIds","emitOnPreselectId","showOnlyNotReserved","groupByRoomMate","showClear"],["for","room_id",1,"font-medium","text-900"],["formControlName","room","placeholder","Szoba...",3,"filter","selectionLimit","preselectIds","emitOnPreselectId","showOnlyNotReserved","showClear"],[1,"field","mb-4","col-6"],["for","startDate",1,"font-medium","text-900"],["id","startDate","formControlName","startDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["class","p-error",4,"ngIf"],["for","endDate",1,"font-medium","text-900"],["id","endDate","formControlName","endDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["for","status",1,"font-medium","text-900"],["formControlName","status","placeholder","St\xe1tusz...",3,"showClear"],["for","notes",1,"font-medium","text-900"],["id","notes","type","text","formControlName","notes","pInputTextarea","","rows","5"],[1,"block","p-error"],[1,"p-error"],[1,"flex","justify-content-end","ap-2"],["pButton","","pRipple","","label","M\xe9gsem","icon","pi pi-times",1,"p-button-outlined",3,"disabled","click"],["pButton","","pRipple","","label","Ment\xe9s","icon","pi pi-check",1,"p-button","ml-2",3,"disabled","click"],["pButton","","pRipple","","label","Nem","icon","pi pi-times",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Igen","icon","pi pi-check",1,"p-button","ml-2",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(r){return s.selected=r})("onLazyLoad",function(r){return s.onLazyLoad(r)}),e.YNc(5,Ht,42,18,"ng-template",5),e.YNc(6,Wt,37,5,"ng-template",6),e.YNc(7,ds,58,31,"ng-template",7),e.YNc(8,ps,3,1,"ng-template",8),e.qZA()(),e.TgZ(9,"p-sidebar",9),e.NdJ("visibleChange",function(r){return s.sidebar=r})("onHide",function(){return s.onSidebarHide()})("onShow",function(){return s.onSidebarShow()}),e.YNc(10,ms,2,1,"ng-template",6),e.YNc(11,Ss,45,39,"ng-container",10),e.YNc(12,Ts,3,2,"ng-template",11),e.qZA(),e.TgZ(13,"p-dialog",12),e.NdJ("visibleChange",function(r){return s.deleteDialog=r}),e.TgZ(14,"div",13),e._UZ(15,"i",14),e.YNc(16,Is,5,1,"span",10),e.qZA(),e.YNc(17,Es,2,0,"ng-template",11),e.qZA(),e.TgZ(18,"p-dialog",12),e.NdJ("visibleChange",function(r){return s.bulkDeleteDialog=r}),e.TgZ(19,"div",13),e._UZ(20,"i",14),e.TgZ(21,"span"),e._uU(22,"Biztosan t\xf6r\xf6lni akarja a kiv\xe1lasztott foglal\xe1sokat?"),e.qZA()(),e.YNc(23,As,2,0,"ng-template",11),e.qZA()()(),e.TgZ(24,"p-blockUI",15),e._UZ(25,"p-progressSpinner"),e.qZA(),e._UZ(26,"p-toast")(27,"p-confirmDialog",16)),2&t&&(e.xp6(3),e.Q6J("value",s.tableData)("rows",s.rowsPerPage)("totalRecords",s.totalRecords)("globalFilterFields",e.DdM(30,Zs))("paginator",!0)("rowsPerPageOptions",s.rowsPerPageOptions)("showCurrentPageReport",!0)("selection",s.selected)("tableStyle",e.DdM(31,ws))("rowHover",!0)("lazy",!0),e.xp6(6),e.Q6J("visible",s.sidebar)("transitionOptions",".3s cubic-bezier(0, 0, 0.2, 1)")("fullScreen",s.isMobile)("blockScroll",!0),e.xp6(2),e.Q6J("ngIf",s.sidebar),e.xp6(2),e.Akn(e.DdM(32,Ie)),e.Q6J("visible",s.deleteDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",s.tableItem),e.xp6(2),e.Akn(e.DdM(33,Ie)),e.Q6J("visible",s.bulkDeleteDialog)("modal",!0),e.xp6(6),e.Q6J("autoZIndex",!0)("blocked",s.loading),e.xp6(3),e.Akn(e.DdM(34,Fs)),e.Q6J("closable",!1))},dependencies:[f.mk,f.sg,f.O5,V.iA,S.jx,V.lQ,V.fz,V.UA,V.Mo,_._Y,_.Fj,_.JJ,_.JL,_.On,_.sg,_.u,P.Hq,H.H,le.FN,ce.o,ue.V,de.G,pe.b,me.Y,re.w,Le.n,Ge.p,Je,st,mt,W.u,ve.q,be.H,ye.f,Ce.g,Pt,f.uU,Y.X$],encapsulation:2})};se=(0,U.gn)([(0,Ae.k)()],se);let Rs=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({imports:[O.Bz.forChild([{path:"",component:se}]),O.Bz]})}return n})();var Ns=c(6263),ks=c(9502),Ms=c(5609),Os=c(6651),Ds=c(7902),Ls=c(1865),Gs=c(2285);let zs=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({providers:[ae],imports:[f.ez,Rs,V.U$,_.u5,_.UX,P.hJ,H.T,le.EV,ce.j,he.kW,ue.S,Ns.W,ks.$,de.L,pe.u,me.l,Gs.L,Ms.Iu,W.z,Os.q,ve.F,be.Q,Ds.JH,Ls.cc,Y.aw,ye._8,_e.o,Ce.A,qt]})}return n})()},746:(ee,$,c)=>{c.d($,{Q:()=>E});var f=c(5619),_=c(9397),O=c(6306),U=c(7398),D=c(2096),w=c(2029),J=c(8814);let E=(()=>{class A{constructor(d){this.apiService=d,this.apiURL=d.apiURL,this.data$=new f.X(null),this.createdGuest$=new f.X(null),this.message$=new f.X(null)}get guestObs(){return this.data$.asObservable()}get createdGuestObs(){return this.createdGuest$.asObservable()}get messageObs(){return this.message$.asObservable()}get(d,p,v,y){let x="";""!==v&&(x=""!=v.sortField?`sort=${v.sortField}&order=${1===v.sortOrder?"ASC":"DESC"}`:"");const Q=""!==x&&""!==y?x+"&"+y:""!==x&&""===y?x:""===x&&""!==y?y:"";this.apiService.get(`guest/get/${d}/${p}${""!==Q?"?"+Q:""}`).subscribe({next:j=>{this.data$.next(j)},error:j=>{this.message$.next(j)}})}getBySearch(d,p,v){let y={};p&&p.sortField&&(y.sort=p.sortField,y.order=1===p.sortOrder?"ASC":"DESC"),v&&v.length>0&&(y.conferenceIds=v.join(",")),this.apiService.get(`guest/search/${encodeURIComponent(d)}`,{params:y}).subscribe({next:x=>{this.data$.next(x)},error:x=>{this.message$.next(x)}})}getBySearchQuery(d){this.apiService.get(`guest/searchquery?${d}`).subscribe({next:p=>{this.data$.next(p)},error:p=>{this.message$.next(p)}})}getBySearchQuery$(d){return this.apiService.get(`guest/searchquery?${d}`)}getByConferenceName(d){return this.apiService.get(`guest/searchquery?conferenceName=${d}`)}getByRFID(d){return this.apiService.get(`guest/getbyrfid/${d}`)}updateLastTagUsage(d){this.apiService.get(`guest/updatelasttagusage/${d}`).subscribe({next:p=>{},error:p=>{this.message$.next(p)}})}create(d,p){const v=new FormData;if(v.append("guest",JSON.stringify(d)),p&&p.length>0)for(const y of p){if(!y)return;v.append("idcard",y,y.name)}this.apiService.post("guest/create/",v).subscribe({next:y=>{this.createdGuest$.next(y.guest);const x=this.registrationToast(y.guest),Q=this.emailStatusToast(y.email);this.message$.next(x),this.message$.next(Q)},error:y=>{this.message$.next({severity:"error",summary:"Vend\xe9g r\xf6gz\xedt\xe9s sikertelen",detail:y?.errorMessage||y?.message||"Ismeretlen hiba t\xf6rt\xe9nt."})}})}update(d,p=[]){const v={...d};if(delete v.idcard,p&&p.length>0){const y=new FormData;y.append("guest",JSON.stringify(v));for(const x of p)x&&y.append("idcard",x,x.name);this.apiService.put(`guest/update/${d.id}`,y).subscribe({next:()=>{this.message$.next("success")},error:x=>{this.message$.next(x)}})}else v.idCardUploaded=0,this.apiService.put(`guest/update/${d.id}`,v).subscribe({next:()=>{this.message$.next("success")},error:y=>{this.message$.next(y)}})}updateGuest2(d){return this.apiService.put(`guest/update/${d.id}`,d).pipe((0,_.b)(()=>console.log(`updated guest id=${d.id}`)),(0,O.K)(this.handleError("updateGuest2")))}delete(d){this.apiService.delete(`guest/delete/${d.id}`).subscribe({next:p=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${d.lastName} ${d.firstName} t\xf6r\xf6lve`})},error:p=>{this.message$.next(p)}})}bulkdelete(d){let p={ids:d.map(v=>v.id)};this.apiService.post("guest/bulkdelete",p).subscribe({next:v=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${d.length} vend\xe9g t\xf6r\xf6lve`})},error:v=>{this.message$.next(v)}})}searchGuestsForSelector$(d={}){const p=this.buildGuestQS(d);return this.apiService.get(`guest/searchquery?${p}`).pipe((0,U.U)(v=>v?v.rows??[]:[]))}buildGuestQS(d={}){const p=[];return null!=d.conferenceId&&p.push(`conferenceid=${encodeURIComponent(String(d.conferenceId))}`),"number"==typeof d.minBeds&&p.push(`minBeds=${d.minBeds}`),"boolean"==typeof d.climate&&p.push("climate="+(d.climate?1:0)),d.onlyNotReserved&&p.push("onlyNotReserved=true"),d.includeGuestIds?.length&&p.push(`includeGuestIds=${d.includeGuestIds.join(",")}`),d.enabled&&p.push("enabled=1"),p.join("&")}handleError(d="operation",p){return v=>(console.error(v),console.error(`${d} failed: ${v.message}`),(0,D.of)(p))}emailStatusToast(d){if(!d)return{severity:"warn",summary:"E-mail",detail:"E-mail st\xe1tusz ismeretlen."};switch(d.status){case"sent":return{severity:"success",summary:"E-mail",detail:"Visszaigazol\xf3 e-mail elk\xfcldve."};case"timeout":return{severity:"warn",summary:"E-mail",detail:"Az e-mail k\xfcld\xe9s id\u0151korl\xe1tot \xe9rt el."};case"failed":return{severity:"error",summary:"E-mail hiba",detail:d.message||"Az e-mail k\xfcld\xe9s nem siker\xfclt."};default:return{severity:"info",summary:"E-mail",detail:"E-mail st\xe1tusz: ismeretlen."}}}registrationToast(d){return{severity:"success",summary:"Vend\xe9g r\xf6gz\xedtve",detail:(d?.lastName&&d?.firstName?`${d.lastName} ${d.firstName}`:"Vend\xe9g")+" sikeresen r\xf6gz\xedtve."}}static#e=this.\u0275fac=function(p){return new(p||A)(w.LFG(J.s))};static#t=this.\u0275prov=w.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},1116:(ee,$,c)=>{function f(_,O){return U=>{const D=U.get(_)?.value,w=U.get(O)?.value;return D&&w&&(new Date(D)>new Date(w)||new Date(w)<new Date(D))?{dateRangeInvalid:!0}:null}}c.d($,{W:()=>f})},6218:(ee,$,c)=>{c.d($,{A:()=>D,g:()=>U});var f=c(2029),_=c(6814),O=c(6223);let U=(()=>{class w{el;ngModel;control;cd;autoResize;onResize=new f.vpe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(E,A,z,d){this.el=E,this.ngModel=A,this.control=z,this.cd=d}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(E){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(E){this.autoResize&&this.resize(E)}onBlur(E){this.autoResize&&this.resize(E)}resize(E){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(E||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(A){return new(A||w)(f.Y36(f.SBq),f.Y36(O.On,8),f.Y36(O.a5,8),f.Y36(f.sBO))};static \u0275dir=f.lG2({type:w,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(A,z){1&A&&f.NdJ("input",function(p){return z.onInput(p)})("focus",function(p){return z.onFocus(p)})("blur",function(p){return z.onBlur(p)}),2&A&&f.ekj("p-filled",z.filled)("p-inputtextarea-resizable",z.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}})}return w})(),D=(()=>{class w{static \u0275fac=function(A){return new(A||w)};static \u0275mod=f.oAB({type:w});static \u0275inj=f.cJS({imports:[_.ez]})}return w})()}}]);