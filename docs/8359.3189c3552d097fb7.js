"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[8359],{8359:(X,z,a)=>{a.r(z),a.d(z,{ReservationModule:()=>Mi});var f=a(6814),_=a(6223),D=a(1640),$=a(7582),O=a(8645),Z=a(5619),J=a(2181),I=a(7398),E=a(3997),M=a(2832),u=a(9360),m=a(4829),v=a(8251),x=a(4825);var ee=a(4664),U=a(3620),Ie=a(8180),Ee=a(4279),T=a(5219),Ze=a(1116);const ne=()=>function Ae(n){const s=t=>(t??[]).map(i=>{const o=n(i);return null==o?"\u2400":"number"==typeof o?`#${o}`:`@${o}`}).sort().join("|");return(0,E.x)((t,i)=>s(t)===s(i))}(n=>n.id);var oe=a(9474),Fe=a(217),F=a(6676),e=a(2029),we=a(2096),Re=a(9397),Ne=a(8814),B=a(9515);let re=(()=>{class n{get messageObs(){return this.message$.asObservable()}constructor(t,i){this.apiService=t,this.translate=i,this.cache=[],this.message$=new Z.X(null),this.apiURL=t.apiURL}get$(t,i,o,r){let l="";""!==o&&(l=o.sortField?`sort=${o.sortField}&order=${1===o.sortOrder?"ASC":"DESC"}`:"");const p=l&&r?`${l}&${r}`:l||r||"";return this.apiService.get(`reservation/get/${t}/${i}${p?`?${p}`:""}`)}getBySearch$(t,i){let o="";return""!==i&&(o=""!==i.sortField?`?sort=${i.sortField}&order=${1===i.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`reservation/search/${t}${o}`)}getBySearchQuery$(t){return this.apiService.get(`reservation/searchquery?${t}`)}getReservationsForSelector(){return this.cache.length?(0,we.of)(this.cache):this.apiService.get("reservation/get/0/999?sort=reservationNum&order=ASC").pipe((0,I.U)(t=>t?.rows??[]),(0,Re.b)(t=>{this.cache=t}))}create(t){this.apiService.post("reservation/create/",t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s r\xf6gz\xedt\xe9s",detail:"Foglal\xe1s r\xf6gz\xedtve"})},error:i=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem menthet\u0151",detail:this.localizeError(i)})}})}update(t){this.apiService.put(`reservation/update/${t.id}`,t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s m\xf3dos\xedt\xe1s",detail:"Foglal\xe1s m\xf3dos\xedtva"})},error:i=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem m\xf3dos\xedthat\xf3",detail:this.localizeError(i)})}})}delete(t){this.apiService.delete(`reservation/delete/${t.id}`).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:"Foglal\xe1s t\xf6r\xf6lve"})},error:i=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(i)})}})}bulkdelete(t){const i={ids:t.map(o=>o.id)};this.apiService.post("reservation/bulkdelete",i).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:`${t.length} foglal\xe1s t\xf6r\xf6lve`})},error:o=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(o)})}})}getRawBackendMessage(t){const i=t?.error;if(i&&"object"==typeof i&&"message"in i&&i.message)return String(i.message);if("string"==typeof i)try{const o=JSON.parse(i);if(o?.message)return String(o.message)}catch{return i}return t?.message??"Unknown error"}localize(t){return this.translate.instant(t)}localizeError(t){return this.localize(this.getRawBackendMessage(t))}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(Ne.s),e.LFG(B.sK))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ke=a(1206),De=a(219),Oe=a(8022),Q=a(9552),q=a(707),H=a(4480),le=a(4104),ae=a(3714),ce=a(7213),ue=a(7680),pe=a(4204),de=a(9246),Me=a(3069),Le=a(2991),me=a(3965);function Ge(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=s.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function ze(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=s.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function $e(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",2),e.NdJ("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(o))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,Ge,3,6,"ng-template",3),e.YNc(4,ze,3,6,"ng-template",4),e.qZA()}if(2&n){const t=s.ngIf,i=e.oxw();e.s9C("placeholder",e.lcZ(1,5,i.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("formControl",t)("options",i.statuses)("showClear",i.showClear)}}function Ue(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=s.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function Be(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=s.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function je(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",5),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedStatus=o)})("onChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(o))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,Ue,3,6,"ng-template",3),e.YNc(4,Be,3,6,"ng-template",4),e.qZA()}if(2&n){const t=e.oxw();e.s9C("placeholder",e.lcZ(1,5,t.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("ngModel",t.selectedStatus)("options",t.statuses)("showClear",t.showClear)}}let Je=(()=>{class n{constructor(t,i){this.translate=t,this.cdRef=i,this.change=new e.vpe,this.statuses=[],this.selectedStatus="",this.disabled=!1,this.onChange=o=>{},this.onTouched=()=>{},this.placeholder||(this.placeholder="V\xe1lasszon...")}ngOnInit(){this.translate.onLangChange.subscribe(()=>{this.setReservationStatuses()}),this.setReservationStatuses()}ngOnChanges(t){this.setReservationStatuses()}getFormControl(){return this.parentForm&&this.controlName?this.parentForm.get(this.controlName):null}setReservationStatuses(){this.statuses=[{label:"tentative",value:"tentative"},{label:"confirmed",value:"confirmed"},{label:"in_house",value:"in_house"},{label:"checked_out",value:"checked_out"},{label:"cancelled",value:"cancelled"}]}handleOnChange(t){this.selectedStatus=t.value,this.onChange(t.value),this.onTouched(),this.change.emit({value:t.value,field:this.controlName})}setDisabledState(t){this.disabled=t,this.cdRef.detectChanges()}writeValue(t){this.selectedStatus=t,this.cdRef.detectChanges()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(B.sK),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-reservation-status-selector"]],inputs:{parentForm:"parentForm",controlName:"controlName",placeholder:"placeholder",showClear:"showClear"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:3,vars:2,consts:[["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange",4,"ngIf","ngIfElse"],["useNgModel",""],["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange"],["pTemplate","item"],["pTemplate","selectedItem"],["optionLabel","label","optionValue","value","appendTo","body",3,"ngModel","options","placeholder","emptyMessage","showClear","ngModelChange","onChange"]],template:function(i,o){if(1&i&&(e.YNc(0,$e,5,9,"p-dropdown",0),e.YNc(1,je,5,9,"ng-template",null,1,e.W1O)),2&i){const r=e.MAs(2);e.Q6J("ngIf",o.getFormControl())("ngIfElse",r)}},dependencies:[f.O5,_.JJ,_.On,_.oH,T.jx,me.Lt,B.X$],encapsulation:2})}return n})();var he=a(7394),Ye=a(4520),ge=a(4055),K=a(3259);const Qe=["roomSelector"];function Ve(n,s){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function qe(n,s){1&n&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function Pe(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function He(n,s){if(1&n&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,Ve,2,1,"span",11),e.YNc(12,qe,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,Pe,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&n){const t=s.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function Ke(n,s){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function We(n,s){1&n&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function Xe(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function et(n,s){if(1&n&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,Ke,2,1,"span",11),e.YNc(12,We,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,Xe,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&n){const t=s.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}let tt=(()=>{class n{set preselectIds(t){const o=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=o.length?o:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,i,o){this.roomService=t,this.messageService=i,this.cdr=o,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.rooms=[],this.originalRooms=[],this.selectedRooms=[],this.subscriptions=new he.w0,this.suppress=0,this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.rooms=[],this.loading=!1,void this.cdr.markForCheck();const i=(this.selectedRooms??[]).map(c=>this.toNumId(c?.id)).filter(c=>null!=c),r=Array.from(new Set([...i,...this._pendingSelectIds??[]])),l={...t,...r.length?{includeRoomIds:r}:{}},p=this.roomService.searchRoomsForSelector$(l).subscribe({next:c=>{this.rooms=c??[],this.originalRooms=this.rooms.slice(),this.loading=!1,this.syncSelectedRooms(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:c=>{this.rooms=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rooms."})}});this.subscriptions.add(p)}setSelection(t,i){const o=i?.source??"programmatic";this.runSilently(()=>{this.selectedRooms=t?.slice(0,this.selectionLimit??t.length)??[]}),i?.emit&&this.emit(this.selectedRooms,o,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedRooms.length&&this.rooms.length&&(this.runSilently(()=>{this.selectedRooms=this.rooms.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedRooms,"auto-select-first",!0))}preselectByIds(){if(!this.rooms?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),i=this.rooms.filter(p=>{const c=this.toNumId(p?.id);return null!=c&&t.has(c)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:i.length,l=i.slice(0,r);this.runSilently(()=>{this.selectedRooms=l,this.roomSelectorRef?.writeValue(this.selectedRooms)}),this.onChange(this.selectedRooms),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedRooms,"preselect-id",!0),this._pendingSelectIds=void 0}setDisabledState(t){this.disabled=t,this.roomSelectorRef&&(this.roomSelectorRef.disabled=t)}syncSelectedRooms(){this.selectedRooms=this.rooms.filter(t=>{const i=this.toNumId(t?.id);return null!=i&&this.selectedRooms.some(o=>this.toNumId(o?.id)===i)}),this.onChange(this.selectedRooms)}onSelectionChange(t){this.selectedRooms=t.value||[],this.emit(this.selectedRooms,"user"),1==this.selectionLimit&&this.selectedRooms?.length>=1&&setTimeout(()=>this.roomSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedRooms=[],this.roomSelectorRef&&this.roomSelectorRef.writeValue([])}),this.emit(this.selectedRooms,"user",!0)}emit(t,i,o=!1){this.suppress&&!o||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:i}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}writeValue(t){const i=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:i.length;this.runSilently(()=>{this.selectedRooms=i.slice(0,r),this.roomSelectorRef&&this.roomSelectorRef.writeValue(this.selectedRooms)}),this.emitOnWriteValue&&this.emit(this.selectedRooms,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Ye.X),e.Y36(T.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-room-selector"]],viewQuery:function(i,o){if(1&i&&e.Gf(Qe,5),2&i){let r;e.iGM(r=e.CRH())&&(o.roomSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:5,vars:13,consts:[["dataKey","id","optionLabel","roomNum","optionDisabled","disabled","filterBy","roomNum","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["roomSelector",""],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"]],template:function(i,o){1&i&&(e.TgZ(0,"p-multiSelect",0,1),e.NdJ("ngModelChange",function(l){return o.selectedRooms=l})("onChange",function(l){return o.onSelectionChange(l)})("onClear",function(){return o.onSelectionClear()}),e.ALo(2,"translate"),e.YNc(3,He,17,14,"ng-template",2),e.YNc(4,et,17,14,"ng-template",3),e.qZA()),2&i&&(e.Akn(o.style),e.s9C("emptyMessage",e.lcZ(2,11,"Nincs tal\xe1lat...")),e.Q6J("options",o.rooms)("ngModel",o.selectedRooms)("disabled",o.disabled)("selectionLimit",o.selectionLimit)("placeholder",o.placeholder)("virtualScroll",!0)("virtualScrollItemSize",50)("showClear",o.showClear))},dependencies:[f.O5,_.JJ,_.On,T.jx,ge.NU,K.u,B.X$],encapsulation:2,changeDetection:0})}return n})();var it=a(746),fe=a(2169);const st=["guestSelector"];function nt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"p-chip",8),e.NdJ("onRemove",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.removeGuest(r))}),e.qZA()}if(2&n){const t=s.$implicit,i=e.oxw(2);e.s9C("pTooltip",t.roomMate),e.Q6J("label",t.lastName+" "+t.firstName)("removable",!0)("styleClass","cursor-pointer color-badge "+i.getColorByRoomType((null==t?null:t.roomType)||""))}}function ot(n,s){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,nt,1,4,"p-chip",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.selectedGuests)("ngForTrackBy",t.trackByGuestId)}}const rt=function(n,s,t){return{"pi-check-square":n,"pi-minus-square":s,"pi-square":t}};function lt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.toggleGroupSelection(l,o))}),e._UZ(1,"i",10),e.TgZ(2,"span",11),e._uU(3),e.qZA(),e.TgZ(4,"span",12),e._uU(5),e.qZA()()}if(2&n){const t=s.$implicit,i=e.oxw();e.Q6J("pTooltip",t.explanation),e.xp6(1),e.Q6J("ngClass",e.kEZ(4,rt,i.isGroupFullySelected(t),i.isGroupPartiallySelected(t),!i.isGroupFullySelected(t)&&!i.isGroupPartiallySelected(t))),e.xp6(2),e.Oqu(t.label),e.xp6(2),e.hij("(",t.items.length," f\u0151)")}}function at(n,s){1&n&&(e.TgZ(0,"span",21),e._uU(1,"\u2744\ufe0f"),e.qZA())}function ct(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function ut(n,s){if(1&n&&(e.TgZ(0,"div")(1,"div",13)(2,"div",14)(3,"div",15)(4,"span",16),e._uU(5),e.TgZ(6,"span",17),e._uU(7),e.qZA(),e.YNc(8,at,2,0,"span",18),e.qZA(),e.TgZ(9,"span",19),e._uU(10),e.YNc(11,ct,2,1,"span",20),e._uU(12,") "),e.qZA()()()()()),2&n){const t=s.$implicit,i=e.oxw();e.Gre("building-badge ",i.getColorByRoomType(t.roomType)," border-round-xl w-min p-0"),e.xp6(2),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",i.getAge(t.birthDate),")"),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function pt(n,s){if(1&n&&(e.TgZ(0,"div")(1,"div",13)(2,"div",22)(3,"div",15)(4,"span",16),e._uU(5),e.TgZ(6,"span",17),e._uU(7),e.qZA()(),e.TgZ(8,"span",19),e._uU(9),e.qZA(),e.TgZ(10,"div",23),e._uU(11),e.qZA()()()()()),2&n){const t=s.$implicit,i=e.oxw();e.Gre("color-badge ",i.getColorByRoomType(t.roomType)," border-round-xl w-min p-0"),e.xp6(2),e.s9C("pTooltip",t.roomMate),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",i.getAge(t.birthDate),")"),e.xp6(2),e.hij(" ",t.roomType," "),e.xp6(2),e.hij(" ",t.roomMate," ")}}F.locale("hu");let dt=(()=>{class n{set preselectIds(t){const o=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=o.length?o:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,i,o){this.guestService=t,this.messageService=i,this.cdr=o,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.groupByRoomMate=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.guests=[],this.originalGuests=[],this.selectedGuests=[],this.groupedGuests=[],this.roomTypes=[{value:"Nem k\xe9rek sz\xe1ll\xe1st",color:"gray"},{value:"Kast\xe9ly sz\xe1ll\xe1s 4 \xe1gyas szoba",color:"teal"},{value:"Kast\xe9ly sz\xe1ll\xe1s 6 \xe1gyas szoba",color:"teal"},{value:"Kast\xe9ly sz\xe1ll\xe1s 8 \xe1gyas szoba",color:"teal"},{value:"Maranatha Panzi\xf3h\xe1z 2 \xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Maranatha Panzi\xf3h\xe1z francia\xe1gyas szoba (k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Maranatha Panzi\xf3h\xe1z 4 \xe1gyas szoba (emeletes \xe1gyas, k\xfcl\xf6n f\xfcrd\u0151s)",color:"yellow"},{value:"Csal\xe1di szoba (k\xf6z\xf6s konyh\xe1val, f\xfcrd\u0151vel \xe9s nappalival)",color:"orange"}],this.subscriptions=new he.w0,this.suppress=0,this.roomTypeColorMap=new Map(this.roomTypes.map(r=>[r.value.toLowerCase(),r.color])),this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload(),t.preselectIds&&this.preselectByIds()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.guests=[],this.loading=!1,void this.cdr.markForCheck();const i=(this.selectedGuests??[]).map(p=>this.toNumId(p?.id)).filter(p=>null!=p),r=Array.from(new Set([...i,...this._pendingSelectIds??[]])),l={...t,...r.length?{includeGuestIds:r}:{}};this.reloadSub?.unsubscribe(),this.reloadSub=this.guestService.searchGuestsForSelector$(l).subscribe({next:p=>{let c=(p??[]).map(h=>({...h,fullName:`${h.lastName??""} ${h.firstName??""}`.trim()}));this.guests=c,this.groupedGuests=this.groupByRoomMate?this.buildRoomMateGroups(c):[],this.loading=!1,this.syncSelectedGuests(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:p=>{this.guests=[],this.loading=!1,this.cdr.markForCheck(),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load guests."})}}),this.subscriptions.add(this.reloadSub)}preselectByIds(){if(!this.guests?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),i=this.guests.filter(p=>{const c=this.toNumId(p?.id);return null!=c&&t.has(c)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:i.length,l=i.slice(0,r);this.runSilently(()=>{this.selectedGuests=l,this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.onChange(this.selectedGuests),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedGuests,"preselect-id",!0),this._pendingSelectIds=void 0}buildRoomMateGroups(t){const i=g=>(g??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g," ").trim(),o=g=>`${g.lastName??""} ${g.firstName??""}`.trim()||(g.fullName??""),r=[];for(const g of t){const d=this.toNumId(g?.id);null!=d&&r.push({id:d,name:i(`${g.lastName??""} ${g.firstName??""}`),mates:i(g.roomMate),guest:g})}const l=new Map,p=new Map;r.forEach(g=>p.set(g.id,g));const c=g=>{let d=l.get(g);return d||(d=new Set,l.set(g,d)),d};for(let g=0;g<r.length;g++){const d=r[g];for(let S=g+1;S<r.length;S++){const y=r[S];d.name&&y.name&&(d.mates&&d.mates.includes(y.name)||y.mates&&y.mates.includes(d.name))&&(c(d.id).add(y.id),c(y.id).add(d.id))}}const h=new Set,A=new Set,C=[],G=g=>{const d=[g],S=[];for(h.add(g);d.length;){const y=d.pop();S.push(y);const j=l.get(y);if(j)for(const V of j)h.has(V)||(h.add(V),d.push(V))}return S.forEach(y=>A.add(y)),S};for(const g of l.keys()){if(h.has(g))continue;const d=G(g);if(d.length>=2){const S=d.map(w=>p.get(w)).filter(w=>!!w);let y,j=-1;for(const w of S){let k=0;for(const P of S)P.id!==w.id&&P.mates&&P.mates.includes(w.name)&&k++;(k>j||k===j&&y&&w.id<y.id)&&(j=k,y=w)}const V=o(y?y.guest:S[0].guest),Li=S.map(w=>w.guest).sort((w,k)=>i(o(w)).localeCompare(i(o(k)))),ie=[];for(const w of S){const k=w.guest.roomMate;if(k&&"string"==typeof k&&k.trim().length>0){const P=o(w.guest);ie.push(`${P}: "${k.trim()}"`)}}const Gi=ie.length>0?ie.join("\n"):"K\xf6zvetett kapcsolat r\xe9v\xe9n";C.push({groupId:C.length,label:V?`${V} csoport`:"Szobat\xe1rs csoport",items:Li,explanation:Gi})}}const N=[];return r.forEach(g=>{A.has(g.id)||N.push(g.guest)}),N.length&&(N.sort((g,d)=>i(o(g)).localeCompare(i(o(d)))),C.push({groupId:C.length,label:"Nincs megadott szobat\xe1rs / egyed\xfcl lakna",items:N})),C.sort((g,d)=>{const S=d.items.length-g.items.length;return 0!==S?S:g.label.localeCompare(d.label)}),C}getGroupIds(t){return(t.items??[]).map(i=>this.toNumId(i?.id)).filter(i=>null!=i)}isGroupFullySelected(t){const i=this.getGroupIds(t);if(!i.length||!this.selectedGuests?.length)return!1;const o=new Set((this.selectedGuests??[]).map(r=>this.toNumId(r?.id)).filter(r=>null!=r));return i.every(r=>o.has(r))}isGroupPartiallySelected(t){const i=this.getGroupIds(t);if(!i.length||!this.selectedGuests?.length)return!1;const o=new Set((this.selectedGuests??[]).map(l=>this.toNumId(l?.id)).filter(l=>null!=l)),r=i.filter(l=>o.has(l)).length;return r>0&&r<i.length}toggleGroupSelection(t,i){i&&(i.stopPropagation(),i.preventDefault());const o=t.items??[],r=this.selectedGuests??[],l=new Set(r.map(A=>this.toNumId(A?.id)).filter(A=>null!=A)),p=this.getGroupIds(t),c=p.length>0&&p.every(A=>l.has(A));let h=r.slice();if(c)h=h.filter(A=>{const C=this.toNumId(A?.id);return null==C||!p.includes(C)});else{for(const G of o){const N=this.toNumId(G?.id);null!=N&&!l.has(N)&&h.push(G)}const C=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:h.length;h.length>C&&(h=h.slice(0,C))}this.runSilently(()=>{this.selectedGuests=h,this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.emit(this.selectedGuests,"user",!0),this.cdr.markForCheck()}setSelection(t,i){const o=i?.source??"programmatic";this.runSilently(()=>{this.selectedGuests=t?.slice(0,this.selectionLimit??t.length)??[]}),i?.emit&&this.emit(this.selectedGuests,o,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedGuests.length&&this.guests.length&&(this.runSilently(()=>{this.selectedGuests=this.guests.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedGuests,"auto-select-first",!0))}setDisabledState(t){this.disabled=t,this.guestSelectorRef&&(this.guestSelectorRef.disabled=t)}syncSelectedGuests(){this.selectedGuests=this.guests.filter(t=>{const i=this.toNumId(t?.id);return null!=i&&this.selectedGuests.some(o=>this.toNumId(o?.id)===i)}),this.onChange(this.selectedGuests)}onSelectionChange(t){this.selectedGuests=t.value,this.emit(this.selectedGuests,"user"),1==this.selectionLimit&&this.selectedGuests?.length>=1&&setTimeout(()=>this.guestSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedGuests=[],this.guestSelectorRef?.writeValue([])}),this.emit(this.selectedGuests,"user",!0)}emit(t,i,o=!1){this.suppress&&!o||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:i}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}getAge(t){if(!t)return"";const i=F(t);return F().diff(i,"years").toString()}getColorByRoomType(t){return t?this.roomTypeColorMap.get(t.trim().toLowerCase())??"":""}removeGuest(t){const i=(this.selectedGuests??[]).filter(o=>o.id!==t.id);this.selectedGuests=i,"function"==typeof this.onChange&&this.onChange(this.selectedGuests)}clearAllGuests(){this.selectedGuests=[],"function"==typeof this.onChange&&this.onChange(this.selectedGuests)}trackByGuestId(t,i){return i.id}writeValue(t){const i=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:i.length;this.runSilently(()=>{this.selectedGuests=i.slice(0,r),this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.emitOnWriteValue&&this.emit(this.selectedGuests,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(it.Q),e.Y36(T.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-guest-selector"]],viewQuery:function(i,o){if(1&i&&e.Gf(st,5),2&i){let r;e.iGM(r=e.CRH())&&(o.guestSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",groupByRoomMate:"groupByRoomMate",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],decls:7,vars:15,consts:[["class","flex flex-wrap gap-2 mb-2",4,"ngIf"],["panelStyleClass","guest-multiselect-panel","dataKey","id","optionLabel","fullName","optionDisabled","disabled","optionGroupChildren","items","filterBy","lastName,firstName,roomMate","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","group","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["guestSelector",""],["pTemplate","group"],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","flex-wrap","gap-2","mb-2"],["icon","pi pi-user","tooltipPosition","top",3,"label","removable","styleClass","pTooltip","onRemove",4,"ngFor","ngForOf","ngForTrackBy"],["icon","pi pi-user","tooltipPosition","top",3,"label","removable","styleClass","pTooltip","onRemove"],["tooltipPosition","top",1,"flex","align-items-center","px-1","cursor-pointer","bg-surface-100",3,"pTooltip","click"],[1,"pi","mr-2",2,"font-size","1.3rem",3,"ngClass"],[1,"font-semibold"],[1,"ml-2","text-xs","text-500"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],[1,"font-normal","text-sm","uppercase"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"pl-1"],["tooltipPosition","top",1,"block","min-w-max",3,"pTooltip"],[1,"font-light","text-xs","white-space-nowrap","overflow-hidden","text-overflow-ellipsis","max-w-30rem"]],template:function(i,o){1&i&&(e.YNc(0,ot,2,2,"div",0),e.TgZ(1,"p-multiSelect",1,2),e.NdJ("ngModelChange",function(l){return o.selectedGuests=l})("onChange",function(l){return o.onSelectionChange(l)})("onClear",function(){return o.onSelectionClear()}),e.ALo(3,"translate"),e.YNc(4,lt,6,8,"ng-template",3),e.YNc(5,ut,13,11,"ng-template",4),e.YNc(6,pt,12,9,"ng-template",5),e.qZA()),2&i&&(e.Q6J("ngIf",null==o.selectedGuests?null:o.selectedGuests.length),e.xp6(1),e.Akn(o.style),e.s9C("emptyMessage",e.lcZ(3,13,"Nincs tal\xe1lat...")),e.Q6J("options",o.groupByRoomMate?o.groupedGuests:o.guests)("group",o.groupByRoomMate)("ngModel",o.selectedGuests)("disabled",o.disabled)("selectionLimit",o.selectionLimit)("placeholder",o.placeholder)("virtualScroll",!o.groupByRoomMate)("virtualScrollItemSize",o.groupByRoomMate?0:65)("showClear",o.showClear))},dependencies:[f.mk,f.sg,f.O5,_.JJ,_.On,fe.A,T.jx,ge.NU,K.u,B.X$],styles:['@charset "UTF-8";[_nghost-%COMP%]     .guest-multiselect-panel .p-multiselect-items .p-multiselect-item{padding:.15rem .5rem!important}[_nghost-%COMP%]     .guest-multiselect-panel .p-multiselect-item-group{padding:.2rem .5rem!important}'],changeDetection:0})}return n})();var _e=a(8039),ve=a(8676),be=a(3212),ye=a(6218),R=a(6825),L=a(2076),Ce=a(2591),xe=a(7778),W=a(2332);const mt=["content"];function ht(n,s){1&n&&e.GkF(0)}function gt(n,s){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,ht,1,0,"ng-container",11),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngTemplateOutlet",t.headerTemplate)}}function ft(n,s){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Oqu(t.option("header"))}}const _t=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function vt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw(4);return e.KtG(r.close(o))})("keydown.enter",function(o){e.CHM(t);const r=e.oxw(4);return e.KtG(r.close(o))}),e._UZ(1,"TimesIcon"),e.qZA()}2&n&&e.Q6J("ngClass",e.DdM(1,_t))}function bt(n,s){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,ft,2,1,"span",12),e.TgZ(2,"div",13),e.YNc(3,vt,2,2,"button",14),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.option("header")),e.xp6(2),e.Q6J("ngIf",t.closable)}}function yt(n,s){if(1&n&&e._UZ(0,"i",1),2&n){const t=e.oxw(3);e.Tol(t.option("icon")),e.Q6J("ngClass","p-confirm-dialog-icon")}}function Ct(n,s){1&n&&e.GkF(0)}function xt(n,s){if(1&n&&(e.TgZ(0,"div",17),e.Hsn(1),e.YNc(2,Ct,1,0,"ng-container",11),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngTemplateOutlet",t.footerTemplate)}}function Tt(n,s){if(1&n&&e._UZ(0,"i"),2&n){const t=e.oxw(6);e.Tol(t.option("rejectIcon"))}}function St(n,s){1&n&&e._UZ(0,"TimesIcon",24),2&n&&e.Q6J("styleClass","p-button-icon-left")}function It(n,s){if(1&n&&(e.ynx(0),e.YNc(1,Tt,1,2,"i",22),e.YNc(2,St,1,1,"TimesIcon",23),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngIf",t.option("rejectIcon")),e.xp6(1),e.Q6J("ngIf",!t.option("rejectIcon"))}}function Et(n,s){}function Zt(n,s){1&n&&e.YNc(0,Et,0,0,"ng-template")}function At(n,s){if(1&n&&(e.TgZ(0,"span",25),e.YNc(1,Zt,1,0,null,11),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngTemplateOutlet",t.rejectIconTemplate)}}function Ft(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.reject())}),e.YNc(1,It,3,2,"ng-container",20),e.YNc(2,At,2,1,"span",21),e.qZA()}if(2&n){const t=e.oxw(4);e.Tol(t.option("rejectButtonStyleClass")),e.Q6J("label",t.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),e.uIk("aria-label",t.rejectAriaLabel),e.xp6(1),e.Q6J("ngIf",!t.rejectIconTemplate),e.xp6(1),e.Q6J("ngIf",t.rejectIconTemplate)}}function wt(n,s){if(1&n&&e._UZ(0,"i"),2&n){const t=e.oxw(6);e.Tol(t.option("acceptIcon"))}}function Rt(n,s){1&n&&e._UZ(0,"CheckIcon",24),2&n&&e.Q6J("styleClass","p-button-icon-left")}function Nt(n,s){if(1&n&&(e.ynx(0),e.YNc(1,wt,1,2,"i",22),e.YNc(2,Rt,1,1,"CheckIcon",23),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngIf",t.option("acceptIcon")),e.xp6(1),e.Q6J("ngIf",!t.option("acceptIcon"))}}function kt(n,s){}function Dt(n,s){1&n&&e.YNc(0,kt,0,0,"ng-template")}function Ot(n,s){if(1&n&&(e.TgZ(0,"span",25),e.YNc(1,Dt,1,0,null,11),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngTemplateOutlet",t.acceptIconTemplate)}}function Mt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.accept())}),e.YNc(1,Nt,3,2,"ng-container",20),e.YNc(2,Ot,2,1,"span",21),e.qZA()}if(2&n){const t=e.oxw(4);e.Tol(t.option("acceptButtonStyleClass")),e.Q6J("label",t.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),e.uIk("aria-label",t.acceptAriaLabel),e.xp6(1),e.Q6J("ngIf",!t.acceptIconTemplate),e.xp6(1),e.Q6J("ngIf",t.acceptIconTemplate)}}function Lt(n,s){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,Ft,3,7,"button",18),e.YNc(2,Mt,3,7,"button",18),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.option("rejectVisible")),e.xp6(1),e.Q6J("ngIf",t.option("acceptVisible"))}}const Gt=function(n){return{"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":n}},zt=function(n,s){return{transform:n,transition:s}},$t=function(n){return{value:"visible",params:n}};function Ut(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("@animation.start",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onAnimationStart(o))})("@animation.done",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onAnimationEnd(o))}),e.YNc(1,gt,2,1,"div",4),e.YNc(2,bt,4,2,"div",4),e.TgZ(3,"div",5,6),e.YNc(5,yt,1,3,"i",7),e._UZ(6,"span",8),e.qZA(),e.YNc(7,xt,3,1,"div",9),e.YNc(8,Lt,3,2,"div",9),e.qZA()}if(2&n){const t=e.oxw(2);e.Tol(t.styleClass),e.Q6J("ngClass",e.VKq(11,Gt,t.rtl))("ngStyle",t.style)("@animation",e.VKq(16,$t,e.WLB(13,zt,t.transformOptions,t.transitionOptions))),e.xp6(1),e.Q6J("ngIf",t.headerTemplate),e.xp6(1),e.Q6J("ngIf",!t.headerTemplate),e.xp6(3),e.Q6J("ngIf",t.option("icon")),e.xp6(1),e.Q6J("innerHTML",t.option("message"),e.oJD),e.xp6(1),e.Q6J("ngIf",t.footer||t.footerTemplate),e.xp6(1),e.Q6J("ngIf",!t.footer&&!t.footerTemplate)}}function Bt(n,s){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,Ut,9,18,"div",2),e.qZA()),2&n){const t=e.oxw();e.Tol(t.maskStyleClass),e.Q6J("ngClass",t.getMaskClass()),e.xp6(1),e.Q6J("ngIf",t.visible)}}const jt=[[["p-footer"]]],Jt=["p-footer"],Yt=(0,R.oQ)([(0,R.oB)({transform:"{{transform}}",opacity:0}),(0,R.jt)("{{transition}}",(0,R.oB)({transform:"none",opacity:1}))]),Qt=(0,R.oQ)([(0,R.jt)("{{transition}}",(0,R.oB)({transform:"{{transform}}",opacity:0}))]);let Vt=(()=>{class n{el;renderer;confirmationService;zone;cd;config;document;header;icon;message;get style(){return this._style}set style(t){this._style=t,this.cd.markForCheck()}styleClass;maskStyleClass;acceptIcon;acceptLabel;acceptAriaLabel;acceptVisible=!0;rejectIcon;rejectLabel;rejectAriaLabel;rejectVisible=!0;acceptButtonStyleClass;rejectButtonStyleClass;closeOnEscape=!0;dismissableMask;blockScroll=!0;rtl=!1;closable=!0;appendTo;key;autoZIndex=!0;baseZIndex=0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";focusTrap=!0;defaultFocus="accept";breakpoints;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(t){switch(this._position=t,t){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onHide=new e.vpe;footer;contentViewChild;templates;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"rejecticon":this.rejectIconTemplate=t.template;break;case"accepticon":this.acceptIconTemplate=t.template}})}headerTemplate;footerTemplate;rejectIconTemplate;acceptIconTemplate;confirmation;_visible;_style;maskVisible;documentEscapeListener;container;wrapper;contentContainer;subscription;maskClickListener;preWidth;_position="center";transformOptions="scale(0.7)";styleElement;id=(0,W.Th)();confirmationOptions;translationSubscription;constructor(t,i,o,r,l,p,c){this.el=t,this.renderer=i,this.confirmationService=o,this.zone=r,this.cd=l,this.config=p,this.document=c,this.subscription=this.confirmationService.requireConfirmation$.subscribe(h=>{h?h.key===this.key&&(this.confirmation=h,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:!1===this.confirmation.closeOnEscape||!0===this.confirmation.closeOnEscape?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:!1===this.confirmation.dismissableMask||!0===this.confirmation.dismissableMask?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new e.vpe,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new e.vpe,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}option(t){const i=this.confirmationOptions||this;if(i.hasOwnProperty(t))return i[t]}onAnimationStart(t){if("visible"===t.toState){this.container=t.element,this.wrapper=this.container?.parentElement,this.contentContainer=L.p.findSingle(this.container,".p-dialog-content"),this.container?.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();const i=this.getElementToFocus();i&&i.focus()}}onAnimationEnd(t){"void"===t.toState&&this.onOverlayHide()}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":default:return L.p.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return L.p.findSingle(this.container,".p-confirm-dialog-reject");case"close":return L.p.findSingle(this.container,".p-dialog-header-close");case"none":return null}}appendContainer(){this.appendTo&&("body"===this.appendTo?this.document.body.appendChild(this.wrapper):L.p.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&L.p.addClass(this.document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&L.p.removeClass(this.document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=this.document.createElement("style"),this.styleElement.type="text/css",this.document.head.appendChild(this.styleElement);let t="";for(let i in this.breakpoints)t+=`\n                    @media screen and (max-width: ${i}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[i]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=t}}close(t){this.confirmation?.rejectEvent&&this.confirmation.rejectEvent.emit(T.wB.CANCEL),this.hide(T.wB.CANCEL),t.preventDefault()}hide(t){this.onHide.emit(t),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(W.P9.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let t={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return t[this.getPositionClass().toString()]=!0,t}getPositionClass(){const i=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(o=>o===this.position);return i?`p-dialog-${i}`:""}bindGlobalListeners(){(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",i=>{if(27==i.which&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===W.P9.get(this.container)&&this.visible&&this.close(i),9===i.which&&this.focusTrap){i.preventDefault();let o=L.p.getFocusableElements(this.container);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);i.shiftKey?-1==r||0===r?o[o.length-1].focus():o[r-1].focus():-1==r||r===o.length-1?o[0].focus():o[r+1].focus()}else o[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&W.P9.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(this.document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(T.wB.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(T.wB.REJECT),this.hide(T.wB.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(T.ws.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(T.ws.REJECT)}static \u0275fac=function(i){return new(i||n)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(T.YP),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(T.b4),e.Y36(f.K0))};static \u0275cmp=e.Xpm({type:n,selectors:[["p-confirmDialog"]],contentQueries:function(i,o,r){if(1&i&&(e.Suo(r,T.$_,5),e.Suo(r,T.jx,4)),2&i){let l;e.iGM(l=e.CRH())&&(o.footer=l.first),e.iGM(l=e.CRH())&&(o.templates=l)}},viewQuery:function(i,o){if(1&i&&e.Gf(mt,5),2&i){let r;e.iGM(r=e.CRH())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:"acceptVisible",rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:"rejectVisible",acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",blockScroll:"blockScroll",rtl:"rtl",closable:"closable",appendTo:"appendTo",key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",transitionOptions:"transitionOptions",focusTrap:"focusTrap",defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},ngContentSelectors:Jt,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-dialog-message",3,"innerHTML"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button",3,"ngClass","click","keydown.enter"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"label","ngClass","click"],[4,"ngIf"],["class","p-button-icon-left",4,"ngIf"],[3,"class",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon-left"]],template:function(i,o){1&i&&(e.F$t(jt),e.YNc(0,Bt,2,4,"div",0)),2&i&&e.Q6J("ngIf",o.maskVisible)},dependencies:function(){return[f.mk,f.O5,f.tP,f.PC,q.Hq,H.H,xe.q,Ce.n]},styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[(0,R.X$)("animation",[(0,R.eR)("void => visible",[(0,R._7)(Yt)]),(0,R.eR)("visible => void",[(0,R._7)(Qt)])])]},changeDetection:0})}return n})(),qt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[f.ez,q.hJ,H.T,xe.q,Ce.n,q.hJ,T.m8]})}return n})();const Pt=function(){return{minWidth:"35rem"}};function Ht(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"h5",18),e._uU(2,"Foglal\xe1sok"),e.qZA(),e.TgZ(3,"span",19)(4,"app-conference-selector",20),e.NdJ("ngModelChange",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedConferences=o)})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.doQuery())}),e.qZA()(),e.TgZ(5,"span",21)(6,"div",22)(7,"div",23)(8,"div",24),e.O4$(),e.TgZ(9,"svg",25),e._UZ(10,"g",26)(11,"g",27),e.TgZ(12,"g",28)(13,"g",29)(14,"g",30),e._UZ(15,"path",31),e.qZA()()()(),e.kcU(),e.TgZ(16,"span",32),e._uU(17),e.qZA()()()()(),e.TgZ(18,"span",21)(19,"div",22)(20,"div",23)(21,"div",24),e._UZ(22,"i",33),e.TgZ(23,"span",32),e._uU(24),e.qZA()()()()(),e.TgZ(25,"span",21)(26,"div",34)(27,"div",23)(28,"div",24),e._UZ(29,"i",33),e.TgZ(30,"span",32),e._uU(31),e.qZA()()()()(),e.TgZ(32,"span",21)(33,"div",35)(34,"div",23)(35,"div",24),e._UZ(36,"i",33),e.TgZ(37,"span",32),e._uU(38),e.qZA()()()()(),e.TgZ(39,"span",19)(40,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.create())}),e.qZA(),e.TgZ(41,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.bulkDeleteDialog=!0)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Akn(e.DdM(17,Pt)),e.Q6J("ngModel",t.selectedConferences)("emitOnSelectFirstOption",!0)("showNoneOption",!1)("selectionLimit",1)("showClear",!0),e.xp6(2),e.MGl("pTooltip","\xc1gyak sz\xe1ma: ",t.totalBeds,""),e.xp6(11),e.hij(" ",t.totalBeds," "),e.xp6(2),e.MGl("pTooltip","Regisztr\xe1lt vend\xe9gek: ",t.registeredGuests,""),e.xp6(5),e.hij(" ",t.registeredGuests," "),e.xp6(2),e.MGl("pTooltip","Vend\xe9gek foglal\xe1ssal: ",t.reservedGuests,""),e.xp6(5),e.hij(" ",t.reservedGuests," "),e.xp6(2),e.MGl("pTooltip","Szob\xe1ra v\xe1r\xf3k: ",t.waitingForRoom,""),e.xp6(5),e.hij(" ",t.waitingForRoom," "),e.xp6(2),e.Q6J("disabled",!t.canCreate),e.xp6(1),e.Q6J("disabled",!t.selected||!t.selected.length||!t.canDelete)}}function Kt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th",38),e._uU(3,"Szoba "),e._UZ(4,"p-sortIcon",39),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Vend\xe9gek"),e.qZA(),e.TgZ(7,"th",40),e._uU(8,"\xc9rkez\xe9s "),e._UZ(9,"p-sortIcon",41),e.qZA(),e.TgZ(10,"th",42),e._uU(11,"T\xe1voz\xe1s "),e._UZ(12,"p-sortIcon",43),e.qZA(),e.TgZ(13,"th",44),e._uU(14,"St\xe1tusz "),e._UZ(15,"p-sortIcon",45),e.qZA(),e.TgZ(16,"th",46),e._uU(17,"Megjegyz\xe9s "),e._UZ(18,"p-sortIcon",47),e.qZA(),e._UZ(19,"th"),e.qZA(),e.TgZ(20,"tr")(21,"th",48),e._UZ(22,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(23,"th")(24,"input",49),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.roomNum"))}),e.qZA(),e.TgZ(25,"app-building-selector",50),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.building"))}),e.qZA(),e.TgZ(26,"app-bedtype-selector",51),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"room.bedType"))}),e.qZA()(),e.TgZ(27,"th")(28,"input",52),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"guests"))}),e.qZA()(),e.TgZ(29,"th")(30,"p-calendar",53),e.NdJ("onSelect",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"startDate"))})("onClearClick",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"startDate"))}),e.qZA()(),e.TgZ(31,"th")(32,"p-calendar",53),e.NdJ("onSelect",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"endDate"))})("onClearClick",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"endDate"))}),e.qZA()(),e.TgZ(33,"th")(34,"app-reservation-status-selector",54),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"status"))}),e.qZA()(),e.TgZ(35,"th")(36,"input",55),e.NdJ("input",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(o,"notes"))}),e.qZA()(),e._UZ(37,"th"),e.qZA()}2&n&&(e.xp6(25),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("showClear",!0),e.xp6(4),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showClear",!0))}function Wt(n,s){if(1&n&&(e.TgZ(0,"span",76),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.room.floor,")")}}function Xt(n,s){1&n&&(e.TgZ(0,"span",77),e._uU(1,"\u2744\ufe0f"),e.qZA())}function ei(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.room.bathroom,"")}}function ti(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"img",83),e.BQk()),2&n){const t=e.oxw(2).ngIf,i=e.oxw(2);e.xp6(1),e.cQ8("pTooltip","",t[0].lastName," ",t[0].firstName," (",i.getAge(t[0].birthDate),")")}}function ii(n,s){if(1&n&&(e._UZ(0,"img",83),e.TgZ(1,"span",84),e._uU(2),e.qZA()),2&n){const t=e.oxw(2).ngIf,i=e.oxw(2);e.s9C("pTooltip",i.getBabyBedTooltip(t)),e.xp6(2),e.hij(" ",t.length," ")}}function si(n,s){if(1&n&&(e.TgZ(0,"div",79)(1,"div",23)(2,"div",80),e.YNc(3,ti,2,3,"ng-container",81),e.YNc(4,ii,3,2,"ng-template",null,82,e.W1O),e.qZA()()()),2&n){const t=e.MAs(5),i=e.oxw().ngIf;e.xp6(3),e.Q6J("ngIf",1===i.length)("ngIfElse",t)}}function ni(n,s){if(1&n&&(e.ynx(0),e.YNc(1,si,6,2,"div",78),e.BQk()),2&n){const t=s.ngIf;e.xp6(1),e.Q6J("ngIf",t.length>0)}}function oi(n,s){if(1&n&&e._UZ(0,"p-avatar",85),2&n){const t=s.$implicit,i=e.oxw(2);e.hYB("pTooltip","",t.lastName+" "+t.firstName," (",i.getAge(t.birthDate),")")}}function ri(n,s){if(1&n&&e._UZ(0,"p-avatar",86),2&n){const t=s.ngIf,i=e.oxw(2);e.Akn(i.capacityStyle(t)),e.s9C("pTooltip",i.capacityTooltip(t)),e.Q6J("label",i.formatCapacityLabel(t))}}function li(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit;e.Gre("reservation-status-badge ",t.status,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.status?null:t.status.toUpperCase()))," ")}}function ai(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",56),e.qZA(),e.TgZ(3,"td")(4,"span",57),e._uU(5,"Szoba"),e.qZA(),e.TgZ(6,"div",58)(7,"div")(8,"div",23)(9,"div",24),e._UZ(10,"i",59),e.TgZ(11,"span",60),e._uU(12),e.qZA()(),e.TgZ(13,"div",61)(14,"div",62)(15,"span",63),e._uU(16),e.ALo(17,"translate"),e.YNc(18,Wt,2,1,"span",64),e.YNc(19,Xt,2,0,"span",65),e.qZA(),e.TgZ(20,"span",66),e._uU(21),e.YNc(22,ei,2,1,"span",10),e._uU(23,") "),e.qZA()()()()(),e.YNc(24,ni,2,1,"ng-container",10),e.qZA()(),e.TgZ(25,"td")(26,"span",57),e._uU(27,"Vend\xe9gek"),e.qZA(),e.TgZ(28,"p-avatarGroup"),e.YNc(29,oi,1,2,"p-avatar",67),e.YNc(30,ri,1,4,"p-avatar",68),e.qZA()(),e.TgZ(31,"td",69)(32,"span",57),e._uU(33,"\xc9rkez\xe9s"),e.qZA(),e.TgZ(34,"span",70),e._UZ(35,"i",71),e._uU(36),e.ALo(37,"date"),e.qZA()(),e.TgZ(38,"td",69)(39,"span",57),e._uU(40,"T\xe1voz\xe1s"),e.qZA(),e.TgZ(41,"span",70),e._UZ(42,"i",71),e._uU(43),e.ALo(44,"date"),e.qZA()(),e.TgZ(45,"td",69)(46,"span",57),e._uU(47,"St\xe1tusz"),e.qZA(),e.YNc(48,li,3,6,"span",72),e.qZA(),e.TgZ(49,"td")(50,"span",57),e._uU(51,"Megjegyz\xe9s"),e.qZA(),e._uU(52),e.qZA(),e.TgZ(53,"td")(54,"div",73)(55,"button",74),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.edit(r))}),e.qZA(),e.TgZ(56,"button",75),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return l.tableItem=r,e.KtG(l.deleteDialog=!0)}),e.qZA()()()()}if(2&n){const t=s.$implicit,i=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(5),e.Gre("building-badge ",t.room.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.room.roomNum,""),e.xp6(1),e.hij(" ",t.room.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.room.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(17,22,"BUILDINGS."+t.room.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.room.floor),e.xp6(1),e.Q6J("ngIf",t.room.climate),e.xp6(2),e.AsE(" ",t.room.beds," SZEM\xc9LYES (",t.room.bedType,""),e.xp6(1),e.Q6J("ngIf",t.room.bathroom),e.xp6(2),e.Q6J("ngIf",i.getBabyBedGuests(t)),e.xp6(5),e.Q6J("ngForOf",t.guests),e.xp6(1),e.Q6J("ngIf",i.getFreeCapacity(t)),e.xp6(6),e.hij(" ",e.xi3(37,24,t.startDate,"yyyy.MM.dd")," "),e.xp6(7),e.hij(" ",e.xi3(44,27,t.endDate,"yyyy.MM.dd")," "),e.xp6(5),e.Q6J("ngIf",t.status),e.xp6(4),e.hij(" ",t.notes," "),e.xp6(3),e.Q6J("disabled",!i.canEdit),e.xp6(1),e.Q6J("disabled",!i.canDelete)}}function ci(n,s){1&n&&(e.TgZ(0,"tr")(1,"td",87),e._uU(2,"Nincs tal\xe1lat..."),e.qZA()()),2&n&&(e.xp6(1),e.uIk("colspan",8))}function ui(n,s){if(1&n&&(e.TgZ(0,"span",88),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",null!=t.id&&t.id.value?"Foglal\xe1s adatai":"\xdaj foglal\xe1s"," ")}}function pi(n,s){1&n&&(e.TgZ(0,"div",112),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function di(n,s){1&n&&(e.TgZ(0,"div",112),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function mi(n,s){1&n&&(e.TgZ(0,"div",112),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function hi(n,s){1&n&&(e.TgZ(0,"div",113),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function gi(n,s){1&n&&(e.TgZ(0,"div",113),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function fi(n,s){1&n&&(e.TgZ(0,"div",113),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function _i(n,s){1&n&&(e.TgZ(0,"div",113),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function vi(n,s){1&n&&(e.TgZ(0,"div",112),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function bi(n,s){1&n&&(e.TgZ(0,"div",112),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}const Te=function(n){return{"ng-invalid":n}};function yi(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",89),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._UZ(2,"input",90)(3,"input",91)(4,"input",92)(5,"input",93),e.TgZ(6,"div",94)(7,"label",95),e._uU(8,"Konferencia"),e.qZA(),e._UZ(9,"app-conference-selector",96),e.YNc(10,pi,2,0,"div",97),e.qZA(),e.TgZ(11,"div",94)(12,"label",98),e._uU(13,"Vend\xe9g"),e.qZA(),e._UZ(14,"app-guest-selector",99),e.YNc(15,di,2,0,"div",97),e.qZA(),e.TgZ(16,"div",94)(17,"label",100),e._uU(18,"Szoba"),e.qZA(),e._UZ(19,"app-room-selector",101),e.YNc(20,mi,2,0,"div",97),e.qZA(),e.TgZ(21,"div",102)(22,"label",103),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"p-calendar",104),e.YNc(26,hi,3,3,"div",105),e.YNc(27,gi,3,3,"div",105),e.qZA(),e.TgZ(28,"div",102)(29,"label",106),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"p-calendar",107),e.YNc(33,fi,3,3,"div",105),e.YNc(34,_i,3,3,"div",105),e.qZA(),e.TgZ(35,"div",94)(36,"label",108),e._uU(37,"St\xe1tusz"),e.qZA(),e._UZ(38,"app-reservation-status-selector",109),e.YNc(39,vi,2,0,"div",97),e.qZA(),e.TgZ(40,"div",94)(41,"label",110),e._uU(42,"Megjegyz\xe9s"),e.qZA(),e._UZ(43,"textarea",111),e.YNc(44,bi,2,0,"div",97),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.reservationForm),e.xp6(8),e.Q6J("preselectIds",t.preselectConferenceId)("showNoneOption",!1)("selectionLimit",1)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.conference?null:t.conference.dirty)&&(null==t.conference||null==t.conference.errors?null:t.conference.errors.required)),e.xp6(4),e.Q6J("filter",t.guestFilter)("preselectIds",t.preselectGuestIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("groupByRoomMate",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.guests?null:t.guests.dirty)&&(null==t.guests||null==t.guests.errors?null:t.guests.errors.required)),e.xp6(4),e.Q6J("filter",t.roomFilter)("selectionLimit",1)("preselectIds",t.preselectRoomIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.room?null:t.room.dirty)&&(null==t.room||null==t.room.errors?null:t.room.errors.required)),e.xp6(3),e.hij(" ",e.lcZ(24,31,"\xc9rkez\xe9s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(35,Te,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.startDate?null:t.startDate.dirty)&&(null==t.startDate||null==t.startDate.errors?null:t.startDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(3),e.hij(" ",e.lcZ(31,33,"T\xe1voz\xe1s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(37,Te,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.endDate?null:t.endDate.dirty)&&(null==t.endDate||null==t.endDate.errors?null:t.endDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(4),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.status?null:t.status.dirty)&&(null==t.status||null==t.status.errors?null:t.status.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.notes?null:t.notes.dirty)&&(null==t.notes||null==t.notes.errors?null:t.notes.errors.required))}}function Ci(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",114)(1,"button",115),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancel())}),e.qZA(),e.TgZ(2,"button",116),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.reservationForm.dirty),e.xp6(1),e.Q6J("disabled",!t.reservationForm.valid||!t.reservationForm.dirty)}}function xi(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1,"Biztosan t\xf6r\xf6lni akarja a(z) "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4," szoba foglal\xe1s\xe1t?"),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(null==t.tableItem.room?null:t.tableItem.room.roomNum)}}function Ti(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",117),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",118),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.delete())}),e.qZA()}}function Si(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",117),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.bulkDeleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",118),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteSelected())}),e.qZA()}}const Ii=function(){return["roomNum"]},Ei=function(){return{"min-height":"calc(100vh - 320px)"}},Se=function(){return{width:"450px"}},Zi=function(){return{width:"28rem"}};F.locale("hu");let te=class se{constructor(s,t,i,o,r,l,p,c){this.reservationService=s,this.userService=t,this.conferenceService=i,this.confirmationService=o,this.messageService=r,this.responsiveService=l,this.route=p,this.fb=c,this.loading=!0,this.tableItem={},this.tableData=[],this.rowsPerPageOptions=[20,50,100,200],this.rowsPerPage=20,this.totalRecords=0,this.page=0,this.sortField="id",this.sortOrder=1,this.globalFilter="",this.filterValues={},this.debounce={},this.sidebar=!1,this.deleteDialog=!1,this.bulkDeleteDialog=!1,this.selected=[],this.canCreate=!1,this.canEdit=!1,this.canDelete=!1,this.isMobile=!1,this.isOrganizer=!1,this.selectedConferences=[],this.totalBeds=0,this.registeredGuests=0,this.reservedGuests=0,this.waitingForRoom=0,this.datesTouchedByUser=!1,this.conferenceStart=null,this.conferenceEnd=null,this.preselectGuestIds=[],this.roomFilter={enabled:!0},this.guestFilter={enabled:!0},this.suppressEmits=!1,this.initialFormValues={id:null,room:null,room_id:null,conference:[],conference_id:null,startDate:"",endDate:"",status:"confirmed",notes:"",guests:[],guestIds:[]},this.INITIAL_FORM_STATE_CLOSED={id:{value:null,disabled:!1},room:{value:null,disabled:!0},room_id:{value:null,disabled:!1},conference:{value:[],disabled:!1},conference_id:{value:null,disabled:!1},startDate:{value:null,disabled:!0},endDate:{value:null,disabled:!0},status:{value:"confirmed",disabled:!1},notes:{value:"",disabled:!1},guests:{value:[],disabled:!0},guestIds:{value:[],disabled:!1}},this.lastSelectionByRoom=new Map,this.bedFullWarnedByGuest=new Set,this.query$=new O.x,this.formChanges$=new O.x,this.reservationForm=this.fb.group({id:this.INITIAL_FORM_STATE_CLOSED.id,room:[this.INITIAL_FORM_STATE_CLOSED.room,_.kI.required],room_id:[this.INITIAL_FORM_STATE_CLOSED.room_id,_.kI.required],conference:[this.INITIAL_FORM_STATE_CLOSED.conference,_.kI.required],conference_id:[this.INITIAL_FORM_STATE_CLOSED.conference_id,_.kI.required],startDate:[this.INITIAL_FORM_STATE_CLOSED.startDate,_.kI.required],endDate:[this.INITIAL_FORM_STATE_CLOSED.endDate,_.kI.required],status:this.INITIAL_FORM_STATE_CLOSED.status,notes:this.INITIAL_FORM_STATE_CLOSED.notes,guests:[this.INITIAL_FORM_STATE_CLOSED.guests,_.kI.required],guestIds:[this.INITIAL_FORM_STATE_CLOSED.guestIds,_.kI.required]},{validators:(0,Ze.W)("startDate","endDate")}),this.isFormValid$=new Z.X(!1)}ngOnInit(){this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(s=>this.canCreate=s),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(s=>this.canEdit=s),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(s=>this.canDelete=s),this.userService.hasRole(["Szervezo"]).subscribe(s=>this.isOrganizer=s),this.room?.disable({emitEvent:!1}),this.querySub=this.query$.pipe((0,J.h)(()=>(this.selectedConferences?.length??0)>0),(0,I.U)(s=>({key:this.buildQueryKey(),force:!!s?.force})),(0,E.x)((s,t)=>!t.force&&s.key===t.key),function Y(n,s=M.z){return function b(n){return(0,u.e)((s,t)=>{let i=!1,o=null,r=null,l=!1;const p=()=>{if(r?.unsubscribe(),r=null,i){i=!1;const h=o;o=null,t.next(h)}l&&t.complete()},c=()=>{r=null,l&&t.complete()};s.subscribe((0,v.x)(t,h=>{i=!0,o=h,r||(0,m.Xf)(n(h)).subscribe(r=(0,v.x)(t,p,c))},()=>{l=!0,(!i||!r||r.closed)&&t.complete()}))})}(()=>(0,x.H)(n,s))}(50),(0,ee.w)(()=>{this.loading=!0,this.filterValues.conference_id=(this.selectedConferences??[]).map(i=>i.id).join(",");const s=Object.keys(this.filterValues).map(i=>this.filterValues[i]?.length?`${i}=${this.filterValues[i]}`:"").filter(Boolean).join("&"),t=this.sortField?{sortField:this.sortField,sortOrder:this.sortOrder}:"";return""!==this.globalFilter?this.reservationService.getBySearch$(this.globalFilter,t):this.reservationService.get$(this.page,this.rowsPerPage,t,s)})).subscribe({next:s=>{this.loading=!1,this.tableData=s?.rows??[],this.totalRecords=s?.totalItems??0,this.page=s?.currentPage??0,this.totalBeds=s?.summary?.totalBeds??0,this.registeredGuests=s?.summary?.registeredGuests??0,this.reservedGuests=s?.summary?.reservedGuests??0,this.waitingForRoom=s?.summary?.waitingForRoom??0},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Hiba t\xf6rt\xe9nt!"})}}),this.conference?.valueChanges.pipe(ne(),(0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(s=>{const t=s?.[0];this.applyConferenceSideEffects(t)}),this.room?.valueChanges.pipe(ne()).subscribe(s=>{const t=s?.[0];this.reservationForm.patchValue({room_id:t?.id??null},{emitEvent:!1}),null!=t?.id&&this.validateCapacityForCurrentSelection(t)}),this.guests?.valueChanges.pipe((0,I.U)(s=>Array.isArray(s)?s:s?[s]:[]),(0,I.U)(s=>({guestsArr:s,ids:Array.from(new Set(s.map(t=>t?.id).filter(t=>null!=t)))})),(0,E.x)((s,t)=>s.ids.length===t.ids.length&&s.ids.every((i,o)=>i===t.ids[o]))).subscribe(({guestsArr:s,ids:t})=>{const i=this.getSelectedRoom();if(i&&!this.onGuestsSelectionChange(i,s)||(this.reservationForm.patchValue({guestIds:t},{emitEvent:!1}),!this.sidebar||this.suppressEmits||this.id?.value)||this.datesTouchedByUser)return;const o=this.computeGuestDateRange(s);if(o.minArrival&&o.maxDeparture){const l=o.minArrival.format("YYYY-MM-DD"),p=o.maxDeparture.format("YYYY-MM-DD"),c=this.startDate?.value,h=this.endDate?.value;(c!==l||h!==p)&&this.reservationForm.patchValue({startDate:l,endDate:p},{emitEvent:!1})}else{const l=Array.isArray(this.conference?.value)?this.conference.value:[],p=l.length?l[0]:null;if(p){const c=p.beginDate?F(p.beginDate).format("YYYY-MM-DD"):null,h=p.endDate?F(p.endDate).format("YYYY-MM-DD"):null;this.reservationForm.patchValue({startDate:c,endDate:h},{emitEvent:!1})}}}),this.startDate?.valueChanges.pipe((0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(()=>{this.id?.value||(this.datesTouchedByUser=!0)}),this.endDate?.valueChanges.pipe((0,J.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(()=>{this.id?.value||(this.datesTouchedByUser=!0)}),this.responsiveService.isMobile$.subscribe(s=>{this.isMobile=s}),this.isFormValid$=this.formChanges$.pipe((0,U.b)(300),(0,E.x)(),(0,I.U)(()=>this.reservationForm.valid)),this.serviceMessageObs$=this.reservationService.messageObs,this.conferenceMessageObs$=this.conferenceService.messageObs,this.serviceMessageObs$.subscribe(s=>this.handleMessage(s)),this.conferenceMessageObs$.subscribe(s=>this.handleMessage(s)),this.initDeepLinkFromReservationId()}initDeepLinkFromReservationId(){this.route.queryParamMap.pipe((0,I.U)(s=>{const t=s.get("conference_id"),i=s.get("reservation_id"),o=s.get("open"),r=null!=t?Number(t):null,l=null!=i?Number(i):null,p="1"===o||"true"===o||"yes"===o;return{conferenceId:Number.isFinite(r)?r:null,reservationId:Number.isFinite(l)?l:null,autoOpen:p}}),(0,E.x)((s,t)=>s.conferenceId===t.conferenceId&&s.reservationId===t.reservationId&&s.autoOpen===t.autoOpen)).subscribe(({conferenceId:s,reservationId:t,autoOpen:i})=>{if(!t)return this.filterValues.id&&(delete this.filterValues.id,this.doQuery(!0)),void(this.sidebar&&this.closeSidebar());s&&(this.selectedConferences=[{id:s}]),this.reservationService.get$(0,1,{sortField:"id",sortOrder:1},`id=${t}`).pipe((0,I.U)(r=>r?.rows?.[0]||null),(0,Ie.q)(1)).subscribe({next:r=>{if(!r)return void this.messageService.add({severity:"warn",summary:"Figyelem",detail:"A megadott foglal\xe1s nem tal\xe1lhat\xf3."});const l=r.conference_id??r.conference?.id??null;!s&&l&&(this.selectedConferences=[{id:l}]),this.filterValues={...this.filterValues,id:String(r.id)},this.page=0,this.doQuery(!0),i&&this.edit(r)},error:()=>{this.messageService.add({severity:"warn",summary:"Figyelem",detail:"A megadott foglal\xe1s nem tal\xe1lhat\xf3."})}})})}get id(){return this.reservationForm.get("id")}get room(){return this.reservationForm.get("room")}get room_id(){return this.reservationForm.get("room_id")}get conference(){return this.reservationForm.get("conference")}get conference_id(){return this.reservationForm.get("conference_id")}get startDate(){return this.reservationForm.get("startDate")}get endDate(){return this.reservationForm.get("endDate")}get status(){return this.reservationForm.get("status")}get notes(){return this.reservationForm.get("notes")}get guests(){return this.reservationForm.get("guests")}get guestIds(){return this.reservationForm.get("guestIds")}doQuery(s=!1){if(!this.selectedConferences?.length)return this.tableData=[],this.totalRecords=0,void(this.loading=!1);this.query$.next({force:s})}onFilter(s,t){if(this.isOrganizer&&0===this.selectedConferences.length)return;let o="";s instanceof Date?o=F(s).format("YYYY.MM.DD"):s&&(s.value||s.target?.value)?(o=s.value||s.target?.value,o=o.toString()):this.filterValues[t]="",this.filterValues[t]=o,["conferenceName","room.building","room.bedType","status"].includes(t)?this.filterValues[t]===o&&this.doQuery():(this.debounce[t]&&clearTimeout(this.debounce[t]),this.debounce[t]=setTimeout(()=>{this.filterValues[t]===o&&this.doQuery()},500))}onLazyLoad(s){this.page=s.first/s.rows,this.rowsPerPage=s.rows??this.rowsPerPage,this.sortField=s.sortField??"",this.sortOrder=-1===s.sortOrder?-1:1,this.globalFilter=s.globalFilter??"",this.doQuery()}onGlobalFilter(s,t){s.filterGlobal(t.target.value,"contains")}onSidebarShow(){this.sidebar=!0;const s=!this.id?.value,t=this.selectedConferences?.[0];s&&t?(this.preselectConferenceId=t.id,this.reservationForm.patchValue({conference:[t]},{emitEvent:!0}),queueMicrotask(()=>this.applyConferenceSideEffects(t))):(this.preselectConferenceId=void 0,queueMicrotask(()=>this.applyConferenceSideEffects()))}onSidebarHide(){this.suppressEmits=!0,this.sidebar=!1,this.datesTouchedByUser=!1,this.reservationForm.reset(this.INITIAL_FORM_STATE_CLOSED,{emitEvent:!0}),this.preselectConferenceId=void 0,this.preselectRoomIds=void 0,this.preselectGuestIds=[],this.originalFormValues=void 0,this.preselectConferenceId=void 0,this.reservationForm.markAsPristine(),this.reservationForm.markAsUntouched(),queueMicrotask(()=>this.suppressEmits=!1)}closeSidebar(){this.sidebar=!1}onGuestsSelectionChange(s,t){const i=Number(s?.id),o=Number(s?.beds??0),r=Number(s?.extraBeds??0),l=o+r,p=this.lastSelectionByRoom.get(i)??[],c=t.map(d=>d.id).filter(d=>null!=d),h=c.length;if(this.isOrganizer&&l>0&&h>l){const d=new Map(t.filter(y=>y&&null!=y.id).map(y=>[y.id,y])),S=p.map(y=>d.get(y)).filter(y=>!!y);return this.suppressEmits=!0,this.reservationForm.patchValue({guests:S,guestIds:p},{emitEvent:!1}),this.suppressEmits=!1,this.lastSelectionByRoom.set(i,p),this.messageService.add({severity:"warn",summary:"Szoba megtelt",detail:`A szoba maxim\xe1lis kapacit\xe1sa ${l} f\u0151. T\xf6bb vend\xe9g nem helyezhet\u0151 el ebben a szob\xe1ban.`,life:8e3}),!1}const A=new Set(p),C=c.filter(d=>!A.has(d)),G=C.length?C[C.length-1]:null,N=Math.max(0,h-o);if(C.map((d,S)=>({id:d,pos:p.length+S+1})).filter(d=>d.pos>o).map(d=>d.id).filter(d=>!this.bedFullWarnedByGuest.has(`${i}:${d}`)).forEach(d=>this.bedFullWarnedByGuest.add(`${i}:${d}`)),N>0)if(1===N&&null!=G){const d=t.find(y=>y.id===G),S=d&&`${d.lastName??""} ${d.firstName??""}`.trim()||"A vend\xe9g";this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${S} m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1})}else this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${N} f\u0151 m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1});return this.lastSelectionByRoom.set(i,c),h<=o&&[...this.bedFullWarnedByGuest].filter(d=>d.startsWith(`${i}:`)).forEach(d=>this.bedFullWarnedByGuest.delete(d)),!0}create(){this.suppressEmits=!0,this.datesTouchedByUser=!1,this.preselectConferenceId=void 0,this.preselectRoomIds=void 0,this.preselectGuestIds=[],this.bedFullWarnedByGuest.clear(),this.lastSelectionByRoom.clear(),this.roomFilter={enabled:!0},this.guestFilter={enabled:!0},this.reservationForm.reset(this.INITIAL_FORM_STATE_CLOSED,{emitEvent:!1}),this.reservationForm.markAsPristine(),this.reservationForm.markAsUntouched(),this.originalFormValues=this.reservationForm.getRawValue(),this.suppressEmits=!1,this.sidebar=!0}edit(s){this.reservationForm.reset(this.initialFormValues,{emitEvent:!1});const t=s.conference??(s.conference_id?{id:s.conference_id}:null);this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null},{emitEvent:!0});const i=s.room??(s.room_id?{id:s.room_id}:null),o=Array.isArray(s.guests)?s.guests:[],r=Array.from(new Set(o.map(l=>"string"==typeof l?.id?Number(l.id):l?.id).filter(l=>Number.isFinite(l))));this.suppressEmits=!0,this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null,guests:o,guestIds:r,startDate:s.startDate??null,endDate:s.endDate??null},{emitEvent:!1}),this.preselectGuestIds=r,this.roomFilter={...this.roomFilter,conferenceId:t?.id??null,includeRoomIds:i?.id?[i.id]:[]},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null,includeGuestIds:this.preselectGuestIds},this.room?.enable({emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1}),this.reservationForm.patchValue({id:s.id??null,room:i?[i]:[],room_id:i?.id??null,guests:o,guestIds:Array.from(new Set(r)),status:s.status??"confirmed",notes:s.notes??null},{emitEvent:!1}),this.preselectRoomIds=i?.id??null,this.preselectGuestIds=Array.from(new Set(r)),this.suppressEmits=!1,this.originalFormValues=this.reservationForm.getRawValue(),this.sidebar=!0,i?.id&&this.lastSelectionByRoom.set(i.id,this.preselectGuestIds??[])}delete(){this.loading=!0,this.deleteDialog=!1,this.reservationService.delete(this.tableItem)}deleteSelected(){this.loading=!0,this.bulkDeleteDialog=!1,this.reservationService.bulkdelete(this.selected)}save(){if(!this.reservationForm.valid)return;this.loading=!0;const s=this.reservationForm.value,t=r=>Array.isArray(r)?r[0]?.id??null:r?.id??null,i=Array.isArray(s.guestIds)?Array.from(new Set(s.guestIds.map(r=>Number(r)).filter(r=>Number.isFinite(r)))):Array.isArray(s.guests)?Array.from(new Set(s.guests.map(r=>Number(r?.id)).filter(r=>Number.isFinite(r)))):s.guests?.id?[Number(s.guests.id)]:[],o={room_id:t(s.room)??s.room_id??null,conference_id:t(s.conference)??s.conference_id??null,startDate:s.startDate,endDate:s.endDate,status:s.status??"confirmed",notes:s.notes??null};if(s.id){const r={id:s.id,...o,guestIds:i};this.reservationService.update(r)}else{const r={...o,guestIds:i};this.reservationService.create(r)}this.doQuery()}cancel(){this.reservationForm.reset(this.originalFormValues)}handleMessage(s){if(s){if(this.loading=!1,"ERROR"==s||"error"===s?.severity)return void this.messageService.add({severity:"error",summary:s?.summary??"Error",detail:s?.detail??"Hiba t\xf6rt\xe9nt!"});this.messageService.add(s),this.tableItem={},this.selected=[],this.doQuery(!0),this.closeSidebar()}}onConfChange(s){this.selectedConferences=s.value,("user"===s.source||"auto-select-first"===s.source)&&(this.tableData=[],this.doQuery())}getAge(s){if(!s)return"";const t=F(s);return F().diff(t,"years").toString()}getBabyBedCount(s){if(!s?.guests||!s.guests.length)return 0;const t=F();return s.guests.reduce((i,o)=>{if(!o?.birthDate)return i;const r=t.diff(F(o.birthDate),"years");return r>=0&&r<3?i+1:i},0)}getBabyBedGuests(s){if(!s?.guests||!s.guests.length)return[];const t=F();return s.guests.filter(i=>{if(!i?.birthDate)return!1;const o=t.diff(F(i.birthDate),"years");return o>=0&&o<3})}getFreeCapacity(s){const t=s?.guests?.length??0;return(s?.room?.beds??0)+(s?.room?.extraBeds??0)-t}capacityStyle(s){return{"background-color":s<0?"#EF4444":"#22C55E",color:"#ffffff"}}capacityTooltip(s){return s<0?`T\xfalfoglalva ${Math.abs(s)} f\u0151vel`:`Szabad \xe1gy ${s} f\u0151 r\xe9sz\xe9re`}formatCapacityLabel(s){return s>0?`+${s}`:s<0?`${Math.abs(s)}`:""}exportExcel(){a.e(1486).then(a.bind(a,1486)).then(s=>{const t=[{key:"reservationNum",label:"Szoba-sz\xe1m"},{key:"reservationCode",label:"Szoba k\xf3d"},{key:"beds",label:"\xc1gyak sz\xe1ma"},{key:"spareBeds",label:"Matrac / gyerek\xe1gy"},{key:"building",label:"\xc9p\xfclet / folyos\xf3"},{key:"bedType",label:"\xc1gy t\xedpus"},{key:"bathreservation",label:"F\xfcrd\u0151szoba"},{key:"notes",label:"Megjegyz\xe9s"}],o=(this.selected.length>0?this.selected:this.tableData).map(c=>{let h={};return t.forEach(A=>{h[A.label]=c[A.key]??""}),h}),l={Sheets:{data:s.utils.json_to_sheet(o,{header:t.map(c=>c.label)})},SheetNames:["data"]},p=s.write(l,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(p,"reservations")})}saveAsExcelFile(s,t){const r=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Fe.saveAs(r,t+"_export_"+F().format("YYYYMMDD")+".xlsx")}fromYMD(s){const[t,i,o]=s.split("-").map(Number);return new Date(t,i-1,o)}toYMD(s){return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}buildQueryKey(){const s=(this.selectedConferences??[]).map(i=>i.id).sort().join(","),t=Object.keys(this.filterValues).map(i=>this.filterValues[i]?`${i}=${this.filterValues[i]}`:"").filter(Boolean).join("&");return[this.page,this.rowsPerPage,this.sortField,this.sortOrder,this.globalFilter||"",s,t].join("|")}getSelectedRoom(){const s=this.room?.value;return Array.isArray(s)&&s.length?s[0]:null}validateCapacityForCurrentSelection(s){const t=Number(s?.id),i=Number(s?.beds??0),o=Number(s?.extraBeds??0),r=Array.isArray(this.guests?.value)?this.guests.value:[],l=r.map(c=>c?.id).filter(c=>null!=c);[...this.bedFullWarnedByGuest].filter(c=>c.startsWith(`${t}:`)).forEach(c=>this.bedFullWarnedByGuest.delete(c));const p=Math.max(0,l.length-i);if(p<=0)this.lastSelectionByRoom.set(t,l);else{for(let c=i;c<l.length;c++)this.bedFullWarnedByGuest.add(`${t}:${l[c]}`);if(1===p){const c=l[i],h=r.find(C=>C.id===c),A=h&&`${h.lastName??""} ${h.firstName??""}`.trim()||"A vend\xe9g";this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${A} m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1,accept:()=>{const C=i+o;l.length>C&&this.messageService.add({severity:"warn",summary:"Kev\xe9s f\xe9r\u0151hely",detail:`\xd6sszes kapacit\xe1s: ${C} (\xe1gy + matrac/gyerek\xe1gy), kijel\xf6lve: ${l.length}. ${l.length-C} f\u0151 t\xe9nylegesen nem f\xe9r be.`,life:15e3})}})}else this.confirmationService.confirm({header:"Figyelmeztet\xe9s",message:`${p} f\u0151 m\xe1r nem f\xe9r \xe1gyra! Matracra vagy gyerek\xe1gyra ker\xfclhet.`,icon:"pi pi-exclamation-triangle",acceptLabel:"OK",rejectVisible:!1,accept:()=>{const c=i+o;l.length>c&&this.messageService.add({severity:"warn",summary:"Kev\xe9s f\xe9r\u0151hely",detail:`\xd6sszes kapacit\xe1s: ${c} (\xe1gy + matrac/gyerek\xe1gy), kijel\xf6lve: ${l.length}. ${l.length-c} f\u0151 t\xe9nylegesen nem f\xe9r be.`,life:15e3})}});this.lastSelectionByRoom.set(t,l)}}applyConferenceSideEffects(s){const t=s??(Array.isArray(this.conference?.value)&&this.conference.value.length?this.conference.value[0]:null),i=!this.id?.value,o=c=>c?F(c).format("YYYY-MM-DD"):null;this.reservationForm.patchValue({conference_id:t?.id??null},{emitEvent:!1}),this.roomFilter={...this.roomFilter,conferenceId:t?.id??null},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null};const r=this.startDate?.value,l=this.endDate?.value,p={};t?((i||!r)&&(p.startDate=o(t.beginDate)),(i||!l)&&(p.endDate=o(t.endDate)),Object.keys(p).length&&this.reservationForm.patchValue(p,{emitEvent:!1}),this.room?.enable({emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1})):(i&&this.reservationForm.patchValue({startDate:null,endDate:null},{emitEvent:!1}),this.room?.disable({emitEvent:!1}),this.guests?.disable({emitEvent:!1}),this.startDate?.disable({emitEvent:!1}),this.endDate?.disable({emitEvent:!1}))}computeGuestDateRange(s){let t=null,i=null;for(const o of s??[]){const r=o.dateOfArrival,l=o.dateOfDeparture,p=r?F(r,"YYYY-MM-DD",!0):null,c=l?F(l,"YYYY-MM-DD",!0):null;p&&p.isValid()&&(!t||p.isBefore(t))&&(t=p),c&&c.isValid()&&(!i||c.isAfter(i))&&(i=c)}return{minArrival:t,maxDeparture:i}}getBabyBedTooltip(s){return s?.length?s.map(t=>{const i=`${t.lastName??""} ${t.firstName??""}`.trim(),o=this.getAge(t.birthDate);return o?`${i} (${o})`:i}).join(", "):""}ngOnDestroy(){}static#e=this.\u0275fac=function(t){return new(t||se)(e.Y36(re),e.Y36(ke.K),e.Y36(De.Z),e.Y36(T.YP),e.Y36(T.ez),e.Y36(Oe.k),e.Y36(D.gz),e.Y36(_.qu))};static#t=this.\u0275cmp=e.Xpm({type:se,selectors:[["reservation-component"]],viewQuery:function(t,i){if(1&t&&e.Gf(oe.w,5),2&t){let o;e.iGM(o=e.CRH())&&(i.conferenceSelector=o.first)}},features:[e._Bn([T.ez,T.YP])],decls:28,vars:35,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-0","py-0"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","{first} - {last} bejegyz\xe9s a(z) {totalRecords}-b\xf3l megjelen\xedt\xe9se","selectionMode","multiple",3,"value","rows","totalRecords","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","tableStyle","rowHover","lazy","selectionChange","onLazyLoad"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["id","sidebar","position","right","styleClass","p-sidebar-md",3,"visible","transitionOptions","fullScreen","blockScroll","visibleChange","onHide","onShow"],[4,"ngIf"],["pTemplate","footer"],["header","T\xf6rl\xe9s",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[3,"autoZIndex","blocked"],[3,"closable"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0"],["placeholder","V\xe1lasszon konferenci\xe1t...",3,"ngModel","emitOnSelectFirstOption","showNoneOption","selectionLimit","showClear","ngModelChange"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0",2,"background-color","#E2E8F0",3,"pTooltip"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],["width","24px","height","24px","viewBox","0 0 24 24","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#000000"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","ic_fluent_bed_24_filled","fill","#334155","fill-rule","nonzero"],["d","M19.25,11 C20.7125318,11 21.9084043,12.1417046 21.9949812,13.5824777 L22,13.75 L22,20.25 C22,20.6642136 21.6642136,21 21.25,21 C20.8703042,21 20.556509,20.7178461 20.5068466,20.3517706 L20.5,20.25 L20.5,18 L3.5,18 L3.5,20.25 C3.5,20.6296958 3.21784612,20.943491 2.85177056,20.9931534 L2.75,21 C2.37030423,21 2.05650904,20.7178461 2.00684662,20.3517706 L2,20.25 L2,13.75 C2,12.2874682 3.1417046,11.0915957 4.58247767,11.0050188 L4.75,11 L19.25,11 Z M6.75,4 L17.25,4 C18.7125318,4 19.9084043,5.1417046 19.9949812,6.58247767 L20,6.75 L20,10 L17,10 L16.9932723,9.88337887 C16.9399506,9.42429701 16.575703,9.06004937 16.1166211,9.00672773 L16,9 L14,9 C13.4871642,9 13.0644928,9.38604019 13.0067277,9.88337887 L13,10 L11,10 L10.9932723,9.88337887 C10.9399506,9.42429701 10.575703,9.06004937 10.1166211,9.00672773 L10,9 L8,9 C7.48716416,9 7.06449284,9.38604019 7.00672773,9.88337887 L7,10 L4,10 L4,6.75 C4,5.28746816 5.1417046,4.09159572 6.58247767,4.00501879 L6.75,4 Z"],[1,"text-2xl","font-normal","white-space-nowrap","vertical-align-middle"],[1,"pi","pi-users",2,"font-size","1.5rem"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0","bg-green-100",3,"pTooltip"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0","bg-yellow-100",3,"pTooltip"],["pButton","","pRipple","","label","\xdaj","icon","pi pi-plus",1,"p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","label","T\xf6rl\xe9s","icon","pi pi-trash",1,"p-button-danger","mr-2",3,"disabled","click"],["pSortableColumn","roomNum"],["field","roomNum"],["pSortableColumn","startDate"],["field","startDate"],["pSortableColumn","endDate"],["field","endDate"],["pSortableColumn","status"],["field","status"],["pSortableColumn","notes"],["field","notes"],["styleClass","w-3rem"],["pInputText","","type","text","placeholder","Szobasz\xe1m...",1,"mr-2",2,"width","8rem",3,"input"],["placeholder","\xc9p\xfclet...",1,"mr-2",3,"showClear","change"],["placeholder","\xc1gytipus...",3,"showClear","change"],["pInputText","","type","text","placeholder","Vend\xe9g...",2,"width","10rem",3,"input"],["appendTo","body","dataType","string","placeholder","Keres\xe9s...","inputStyleClass","w-6rem",3,"showButtonBar","onSelect","onClearClick"],["placeholder","St\xe1tusz...",3,"showClear","change"],["pInputText","","type","text","placeholder","Keres\xe9s...",2,"width","8rem",3,"input"],[3,"value"],[1,"p-column-title"],[1,"flex","align-items-center","gap-2"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip",4,"ngFor","ngForOf"],["shape","circle","size","large","tooltipPosition","top",3,"label","style","pTooltip",4,"ngIf"],[2,"max-width","300px"],[1,"calendar-badge"],[1,"pi","pi-calendar","mr-1"],[3,"class",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"disabled","click"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"],["class","border-round-xl w-min p-0 bg-purple-100",4,"ngIf"],[1,"border-round-xl","w-min","p-0","bg-purple-100"],[1,"flex","align-items-center","justify-content-center","gap-1","px-2"],[4,"ngIf","ngIfElse"],["multipleBabyBeds",""],["src","/assets/demo/images/baby-bed.svg","alt","Baby bed","tooltipPosition","top",2,"max-width","20px",3,"pTooltip"],[1,"text-sm","font-semibold","pl-1"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip"],["shape","circle","size","large","tooltipPosition","top",3,"label","pTooltip"],[1,"text-center"],[1,"font-semibold","text-xl"],["novalidate","",1,"grid","formgrid","p-fluid",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden"],["formControlName","conference_id","type","hidden"],["formControlName","room_id","type","hidden"],["formControlName","guestIds","type","hidden"],[1,"field","mb-4","col-12"],["for","conference",1,"font-medium","text-900"],["formControlName","conference","placeholder","V\xe1lasszon konferenci\xe1t...",3,"preselectIds","showNoneOption","selectionLimit","showClear"],["class","block p-error",4,"ngIf"],["for","guest",1,"font-medium","text-900"],["formControlName","guests","placeholder","Vend\xe9g...",3,"filter","preselectIds","emitOnPreselectId","showOnlyNotReserved","groupByRoomMate","showClear"],["for","room_id",1,"font-medium","text-900"],["formControlName","room","placeholder","Szoba...",3,"filter","selectionLimit","preselectIds","emitOnPreselectId","showOnlyNotReserved","showClear"],[1,"field","mb-4","col-6"],["for","startDate",1,"font-medium","text-900"],["id","startDate","formControlName","startDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["class","p-error",4,"ngIf"],["for","endDate",1,"font-medium","text-900"],["id","endDate","formControlName","endDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["for","status",1,"font-medium","text-900"],["formControlName","status","placeholder","St\xe1tusz...",3,"showClear"],["for","notes",1,"font-medium","text-900"],["id","notes","type","text","formControlName","notes","pInputTextarea","","rows","5"],[1,"block","p-error"],[1,"p-error"],[1,"flex","justify-content-end","ap-2"],["pButton","","pRipple","","label","M\xe9gsem","icon","pi pi-times",1,"p-button-outlined",3,"disabled","click"],["pButton","","pRipple","","label","Ment\xe9s","icon","pi pi-check",1,"p-button","ml-2",3,"disabled","click"],["pButton","","pRipple","","label","Nem","icon","pi pi-times",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Igen","icon","pi pi-check",1,"p-button","ml-2",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(r){return i.selected=r})("onLazyLoad",function(r){return i.onLazyLoad(r)}),e.YNc(5,Ht,42,18,"ng-template",5),e.YNc(6,Kt,38,5,"ng-template",6),e.YNc(7,ai,57,30,"ng-template",7),e.YNc(8,ci,3,1,"ng-template",8),e.qZA()(),e.TgZ(9,"p-sidebar",9),e.NdJ("visibleChange",function(r){return i.sidebar=r})("onHide",function(){return i.onSidebarHide()})("onShow",function(){return i.onSidebarShow()}),e.YNc(10,ui,2,1,"ng-template",6),e.YNc(11,yi,45,39,"ng-container",10),e.YNc(12,Ci,3,2,"ng-template",11),e.qZA(),e.TgZ(13,"p-dialog",12),e.NdJ("visibleChange",function(r){return i.deleteDialog=r}),e.TgZ(14,"div",13),e._UZ(15,"i",14),e.YNc(16,xi,5,1,"span",10),e.qZA(),e.YNc(17,Ti,2,0,"ng-template",11),e.qZA(),e.TgZ(18,"p-dialog",12),e.NdJ("visibleChange",function(r){return i.bulkDeleteDialog=r}),e.TgZ(19,"div",13),e._UZ(20,"i",14),e.TgZ(21,"span"),e._uU(22,"Biztosan t\xf6r\xf6lni akarja a kiv\xe1lasztott foglal\xe1sokat?"),e.qZA()(),e.YNc(23,Si,2,0,"ng-template",11),e.qZA()()(),e.TgZ(24,"p-blockUI",15),e._UZ(25,"p-progressSpinner"),e.qZA(),e._UZ(26,"p-toast")(27,"p-confirmDialog",16)),2&t&&(e.xp6(3),e.Q6J("value",i.tableData)("rows",i.rowsPerPage)("totalRecords",i.totalRecords)("globalFilterFields",e.DdM(30,Ii))("paginator",!0)("rowsPerPageOptions",i.rowsPerPageOptions)("showCurrentPageReport",!0)("selection",i.selected)("tableStyle",e.DdM(31,Ei))("rowHover",!0)("lazy",!0),e.xp6(6),e.Q6J("visible",i.sidebar)("transitionOptions",".3s cubic-bezier(0, 0, 0.2, 1)")("fullScreen",i.isMobile)("blockScroll",!0),e.xp6(2),e.Q6J("ngIf",i.sidebar),e.xp6(2),e.Akn(e.DdM(32,Se)),e.Q6J("visible",i.deleteDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",i.tableItem),e.xp6(2),e.Akn(e.DdM(33,Se)),e.Q6J("visible",i.bulkDeleteDialog)("modal",!0),e.xp6(6),e.Q6J("autoZIndex",!0)("blocked",i.loading),e.xp6(3),e.Akn(e.DdM(34,Zi)),e.Q6J("closable",!1))},dependencies:[f.mk,f.sg,f.O5,Q.iA,T.jx,Q.lQ,Q.fz,Q.UA,Q.Mo,_._Y,_.Fj,_.JJ,_.JL,_.On,_.sg,_.u,q.Hq,H.H,le.FN,ae.o,ce.V,ue.G,pe.b,de.Y,oe.w,Me.n,Le.p,Je,tt,dt,K.u,_e.q,ve.H,be.f,ye.g,Vt,f.uU,B.X$],encapsulation:2})};te=(0,$.gn)([(0,Ee.k)()],te);let Ai=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[D.Bz.forChild([{path:"",component:te}]),D.Bz]})}return n})();var Fi=a(6263),wi=a(9502),Ri=a(5609),Ni=a(6651),ki=a(7902),Di=a(1865),Oi=a(2285);let Mi=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({providers:[re],imports:[f.ez,Ai,Q.U$,_.u5,_.UX,q.hJ,H.T,le.EV,ae.j,me.kW,ce.S,Fi.W,wi.$,ue.L,pe.u,de.l,Oi.L,Ri.Iu,K.z,Ni.q,_e.F,ve.Q,ki.JH,Di.cc,B.aw,be._8,fe.o,ye.A,qt]})}return n})()},746:(X,z,a)=>{a.d(z,{Q:()=>I});var f=a(5619),_=a(9397),D=a(6306),$=a(7398),O=a(2096),Z=a(2029),J=a(8814);let I=(()=>{class E{constructor(u){this.apiService=u,this.apiURL=u.apiURL,this.data$=new f.X(null),this.createdGuest$=new f.X(null),this.message$=new f.X(null)}get guestObs(){return this.data$.asObservable()}get createdGuestObs(){return this.createdGuest$.asObservable()}get messageObs(){return this.message$.asObservable()}get(u,m,v,b){let x="";""!==v&&(x=""!=v.sortField?`sort=${v.sortField}&order=${1===v.sortOrder?"ASC":"DESC"}`:"");const Y=""!==x&&""!==b?x+"&"+b:""!==x&&""===b?x:""===x&&""!==b?b:"";this.apiService.get(`guest/get/${u}/${m}${""!==Y?"?"+Y:""}`).subscribe({next:U=>{this.data$.next(U)},error:U=>{this.message$.next(U)}})}getBySearch(u,m,v){let b={};m&&m.sortField&&(b.sort=m.sortField,b.order=1===m.sortOrder?"ASC":"DESC"),v&&v.length>0&&(b.conferenceIds=v.join(",")),this.apiService.get(`guest/search/${encodeURIComponent(u)}`,{params:b}).subscribe({next:x=>{this.data$.next(x)},error:x=>{this.message$.next(x)}})}getBySearchQuery(u){this.apiService.get(`guest/searchquery?${u}`).subscribe({next:m=>{this.data$.next(m)},error:m=>{this.message$.next(m)}})}getBySearchQuery$(u){return this.apiService.get(`guest/searchquery?${u}`)}getByConferenceName(u){return this.apiService.get(`guest/searchquery?conferenceName=${u}`)}getByRFID(u){return this.apiService.get(`guest/getbyrfid/${u}`)}updateLastTagUsage(u){this.apiService.get(`guest/updatelasttagusage/${u}`).subscribe({next:m=>{},error:m=>{this.message$.next(m)}})}create(u,m){const v=new FormData;if(v.append("guest",JSON.stringify(u)),m&&m.length>0)for(const b of m){if(!b)return;v.append("idcard",b,b.name)}this.apiService.post("guest/create/",v).subscribe({next:b=>{this.createdGuest$.next(b.guest);const x=this.registrationToast(b.guest),Y=this.emailStatusToast(b.email);this.message$.next(x),this.message$.next(Y)},error:b=>{this.message$.next({severity:"error",summary:"Vend\xe9g r\xf6gz\xedt\xe9s sikertelen",detail:b?.errorMessage||b?.message||"Ismeretlen hiba t\xf6rt\xe9nt."})}})}update(u,m=[]){const v={...u};if(delete v.idcard,m&&m.length>0){const b=new FormData;b.append("guest",JSON.stringify(v));for(const x of m)x&&b.append("idcard",x,x.name);this.apiService.put(`guest/update/${u.id}`,b).subscribe({next:()=>{this.message$.next("success")},error:x=>{this.message$.next(x)}})}else v.idCardUploaded=0,this.apiService.put(`guest/update/${u.id}`,v).subscribe({next:()=>{this.message$.next("success")},error:b=>{this.message$.next(b)}})}updateGuest2(u){return this.apiService.put(`guest/update/${u.id}`,u).pipe((0,_.b)(()=>console.log(`updated guest id=${u.id}`)),(0,D.K)(this.handleError("updateGuest2")))}delete(u){this.apiService.delete(`guest/delete/${u.id}`).subscribe({next:m=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${u.lastName} ${u.firstName} t\xf6r\xf6lve`})},error:m=>{this.message$.next(m)}})}bulkdelete(u){let m={ids:u.map(v=>v.id)};this.apiService.post("guest/bulkdelete",m).subscribe({next:v=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${u.length} vend\xe9g t\xf6r\xf6lve`})},error:v=>{this.message$.next(v)}})}searchGuestsForSelector$(u={}){const m=this.buildGuestQS(u);return this.apiService.get(`guest/searchquery?${m}`).pipe((0,$.U)(v=>v?v.rows??[]:[]))}buildGuestQS(u={}){const m=[];return null!=u.conferenceId&&m.push(`conferenceid=${encodeURIComponent(String(u.conferenceId))}`),"number"==typeof u.minBeds&&m.push(`minBeds=${u.minBeds}`),"boolean"==typeof u.climate&&m.push("climate="+(u.climate?1:0)),u.onlyNotReserved&&m.push("onlyNotReserved=true"),u.includeGuestIds?.length&&m.push(`includeGuestIds=${u.includeGuestIds.join(",")}`),u.enabled&&m.push("enabled=1"),m.join("&")}handleError(u="operation",m){return v=>(console.error(v),console.error(`${u} failed: ${v.message}`),(0,O.of)(m))}emailStatusToast(u){if(!u)return{severity:"warn",summary:"E-mail",detail:"E-mail st\xe1tusz ismeretlen."};switch(u.status){case"sent":return{severity:"success",summary:"E-mail",detail:"Visszaigazol\xf3 e-mail elk\xfcldve."};case"timeout":return{severity:"warn",summary:"E-mail",detail:"Az e-mail k\xfcld\xe9s id\u0151korl\xe1tot \xe9rt el."};case"failed":return{severity:"error",summary:"E-mail hiba",detail:u.message||"Az e-mail k\xfcld\xe9s nem siker\xfclt."};default:return{severity:"info",summary:"E-mail",detail:"E-mail st\xe1tusz: ismeretlen."}}}registrationToast(u){return{severity:"success",summary:"Vend\xe9g r\xf6gz\xedtve",detail:(u?.lastName&&u?.firstName?`${u.lastName} ${u.firstName}`:"Vend\xe9g")+" sikeresen r\xf6gz\xedtve."}}static#e=this.\u0275fac=function(m){return new(m||E)(Z.LFG(J.s))};static#t=this.\u0275prov=Z.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"})}return E})()},1116:(X,z,a)=>{function f(_,D){return $=>{const O=$.get(_)?.value,Z=$.get(D)?.value;return O&&Z&&(new Date(O)>new Date(Z)||new Date(Z)<new Date(O))?{dateRangeInvalid:!0}:null}}a.d(z,{W:()=>f})},6218:(X,z,a)=>{a.d(z,{A:()=>O,g:()=>$});var f=a(2029),_=a(6814),D=a(6223);let $=(()=>{class Z{el;ngModel;control;cd;autoResize;onResize=new f.vpe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(I,E,M,u){this.el=I,this.ngModel=E,this.control=M,this.cd=u}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(I){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(I){this.autoResize&&this.resize(I)}onBlur(I){this.autoResize&&this.resize(I)}resize(I){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(I||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(E){return new(E||Z)(f.Y36(f.SBq),f.Y36(D.On,8),f.Y36(D.a5,8),f.Y36(f.sBO))};static \u0275dir=f.lG2({type:Z,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(E,M){1&E&&f.NdJ("input",function(m){return M.onInput(m)})("focus",function(m){return M.onFocus(m)})("blur",function(m){return M.onBlur(m)}),2&E&&f.ekj("p-filled",M.filled)("p-inputtextarea-resizable",M.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}})}return Z})(),O=(()=>{class Z{static \u0275fac=function(E){return new(E||Z)};static \u0275mod=f.oAB({type:Z});static \u0275inj=f.cJS({imports:[_.ez]})}return Z})()}}]);