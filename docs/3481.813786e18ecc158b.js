"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[3481],{3481:(M,T,l)=>{l.r(T),l.d(T,{ReservationModule:()=>It});var h=l(6814),d=l(6223),y=l(1640),I=l(7582),S=l(8645),v=l(5619),w=l(2181),_=l(7398),b=l(3997),x=l(2832),a=l(9360),c=l(4829),p=l(8251),f=l(4825);var L=l(4664),E=l(3620),re=l(4279),Z=l(5219),le=l(1116);const z=()=>function ae(o){const i=t=>(t??[]).map(s=>{const n=o(s);return null==n?"\u2400":"number"==typeof n?`#${n}`:`@${n}`}).sort().join("|");return(0,b.x)((t,s)=>i(t)===i(s))}(o=>o.id);var G=l(9474),ce=l(217),O=l(6676),e=l(2029),ue=l(2096),de=l(9397),pe=l(8814),A=l(9515);let k=(()=>{class o{get messageObs(){return this.message$.asObservable()}constructor(t,s){this.apiService=t,this.translate=s,this.cache=[],this.message$=new v.X(null),this.apiURL=t.apiURL}get$(t,s,n,r){let u="";""!==n&&(u=n.sortField?`sort=${n.sortField}&order=${1===n.sortOrder?"ASC":"DESC"}`:"");const C=u&&r?`${u}&${r}`:u||r||"";return this.apiService.get(`reservation/get/${t}/${s}${C?`?${C}`:""}`)}getBySearch$(t,s){let n="";return""!==s&&(n=""!==s.sortField?`?sort=${s.sortField}&order=${1===s.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`reservation/search/${t}${n}`)}getBySearchQuery$(t){return this.apiService.get(`reservation/searchquery?${t}`)}getReservationsForSelector(){return this.cache.length?(0,ue.of)(this.cache):this.apiService.get("reservation/get/0/999?sort=reservationNum&order=ASC").pipe((0,_.U)(t=>t?.rows??[]),(0,de.b)(t=>{this.cache=t}))}create(t){this.apiService.post("reservation/create/",t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s r\xf6gz\xedt\xe9s",detail:"Foglal\xe1s r\xf6gz\xedtve"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem menthet\u0151",detail:this.localizeError(s)})}})}update(t){this.apiService.put(`reservation/update/${t.id}`,t).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s m\xf3dos\xedt\xe1s",detail:"Foglal\xe1s m\xf3dos\xedtva"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem m\xf3dos\xedthat\xf3",detail:this.localizeError(s)})}})}delete(t){this.apiService.delete(`reservation/delete/${t.id}`).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:"Foglal\xe1s t\xf6r\xf6lve"})},error:s=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(s)})}})}bulkdelete(t){const s={ids:t.map(n=>n.id)};this.apiService.post("reservation/bulkdelete",s).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres foglal\xe1s t\xf6rl\xe9s",detail:`${t.length} foglal\xe1s t\xf6r\xf6lve`})},error:n=>{this.message$.next({severity:"error",summary:"Foglal\xe1s nem t\xf6r\xf6lhet\u0151",detail:this.localizeError(n)})}})}getRawBackendMessage(t){const s=t?.error;if(s&&"object"==typeof s&&"message"in s&&s.message)return String(s.message);if("string"==typeof s)try{const n=JSON.parse(s);if(n?.message)return String(n.message)}catch{return s}return t?.message??"Unknown error"}localize(t){return this.translate.instant(t)}localizeError(t){return this.localize(this.getRawBackendMessage(t))}static#e=this.\u0275fac=function(s){return new(s||o)(e.LFG(pe.s),e.LFG(A.sK))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var me=l(1206),he=l(219),ge=l(8022),N=l(9552),J=l(707),j=l(4480),B=l(4104),Q=l(3714),Y=l(7213),V=l(7680),q=l(4204),P=l(9246),fe=l(3069),_e=l(2991),K=l(3965);function ve(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=i.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function be(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=i.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function Ce(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"p-dropdown",2),e.NdJ("onChange",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(n))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,ve,3,6,"ng-template",3),e.YNc(4,be,3,6,"ng-template",4),e.qZA()}if(2&o){const t=i.ngIf,s=e.oxw();e.s9C("placeholder",e.lcZ(1,5,s.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("formControl",t)("options",s.statuses)("showClear",s.showClear)}}function Se(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=i.$implicit;e.Gre("reservation-status-badge ",t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.label?null:t.label.toUpperCase()))," ")}}function ye(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=i.$implicit;e.Gre("reservation-status-badge ",null==t?null:t.value,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t||null==t.label?null:t.label.toUpperCase()))," ")}}function xe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"p-dropdown",5),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedStatus=n)})("onChange",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.handleOnChange(n))}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.YNc(3,Se,3,6,"ng-template",3),e.YNc(4,ye,3,6,"ng-template",4),e.qZA()}if(2&o){const t=e.oxw();e.s9C("placeholder",e.lcZ(1,5,t.placeholder)),e.s9C("emptyMessage",e.lcZ(2,7,"Nincs tal\xe1lat...")),e.Q6J("ngModel",t.selectedStatus)("options",t.statuses)("showClear",t.showClear)}}let Te=(()=>{class o{constructor(t,s){this.translate=t,this.cdRef=s,this.change=new e.vpe,this.statuses=[],this.selectedStatus="",this.disabled=!1,this.onChange=n=>{},this.onTouched=()=>{},this.placeholder||(this.placeholder="V\xe1lasszon...")}ngOnInit(){this.translate.onLangChange.subscribe(()=>{this.setReservationStatuses()}),this.setReservationStatuses()}ngOnChanges(t){this.setReservationStatuses()}getFormControl(){return this.parentForm&&this.controlName?this.parentForm.get(this.controlName):null}setReservationStatuses(){this.statuses=[{label:"tentative",value:"tentative"},{label:"confirmed",value:"confirmed"},{label:"in_house",value:"in_house"},{label:"checked_out",value:"checked_out"},{label:"cancelled",value:"cancelled"}]}handleOnChange(t){this.selectedStatus=t.value,this.onChange(t.value),this.onTouched(),this.change.emit({value:t.value,field:this.controlName})}setDisabledState(t){this.disabled=t,this.cdRef.detectChanges()}writeValue(t){this.selectedStatus=t,this.cdRef.detectChanges()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(A.sK),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-reservation-status-selector"]],inputs:{parentForm:"parentForm",controlName:"controlName",placeholder:"placeholder",showClear:"showClear"},outputs:{change:"change"},features:[e._Bn([{provide:d.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}]),e.TTD],decls:3,vars:2,consts:[["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange",4,"ngIf","ngIfElse"],["useNgModel",""],["optionLabel","label","optionValue","value","appendTo","body",3,"formControl","options","placeholder","emptyMessage","showClear","onChange"],["pTemplate","item"],["pTemplate","selectedItem"],["optionLabel","label","optionValue","value","appendTo","body",3,"ngModel","options","placeholder","emptyMessage","showClear","ngModelChange","onChange"]],template:function(s,n){if(1&s&&(e.YNc(0,Ce,5,9,"p-dropdown",0),e.YNc(1,xe,5,9,"ng-template",null,1,e.W1O)),2&s){const r=e.MAs(2);e.Q6J("ngIf",n.getFormControl())("ngIfElse",r)}},dependencies:[h.O5,d.JJ,d.On,d.oH,Z.jx,K.Lt,A.X$],encapsulation:2})}return o})();var H=l(7394),Ie=l(4520),W=l(4055),D=l(3259);const Ze=["roomSelector"];function Ee(o,i){if(1&o&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function Ae(o,i){1&o&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function Re(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function Fe(o,i){if(1&o&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,Ee,2,1,"span",11),e.YNc(12,Ae,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,Re,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&o){const t=i.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function Oe(o,i){if(1&o&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.floor,")")}}function Ne(o,i){1&o&&(e.TgZ(0,"span",16),e._uU(1,"\u2744\ufe0f"),e.qZA())}function we(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function De(o,i){if(1&o&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5),e._UZ(3,"i",6),e.TgZ(4,"span",7),e._uU(5),e.qZA()(),e.TgZ(6,"div",8)(7,"div",9)(8,"span",10),e._uU(9),e.ALo(10,"translate"),e.YNc(11,Oe,2,1,"span",11),e.YNc(12,Ne,2,0,"span",12),e.qZA(),e.TgZ(13,"span",13),e._uU(14),e.YNc(15,we,2,1,"span",14),e._uU(16,") "),e.qZA()()()()()),2&o){const t=i.$implicit;e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.roomNum,""),e.xp6(1),e.hij(" ",t.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(10,12,"BUILDINGS."+t.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.floor),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}let Me=(()=>{class o{set preselectIds(t){const n=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=n.length?n:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,s,n){this.roomService=t,this.messageService=s,this.cdr=n,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.rooms=[],this.originalRooms=[],this.selectedRooms=[],this.subscriptions=new H.w0,this.suppress=0,this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.rooms=[],this.loading=!1,void this.cdr.markForCheck();const s=(this.selectedRooms??[]).map(g=>this.toNumId(g?.id)).filter(g=>null!=g),r=Array.from(new Set([...s,...this._pendingSelectIds??[]])),u={...t,...r.length?{includeRoomIds:r}:{}},C=this.roomService.searchRoomsForSelector$(u).subscribe({next:g=>{this.rooms=g??[],this.originalRooms=this.rooms.slice(),this.loading=!1,this.syncSelectedRooms(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:g=>{this.rooms=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rooms."})}});this.subscriptions.add(C)}setSelection(t,s){const n=s?.source??"programmatic";this.runSilently(()=>{this.selectedRooms=t?.slice(0,this.selectionLimit??t.length)??[]}),s?.emit&&this.emit(this.selectedRooms,n,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedRooms.length&&this.rooms.length&&(this.runSilently(()=>{this.selectedRooms=this.rooms.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedRooms,"auto-select-first",!0))}preselectByIds(){if(!this.rooms?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),s=this.rooms.filter(C=>{const g=this.toNumId(C?.id);return null!=g&&t.has(g)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length,u=s.slice(0,r);this.runSilently(()=>{this.selectedRooms=u,this.roomSelectorRef?.writeValue(this.selectedRooms)}),this.onChange(this.selectedRooms),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedRooms,"preselect-id",!0),this._pendingSelectIds=void 0}setDisabledState(t){this.disabled=t,this.roomSelectorRef&&(this.roomSelectorRef.disabled=t)}syncSelectedRooms(){this.selectedRooms=this.rooms.filter(t=>{const s=this.toNumId(t?.id);return null!=s&&this.selectedRooms.some(n=>this.toNumId(n?.id)===s)}),this.onChange(this.selectedRooms)}onSelectionChange(t){this.selectedRooms=t.value||[],this.emit(this.selectedRooms,"user"),1==this.selectionLimit&&this.selectedRooms?.length>=1&&setTimeout(()=>this.roomSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedRooms=[],this.roomSelectorRef&&this.roomSelectorRef.writeValue([])}),this.emit(this.selectedRooms,"user",!0)}emit(t,s,n=!1){this.suppress&&!n||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:s}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}writeValue(t){const s=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length;this.runSilently(()=>{this.selectedRooms=s.slice(0,r),this.roomSelectorRef&&this.roomSelectorRef.writeValue(this.selectedRooms)}),this.emitOnWriteValue&&this.emit(this.selectedRooms,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(Ie.X),e.Y36(Z.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-room-selector"]],viewQuery:function(s,n){if(1&s&&e.Gf(Ze,5),2&s){let r;e.iGM(r=e.CRH())&&(n.roomSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:d.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}]),e.TTD],decls:5,vars:13,consts:[["dataKey","id","optionLabel","roomNum","optionDisabled","disabled","filterBy","roomNum","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["roomSelector",""],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"]],template:function(s,n){1&s&&(e.TgZ(0,"p-multiSelect",0,1),e.NdJ("ngModelChange",function(u){return n.selectedRooms=u})("onChange",function(u){return n.onSelectionChange(u)})("onClear",function(){return n.onSelectionClear()}),e.ALo(2,"translate"),e.YNc(3,Fe,17,14,"ng-template",2),e.YNc(4,De,17,14,"ng-template",3),e.qZA()),2&s&&(e.Akn(n.style),e.s9C("emptyMessage",e.lcZ(2,11,"Nincs tal\xe1lat...")),e.Q6J("options",n.rooms)("ngModel",n.selectedRooms)("disabled",n.disabled)("selectionLimit",n.selectionLimit)("placeholder",n.placeholder)("virtualScroll",!0)("virtualScrollItemSize",50)("showClear",n.showClear))},dependencies:[h.O5,d.JJ,d.On,Z.jx,W.NU,D.u,A.X$],encapsulation:2,changeDetection:0})}return o})();var Le=l(746);const Ue=["guestSelector"];function $e(o,i){1&o&&(e.TgZ(0,"span",12),e._uU(1,"\u2744\ufe0f"),e.qZA())}function ze(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.bathroom,"")}}function Ge(o,i){if(1&o&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"div",6)(4,"span",7),e._uU(5),e.TgZ(6,"span",8),e._uU(7),e.qZA(),e.YNc(8,$e,2,0,"span",9),e.qZA(),e.TgZ(9,"span",10),e._uU(10),e.YNc(11,ze,2,1,"span",11),e._uU(12,") "),e.qZA()()()()()),2&o){const t=i.$implicit,s=e.oxw();e.Gre("building-badge ",t.building," border-round-xl w-min p-0"),e.xp6(2),e.MGl("pTooltip","Szoba k\xf3d: ",t.roomCode,""),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",s.getAge(t.birthDate),")"),e.xp6(1),e.Q6J("ngIf",t.climate),e.xp6(2),e.AsE(" ",t.beds," SZEM\xc9LYES (",t.bedType,""),e.xp6(1),e.Q6J("ngIf",t.bathroom)}}function ke(o,i){if(1&o&&(e.TgZ(0,"div",13)(1,"div",4)(2,"div",14)(3,"div",6)(4,"span",7),e._uU(5),e.TgZ(6,"span",8),e._uU(7),e.qZA()(),e.TgZ(8,"span",10),e._uU(9),e.qZA(),e.TgZ(10,"span",15),e._uU(11),e.qZA()()()()()),2&o){const t=i.$implicit,s=e.oxw();e.xp6(2),e.s9C("pTooltip",t.roomMate),e.xp6(3),e.AsE(" ",t.lastName," ",t.firstName," "),e.xp6(2),e.hij("(",s.getAge(t.birthDate),")"),e.xp6(2),e.hij(" ",t.roomType," "),e.xp6(2),e.hij(" ",t.roomMate," ")}}O.locale("hu");let Je=(()=>{class o{set preselectIds(t){const n=(Array.isArray(t)?t:null!=t?[t]:[]).map(r=>"string"==typeof r?Number(r):r).filter(r=>Number.isFinite(r));this._pendingSelectIds=n.length?n:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,s,n){this.guestService=t,this.messageService=s,this.cdr=n,this.filter=null,this.selectFirstOption=!1,this.showClear=!0,this.style={},this.disabledOptions=[],this.showOnlyNotReserved=!1,this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new e.vpe,this.loading=!0,this.disabled=!1,this.guests=[],this.originalGuests=[],this.selectedGuests=[],this.subscriptions=new H.w0,this.suppress=0,this.onChange=r=>{},this.onTouched=()=>{}}ngOnInit(){this.reload()}ngOnChanges(t){t.filter&&this.reload(),t.preselectIds&&this.preselectByIds()}ngOnDestroy(){this.subscriptions.unsubscribe()}reload(){this.loading=!0;const t={...this.filter??{},onlyNotReserved:this.showOnlyNotReserved||(this.filter?.onlyNotReserved??!1)};if(t.onlyNotReserved&&!t.conferenceId)return this.guests=[],this.loading=!1,void this.cdr.markForCheck();const s=(this.selectedGuests??[]).map(C=>this.toNumId(C?.id)).filter(C=>null!=C);Array.from(new Set([...s,...this._pendingSelectIds??[]]));this.reloadSub?.unsubscribe(),this.reloadSub=this.guestService.searchGuestsForSelector$(t).subscribe({next:C=>{this.guests=(C??[]).map(g=>({...g,fullName:`${g.lastName??""} ${g.firstName??""}`.trim()})),this.loading=!1,this.syncSelectedGuests(),this.preselectByIds(),this.handleSelectFirstOption(),this.cdr.markForCheck()},error:C=>{this.guests=[],this.loading=!1,this.cdr.markForCheck(),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load guests."})}}),this.subscriptions.add(this.reloadSub)}preselectByIds(){if(!this.guests?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),s=this.guests.filter(C=>{const g=this.toNumId(C?.id);return null!=g&&t.has(g)}),r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length,u=s.slice(0,r);this.runSilently(()=>{this.selectedGuests=u,this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.onChange(this.selectedGuests),this.onTouched(),this.emitOnPreselectId&&this.emit(this.selectedGuests,"preselect-id",!0),this._pendingSelectIds=void 0}setSelection(t,s){const n=s?.source??"programmatic";this.runSilently(()=>{this.selectedGuests=t?.slice(0,this.selectionLimit??t.length)??[]}),s?.emit&&this.emit(this.selectedGuests,n,!0)}handleSelectFirstOption(){this.selectFirstOption&&0===this.selectedGuests.length&&this.guests.length&&(this.runSilently(()=>{this.selectedGuests=this.guests.slice(0,this.selectionLimit??1)}),this.emitOnSelectFirstOption&&this.emit(this.selectedGuests,"auto-select-first",!0))}setDisabledState(t){this.disabled=t,this.guestSelectorRef&&(this.guestSelectorRef.disabled=t)}syncSelectedGuests(){this.selectedGuests=this.guests.filter(t=>{const s=this.toNumId(t?.id);return null!=s&&this.selectedGuests.some(n=>this.toNumId(n?.id)===s)}),this.onChange(this.selectedGuests)}onSelectionChange(t){this.selectedGuests=t.value,this.emit(this.selectedGuests,"user"),1==this.selectionLimit&&this.selectedGuests?.length>=1&&setTimeout(()=>this.guestSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedGuests=[],this.guestSelectorRef?.writeValue([])}),this.emit(this.selectedGuests,"user",!0)}emit(t,s,n=!1){this.suppress&&!n||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:s}))}toNumId(t){return"number"==typeof t&&Number.isFinite(t)?t:"string"==typeof t&&""!==t.trim()&&Number.isFinite(+t)?+t:null}getAge(t){if(!t)return"";const s=O(t);return O().diff(s,"years").toString()}writeValue(t){const s=Array.isArray(t)?t:t?[t]:[],r=Number.isFinite(this.selectionLimit)&&this.selectionLimit>0?this.selectionLimit:s.length;this.runSilently(()=>{this.selectedGuests=s.slice(0,r),this.guestSelectorRef?.writeValue(this.selectedGuests)}),this.emitOnWriteValue&&this.emit(this.selectedGuests,"programmatic",!0)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(Le.Q),e.Y36(Z.ez),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-guest-selector"]],viewQuery:function(s,n){if(1&s&&e.Gf(Ue,5),2&s){let r;e.iGM(r=e.CRH())&&(n.guestSelectorRef=r.first)}},inputs:{filter:"filter",selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",style:"style",disabledOptions:"disabledOptions",showOnlyNotReserved:"showOnlyNotReserved",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[e._Bn([{provide:d.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}]),e.TTD],decls:5,vars:13,consts:[["dataKey","id","optionLabel","fullName","optionDisabled","disabled","filterBy","lastName,firstName","styleClass","height:53px","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","ngModelChange","onChange","onClear"],["guestSelector",""],["pTemplate","item"],["pTemplate","selectedItem"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],[1,"font-normal","text-sm","uppercase"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],[4,"ngIf"],[1,"pl-1"],[1,"color-badge","cyan","border-round-xl","w-min","p-0"],["tooltipPosition","top",1,"block","min-w-max",3,"pTooltip"],[1,"font-light","text-xs","text-overflow-ellipsis","max-w-10rem"]],template:function(s,n){1&s&&(e.TgZ(0,"p-multiSelect",0,1),e.NdJ("ngModelChange",function(u){return n.selectedGuests=u})("onChange",function(u){return n.onSelectionChange(u)})("onClear",function(){return n.onSelectionClear()}),e.ALo(2,"translate"),e.YNc(3,Ge,13,11,"ng-template",2),e.YNc(4,ke,12,6,"ng-template",3),e.qZA()),2&s&&(e.Akn(n.style),e.s9C("emptyMessage",e.lcZ(2,11,"Nincs tal\xe1lat...")),e.Q6J("options",n.guests)("ngModel",n.selectedGuests)("disabled",n.disabled)("selectionLimit",n.selectionLimit)("placeholder",n.placeholder)("virtualScroll",!0)("virtualScrollItemSize",50)("showClear",n.showClear))},dependencies:[h.O5,d.JJ,d.On,Z.jx,W.NU,D.u,A.X$],encapsulation:2,changeDetection:0})}return o})();var X=l(8039),ee=l(8676),te=l(3212),se=l(6218);const je=function(){return{minWidth:"35rem"}};function Be(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",16)(1,"h5",17),e._uU(2,"Foglal\xe1sok"),e.qZA(),e.TgZ(3,"span",18)(4,"app-conference-selector",19),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.selectedConferences=n)})("ngModelChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.doQuery())}),e.qZA()(),e.TgZ(5,"span",20)(6,"div",21)(7,"div",22)(8,"div",23),e.O4$(),e.TgZ(9,"svg",24),e._UZ(10,"g",25)(11,"g",26),e.TgZ(12,"g",27)(13,"g",28)(14,"g",29),e._UZ(15,"path",30),e.qZA()()()(),e.kcU(),e.TgZ(16,"span",31),e._uU(17),e.qZA()()()()(),e.TgZ(18,"span",18)(19,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.create())}),e.qZA(),e.TgZ(20,"button",33),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.bulkDeleteDialog=!0)}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Akn(e.DdM(10,je)),e.Q6J("ngModel",t.selectedConferences)("emitOnSelectFirstOption",!0)("selectionLimit",1)("showClear",!0),e.xp6(2),e.MGl("pTooltip","\xc1gyak sz\xe1ma: ",t.numberOfBeds,""),e.xp6(11),e.hij(" ",t.numberOfBeds," "),e.xp6(2),e.Q6J("disabled",!t.canCreate),e.xp6(1),e.Q6J("disabled",!t.selected||!t.selected.length||!t.canDelete)}}function Qe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th",34),e._uU(3,"Szoba "),e._UZ(4,"p-sortIcon",35),e.qZA(),e.TgZ(5,"th",36),e._uU(6,"Vend\xe9gek "),e._UZ(7,"p-sortIcon",37),e.qZA(),e.TgZ(8,"th",38),e._uU(9,"\xc9rkez\xe9s "),e._UZ(10,"p-sortIcon",39),e.qZA(),e.TgZ(11,"th",40),e._uU(12,"T\xe1voz\xe1s "),e._UZ(13,"p-sortIcon",41),e.qZA(),e.TgZ(14,"th",42),e._uU(15,"St\xe1tusz "),e._UZ(16,"p-sortIcon",43),e.qZA(),e.TgZ(17,"th",44),e._uU(18,"Megjegyz\xe9s "),e._UZ(19,"p-sortIcon",45),e.qZA(),e._UZ(20,"th"),e.qZA(),e.TgZ(21,"tr")(22,"th",46),e._UZ(23,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(24,"th")(25,"input",47),e.NdJ("input",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"reservationNum"))}),e.qZA(),e.TgZ(26,"app-building-selector",48),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"building"))}),e.qZA(),e.TgZ(27,"app-bedtype-selector",49),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"bedType"))}),e.qZA()(),e.TgZ(28,"th")(29,"input",50),e.NdJ("input",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"guests"))}),e.qZA()(),e.TgZ(30,"th")(31,"p-calendar",51),e.NdJ("onSelect",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"dateOfArrival"))})("onClearClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"dateOfArrival"))}),e.qZA()(),e.TgZ(32,"th")(33,"p-calendar",51),e.NdJ("onSelect",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"dateOfDeparture"))})("onClearClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"dateOfDeparture"))}),e.qZA()(),e.TgZ(34,"th")(35,"app-reservation-status-selector",52),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"status"))}),e.qZA()(),e.TgZ(36,"th")(37,"input",53),e.NdJ("input",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onFilter(n,"notes"))}),e.qZA()(),e._UZ(38,"th"),e.qZA()}2&o&&(e.xp6(26),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("showClear",!0),e.xp6(4),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showButtonBar",!0),e.xp6(2),e.Q6J("showClear",!0))}function Ye(o,i){if(1&o&&(e.TgZ(0,"span",73),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.room.floor,")")}}function Ve(o,i){1&o&&(e.TgZ(0,"span",74),e._uU(1,"\u2744\ufe0f"),e.qZA())}function qe(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(", ",t.room.bathroom,"")}}function Pe(o,i){if(1&o&&e._UZ(0,"p-avatar",75),2&o){const t=i.$implicit;e.s9C("pTooltip",t.lastName+" "+t.firstName)}}function Ke(o,i){if(1&o&&e._UZ(0,"p-avatar",76),2&o){const t=i.ngIf,s=e.oxw(2);e.Akn(s.capacityStyle(t)),e.s9C("pTooltip",s.capacityTooltip(t)),e.Q6J("label",s.formatCapacityLabel(t))}}function He(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw().$implicit;e.Gre("reservation-status-badge ",t.status,""),e.xp6(1),e.hij(" ",e.lcZ(2,4,"RESERVATION_STATUSES."+(null==t.status?null:t.status.toUpperCase()))," ")}}function We(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",54),e.qZA(),e.TgZ(3,"td")(4,"span",55),e._uU(5,"Szoba"),e.qZA(),e.TgZ(6,"div")(7,"div",22)(8,"div",23),e._UZ(9,"i",56),e.TgZ(10,"span",57),e._uU(11),e.qZA()(),e.TgZ(12,"div",58)(13,"div",59)(14,"span",60),e._uU(15),e.ALo(16,"translate"),e.YNc(17,Ye,2,1,"span",61),e.YNc(18,Ve,2,0,"span",62),e.qZA(),e.TgZ(19,"span",63),e._uU(20),e.YNc(21,qe,2,1,"span",10),e._uU(22,") "),e.qZA()()()()()(),e.TgZ(23,"td")(24,"span",55),e._uU(25,"Vend\xe9gek"),e.qZA(),e.TgZ(26,"p-avatarGroup"),e.YNc(27,Pe,1,1,"p-avatar",64),e.YNc(28,Ke,1,4,"p-avatar",65),e.qZA()(),e.TgZ(29,"td",66)(30,"span",55),e._uU(31,"\xc9rkez\xe9s"),e.qZA(),e.TgZ(32,"span",67),e._UZ(33,"i",68),e._uU(34),e.ALo(35,"date"),e.qZA()(),e.TgZ(36,"td",66)(37,"span",55),e._uU(38,"T\xe1voz\xe1s"),e.qZA(),e.TgZ(39,"span",67),e._UZ(40,"i",68),e._uU(41),e.ALo(42,"date"),e.qZA()(),e.TgZ(43,"td",66)(44,"span",55),e._uU(45,"St\xe1tusz"),e.qZA(),e.YNc(46,He,3,6,"span",69),e.qZA(),e.TgZ(47,"td")(48,"span",55),e._uU(49,"Megjegyz\xe9s"),e.qZA(),e._uU(50),e.qZA(),e.TgZ(51,"td")(52,"div",70)(53,"button",71),e.NdJ("click",function(){const r=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.edit(r))}),e.qZA(),e.TgZ(54,"button",72),e.NdJ("click",function(){const r=e.CHM(t).$implicit,u=e.oxw();return u.tableItem=r,e.KtG(u.deleteDialog=!0)}),e.qZA()()()()}if(2&o){const t=i.$implicit,s=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(4),e.Gre("building-badge ",t.room.building," border-round-xl w-min p-0"),e.xp6(4),e.MGl("pTooltip","Szoba sz\xe1m: ",t.room.roomNum,""),e.xp6(1),e.hij(" ",t.room.roomNum," "),e.xp6(1),e.MGl("pTooltip","Szoba k\xf3d: ",t.room.roomCode,""),e.xp6(3),e.hij(" ",e.lcZ(16,21,"BUILDINGS."+t.room.building.toUpperCase())," "),e.xp6(2),e.Q6J("ngIf",t.room.floor),e.xp6(1),e.Q6J("ngIf",t.room.climate),e.xp6(2),e.AsE(" ",t.room.beds," SZEM\xc9LYES (",t.room.bedType,""),e.xp6(1),e.Q6J("ngIf",t.room.bathroom),e.xp6(6),e.Q6J("ngForOf",t.guests),e.xp6(1),e.Q6J("ngIf",s.getFreeCapacity(t)),e.xp6(6),e.hij(" ",e.xi3(35,23,t.startDate,"yyyy.MM.dd")," "),e.xp6(7),e.hij(" ",e.xi3(42,26,t.endDate,"yyyy.MM.dd")," "),e.xp6(5),e.Q6J("ngIf",t.status),e.xp6(4),e.hij(" ",t.notes," "),e.xp6(3),e.Q6J("disabled",!s.canEdit),e.xp6(1),e.Q6J("disabled",!s.canDelete)}}function Xe(o,i){1&o&&(e.TgZ(0,"tr")(1,"td",77),e._uU(2,"Nincs tal\xe1lat..."),e.qZA()()),2&o&&(e.xp6(1),e.uIk("colspan",8))}function et(o,i){if(1&o&&(e.TgZ(0,"span",78),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",null!=t.id&&t.id.value?"Foglal\xe1s adatai":"\xdaj foglal\xe1s"," ")}}function tt(o,i){1&o&&(e.TgZ(0,"div",102),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function st(o,i){1&o&&(e.TgZ(0,"div",102),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function it(o,i){1&o&&(e.TgZ(0,"div",102),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function nt(o,i){1&o&&(e.TgZ(0,"div",103),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function ot(o,i){1&o&&(e.TgZ(0,"div",103),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function rt(o,i){1&o&&(e.TgZ(0,"div",103),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"K\xe9rj\xfck, adja meg az \xe9rkez\xe9s d\xe1tum\xe1t"),"! "))}function lt(o,i){1&o&&(e.TgZ(0,"div",103),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Az \xe9rkez\xe9s d\xe1tum\xe1nak kor\xe1bbinak kell lennie, mint a t\xe1voz\xe1si d\xe1tum"),"! "))}function at(o,i){1&o&&(e.TgZ(0,"div",102),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}function ct(o,i){1&o&&(e.TgZ(0,"div",102),e._uU(1," K\xf6telez\u0151 kit\xf6lteni "),e.qZA())}const ie=function(o){return{"ng-invalid":o}};function ut(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",79),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e._UZ(2,"input",80)(3,"input",81)(4,"input",82)(5,"input",83),e.TgZ(6,"div",84)(7,"label",85),e._uU(8,"Konferencia"),e.qZA(),e._UZ(9,"app-conference-selector",86),e.YNc(10,tt,2,0,"div",87),e.qZA(),e.TgZ(11,"div",84)(12,"label",88),e._uU(13,"Szoba"),e.qZA(),e._UZ(14,"app-room-selector",89),e.YNc(15,st,2,0,"div",87),e.qZA(),e.TgZ(16,"div",84)(17,"label",90),e._uU(18,"Vend\xe9g"),e.qZA(),e._UZ(19,"app-guest-selector",91),e.YNc(20,it,2,0,"div",87),e.qZA(),e.TgZ(21,"div",92)(22,"label",93),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"p-calendar",94),e.YNc(26,nt,3,3,"div",95),e.YNc(27,ot,3,3,"div",95),e.qZA(),e.TgZ(28,"div",92)(29,"label",96),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"p-calendar",97),e.YNc(33,rt,3,3,"div",95),e.YNc(34,lt,3,3,"div",95),e.qZA(),e.TgZ(35,"div",84)(36,"label",98),e._uU(37,"St\xe1tusz"),e.qZA(),e._UZ(38,"app-reservation-status-selector",99),e.YNc(39,at,2,0,"div",87),e.qZA(),e.TgZ(40,"div",84)(41,"label",100),e._uU(42,"Megjegyz\xe9s"),e.qZA(),e._UZ(43,"textarea",101),e.YNc(44,ct,2,0,"div",87),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.reservationForm),e.xp6(8),e.Q6J("preselectIds",t.preselectConferenceId)("selectionLimit",1)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.conference?null:t.conference.dirty)&&(null==t.conference||null==t.conference.errors?null:t.conference.errors.required)),e.xp6(4),e.Q6J("filter",t.roomFilter)("selectionLimit",1)("preselectIds",t.preselectRoomIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.room?null:t.room.dirty)&&(null==t.room||null==t.room.errors?null:t.room.errors.required)),e.xp6(4),e.Q6J("filter",t.guestFilter)("preselectIds",t.preselectGuestIds)("emitOnPreselectId",!0)("showOnlyNotReserved",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.guests?null:t.guests.dirty)&&(null==t.guests||null==t.guests.errors?null:t.guests.errors.required)),e.xp6(3),e.hij(" ",e.lcZ(24,29,"\xc9rkez\xe9s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(33,ie,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.startDate?null:t.startDate.dirty)&&(null==t.startDate||null==t.startDate.errors?null:t.startDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(3),e.hij(" ",e.lcZ(31,31,"T\xe1voz\xe1s d\xe1tuma")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(35,ie,null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid)),e.xp6(1),e.Q6J("ngIf",(null==t.endDate?null:t.endDate.dirty)&&(null==t.endDate||null==t.endDate.errors?null:t.endDate.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.reservationForm.errors?null:t.reservationForm.errors.dateRangeInvalid),e.xp6(4),e.Q6J("showClear",!0),e.xp6(1),e.Q6J("ngIf",(null==t.status?null:t.status.dirty)&&(null==t.status||null==t.status.errors?null:t.status.errors.required)),e.xp6(5),e.Q6J("ngIf",(null==t.notes?null:t.notes.dirty)&&(null==t.notes||null==t.notes.errors?null:t.notes.errors.required))}}function dt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",104)(1,"button",105),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.cancel())}),e.qZA(),e.TgZ(2,"button",106),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.reservationForm.dirty),e.xp6(1),e.Q6J("disabled",!t.reservationForm.valid||!t.reservationForm.dirty)}}function pt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",107),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",108),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.delete())}),e.qZA()}}function mt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",107),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.bulkDeleteDialog=!1)}),e.qZA(),e.TgZ(1,"button",108),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteSelected())}),e.qZA()}}const ht=function(){return["roomNum"]},gt=function(){return{"min-height":"calc(100vh - 320px)"}},ne=function(){return{width:"450px"}};O.locale("hu");let U=class ${constructor(i,t,s,n,r,u){this.reservationService=i,this.userService=t,this.conferenceService=s,this.messageService=n,this.responsiveService=r,this.fb=u,this.loading=!0,this.tableItem={},this.tableData=[],this.rowsPerPageOptions=[20,50,100,200],this.rowsPerPage=20,this.totalRecords=0,this.page=0,this.sortField="id",this.sortOrder=1,this.globalFilter="",this.filterValues={},this.debounce={},this.sidebar=!1,this.deleteDialog=!1,this.bulkDeleteDialog=!1,this.selected=[],this.canCreate=!1,this.canEdit=!1,this.canDelete=!1,this.isMobile=!1,this.isOrganizer=!1,this.selectedConferences=[],this.numberOfBeds=0,this.conferenceStart=null,this.conferenceEnd=null,this.preselectGuestIds=[],this.roomFilter={enabled:!0},this.guestFilter={enabled:!0},this.suppressEmits=!1,this.initialFormValues={id:null,room:null,room_id:null,conference:null,conference_id:null,startDate:"",endDate:"",status:"confirmed",notes:"",guests:[],guestIds:[]},this.INITIAL_FORM_STATE_CLOSED={id:{value:null,disabled:!1},room:{value:null,disabled:!0},room_id:{value:null,disabled:!1},conference:{value:[],disabled:!1},conference_id:{value:null,disabled:!1},startDate:{value:null,disabled:!0},endDate:{value:null,disabled:!0},status:{value:"confirmed",disabled:!1},notes:{value:"",disabled:!1},guests:{value:[],disabled:!0},guestIds:{value:[],disabled:!1}},this.query$=new S.x,this.formChanges$=new S.x,this.reservationForm=this.fb.group({id:this.INITIAL_FORM_STATE_CLOSED.id,room:[this.INITIAL_FORM_STATE_CLOSED.room,d.kI.required],room_id:[this.INITIAL_FORM_STATE_CLOSED.room_id,d.kI.required],conference:[this.INITIAL_FORM_STATE_CLOSED.conference,d.kI.required],conference_id:[this.INITIAL_FORM_STATE_CLOSED.conference_id,d.kI.required],startDate:[this.INITIAL_FORM_STATE_CLOSED.startDate,d.kI.required],endDate:[this.INITIAL_FORM_STATE_CLOSED.endDate,d.kI.required],status:this.INITIAL_FORM_STATE_CLOSED.status,notes:this.INITIAL_FORM_STATE_CLOSED.notes,guests:[this.INITIAL_FORM_STATE_CLOSED.guests,d.kI.required],guestIds:[this.INITIAL_FORM_STATE_CLOSED.guestIds,d.kI.required]},{validators:(0,le.W)("startDate","endDate")}),this.isFormValid$=new v.X(!1)}ngOnInit(){this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canCreate=i),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canEdit=i),this.userService.hasRole(["Super Admin","Nagy Admin","Kis Admin","Szervezo"]).subscribe(i=>this.canDelete=i),this.userService.hasRole(["Szervezo"]).subscribe(i=>this.isOrganizer=i),this.room?.disable({emitEvent:!1}),this.querySub=this.query$.pipe((0,w.h)(()=>(this.selectedConferences?.length??0)>0),(0,_.U)(i=>({key:this.buildQueryKey(),force:!!i?.force})),(0,b.x)((i,t)=>!t.force&&i.key===t.key),function F(o,i=x.z){return function m(o){return(0,a.e)((i,t)=>{let s=!1,n=null,r=null,u=!1;const C=()=>{if(r?.unsubscribe(),r=null,s){s=!1;const R=n;n=null,t.next(R)}u&&t.complete()},g=()=>{r=null,u&&t.complete()};i.subscribe((0,p.x)(t,R=>{s=!0,n=R,r||(0,c.Xf)(o(R)).subscribe(r=(0,p.x)(t,C,g))},()=>{u=!0,(!s||!r||r.closed)&&t.complete()}))})}(()=>(0,f.H)(o,i))}(50),(0,L.w)(()=>{this.loading=!0,this.filterValues.conference_id=(this.selectedConferences??[]).map(s=>s.id).join(",");const i=Object.keys(this.filterValues).map(s=>this.filterValues[s]?.length?`${s}=${this.filterValues[s]}`:"").filter(Boolean).join("&"),t=this.sortField?{sortField:this.sortField,sortOrder:this.sortOrder}:"";return""!==this.globalFilter?this.reservationService.getBySearch$(this.globalFilter,t):this.reservationService.get$(this.page,this.rowsPerPage,t,i)})).subscribe({next:i=>{this.loading=!1,this.tableData=i?.rows??[],this.totalRecords=i?.totalItems??0,this.page=i?.currentPage??0,this.numberOfBeds=i?.numberOfBeds??0},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Hiba t\xf6rt\xe9nt!"})}}),this.conference?.valueChanges.pipe(z(),(0,w.h)(()=>!this.suppressEmits&&this.sidebar)).subscribe(i=>{const t=i?.[0];this.reservationForm.patchValue({conference_id:t?.id??null,startDate:t?.beginDate??null,endDate:t?.endDate??null},{emitEvent:!1}),this.roomFilter={...this.roomFilter,conferenceId:t?.id??null},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null},t?(this.room?.reset(null,{emitEvent:!1}),this.room_id?.reset(null,{emitEvent:!1}),this.room?.enable({emitEvent:!1}),this.guests?.reset(null,{emitEvent:!1}),this.guestIds?.reset(null,{emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1})):(this.room?.reset(null,{emitEvent:!1}),this.room_id?.reset(null,{emitEvent:!1}),this.room?.disable({emitEvent:!1}),this.guests?.reset(null,{emitEvent:!1}),this.guestIds?.reset(null,{emitEvent:!1}),this.guests?.disable({emitEvent:!1}),this.startDate?.disable({emitEvent:!1}),this.endDate?.disable({emitEvent:!1}))}),this.room?.valueChanges.pipe(z()).subscribe(i=>{const t=i?.[0];this.reservationForm.patchValue({room_id:t?.id??null},{emitEvent:!1})}),this.guests?.valueChanges.pipe((0,_.U)(i=>Array.isArray(i)?i:i?[i]:[]),(0,_.U)(i=>i.map(t=>t?.id).filter(t=>null!=t)),(0,_.U)(i=>Array.from(new Set(i))),(0,b.x)((i,t)=>i.length===t.length&&i.every((s,n)=>s===t[n]))).subscribe(i=>{this.reservationForm.patchValue({guestIds:i},{emitEvent:!1})}),this.responsiveService.isMobile$.subscribe(i=>{this.isMobile=i}),this.isFormValid$=this.formChanges$.pipe((0,E.b)(300),(0,b.x)(),(0,_.U)(()=>this.reservationForm.valid)),this.serviceMessageObs$=this.reservationService.messageObs,this.conferenceMessageObs$=this.conferenceService.messageObs,this.serviceMessageObs$.subscribe(i=>this.handleMessage(i)),this.conferenceMessageObs$.subscribe(i=>this.handleMessage(i))}get id(){return this.reservationForm.get("id")}get room(){return this.reservationForm.get("room")}get room_id(){return this.reservationForm.get("room_id")}get conference(){return this.reservationForm.get("conference")}get conference_id(){return this.reservationForm.get("conference_id")}get startDate(){return this.reservationForm.get("startDate")}get endDate(){return this.reservationForm.get("endDate")}get status(){return this.reservationForm.get("status")}get notes(){return this.reservationForm.get("notes")}get guests(){return this.reservationForm.get("guests")}get guestIds(){return this.reservationForm.get("guestIds")}doQuery(i=!1){if(!this.selectedConferences?.length)return this.tableData=[],this.totalRecords=0,void(this.loading=!1);this.query$.next({force:i})}onFilter(i,t){if(this.isOrganizer&&0===this.selectedConferences.length)return;let n="";i instanceof Date?n=O(i).format("YYYY.MM.DD"):i&&(i.value||i.target?.value)?(n=i.value||i.target?.value,n=n.toString()):this.filterValues[t]="",this.filterValues[t]=n,["conferenceName","building","bedType","spareBeds"].includes(t)?this.filterValues[t]===n&&this.doQuery():(this.debounce[t]&&clearTimeout(this.debounce[t]),this.debounce[t]=setTimeout(()=>{this.filterValues[t]===n&&this.doQuery()},500))}onLazyLoad(i){this.page=i.first/i.rows,this.rowsPerPage=i.rows??this.rowsPerPage,this.sortField=i.sortField??"",this.sortOrder=-1===i.sortOrder?-1:1,this.globalFilter=i.globalFilter??"",this.doQuery()}onGlobalFilter(i,t){i.filterGlobal(t.target.value,"contains")}onSidebarShow(){this.sidebar=!0}onSidebarHide(){this.suppressEmits=!0,this.sidebar=!1,this.reservationForm.reset(this.INITIAL_FORM_STATE_CLOSED,{emitEvent:!1}),this.preselectConferenceId=void 0,this.preselectRoomIds=void 0,this.preselectGuestIds=[],this.preselectConferenceId=void 0,this.reservationForm.markAsPristine(),this.reservationForm.markAsUntouched(),queueMicrotask(()=>this.suppressEmits=!1)}create(){this.reservationForm.reset(this.initialFormValues),this.sidebar=!0}edit(i){this.reservationForm.reset(this.initialFormValues,{emitEvent:!1});const t=i.conference??(i.conference_id?{id:i.conference_id}:null);this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null},{emitEvent:!0});const s=i.room??(i.room_id?{id:i.room_id}:null),n=Array.isArray(i.guests)?i.guests:[],r=Array.from(new Set(n.map(u=>"string"==typeof u?.id?Number(u.id):u?.id).filter(u=>Number.isFinite(u))));this.suppressEmits=!0,this.reservationForm.patchValue({conference:t?[t]:[],conference_id:t?.id??null,guests:n,guestIds:r,startDate:i.startDate??null,endDate:i.endDate??null},{emitEvent:!1}),this.preselectGuestIds=r,this.roomFilter={...this.roomFilter,conferenceId:t?.id??null,includeRoomIds:s?.id?[s.id]:[]},this.guestFilter={...this.guestFilter,conferenceId:t?.id??null,includeGuestIds:this.preselectGuestIds},this.room?.enable({emitEvent:!1}),this.guests?.enable({emitEvent:!1}),this.startDate?.enable({emitEvent:!1}),this.endDate?.enable({emitEvent:!1}),this.reservationForm.patchValue({id:i.id??null,room:s?[s]:[],room_id:s?.id??null,guests:n,guestIds:Array.from(new Set(r)),status:i.status??"confirmed",notes:i.notes??null},{emitEvent:!1}),this.preselectRoomIds=s?.id??null,this.preselectGuestIds=Array.from(new Set(r)),console.log("preselectRoomIds",this.preselectRoomIds),this.suppressEmits=!1,this.originalFormValues=this.reservationForm.getRawValue(),this.sidebar=!0}delete(){this.loading=!0,this.deleteDialog=!1,this.reservationService.delete(this.tableItem)}deleteSelected(){this.loading=!0,this.bulkDeleteDialog=!1,this.reservationService.bulkdelete(this.selected)}save(){if(!this.reservationForm.valid)return;this.loading=!0;const i=this.reservationForm.value,t={room_id:i.room?.id??i.room_id??null,conference_id:i.conference?.id??i.conference_id??null,startDate:i.startDate,endDate:i.endDate,status:i.status??"confirmed",notes:i.notes??null};if(i.id){const s={id:i.id,...t};console.log("payload",s),this.reservationService.update(s)}else{const s=Array.isArray(i.guestIds)?i.guestIds:Array.isArray(i.guest)?i.guest.map(r=>r?.id).filter(r=>null!=r):i.guest?.id?[i.guest.id]:[],n={...t,guestIds:Array.from(new Set(s))};console.log("payload",n),this.reservationService.create(n)}this.doQuery(),this.sidebar=!1}cancel(){this.reservationForm.reset(this.originalFormValues)}handleMessage(i){i&&(this.loading=!1,"ERROR"==i||"error"===i?.severity?this.messageService.add({severity:"error",summary:i?.summary??"Error",detail:i?.detail??"Hiba t\xf6rt\xe9nt!"}):(this.messageService.add(i),this.tableItem={},this.selected=[],this.doQuery(!0)))}onConfChange(i){this.selectedConferences=i.value,("user"===i.source||"auto-select-first"===i.source)&&(this.tableData=[],this.doQuery())}getFreeCapacity(i){const t=i?.guests?.length??0;return(i?.room?.beds??0)+(i?.room?.extraBeds??0)-t}capacityStyle(i){return{"background-color":i<0?"#EF4444":"#22C55E",color:"#ffffff"}}capacityTooltip(i){return i<0?`T\xfalfoglava ${Math.abs(i)} f\u0151vel`:`Szabad \xe1gy ${i} f\u0151 r\xe9sz\xe9re`}formatCapacityLabel(i){return i>0?`+${i}`:`${i}`}exportExcel(){l.e(1486).then(l.bind(l,1486)).then(i=>{const t=[{key:"reservationNum",label:"Szoba-sz\xe1m"},{key:"reservationCode",label:"Szoba k\xf3d"},{key:"beds",label:"\xc1gyak sz\xe1ma"},{key:"spareBeds",label:"Matrac / gyerek\xe1gy"},{key:"building",label:"\xc9p\xfclet / folyos\xf3"},{key:"bedType",label:"\xc1gy t\xedpus"},{key:"bathreservation",label:"F\xfcrd\u0151szoba"},{key:"notes",label:"Megjegyz\xe9s"}],n=(this.selected.length>0?this.selected:this.tableData).map(g=>{let R={};return t.forEach(oe=>{R[oe.label]=g[oe.key]??""}),R}),u={Sheets:{data:i.utils.json_to_sheet(n,{header:t.map(g=>g.label)})},SheetNames:["data"]},C=i.write(u,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(C,"reservations")})}saveAsExcelFile(i,t){const r=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});ce.saveAs(r,t+"_export_"+O().format("YYYYMMDD")+".xlsx")}fromYMD(i){const[t,s,n]=i.split("-").map(Number);return new Date(t,s-1,n)}toYMD(i){return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`}buildQueryKey(){const i=(this.selectedConferences??[]).map(s=>s.id).sort().join(","),t=Object.keys(this.filterValues).map(s=>this.filterValues[s]?`${s}=${this.filterValues[s]}`:"").filter(Boolean).join("&");return[this.page,this.rowsPerPage,this.sortField,this.sortOrder,this.globalFilter||"",i,t].join("|")}ngOnDestroy(){}static#e=this.\u0275fac=function(t){return new(t||$)(e.Y36(k),e.Y36(me.K),e.Y36(he.Z),e.Y36(Z.ez),e.Y36(ge.k),e.Y36(d.qu))};static#t=this.\u0275cmp=e.Xpm({type:$,selectors:[["reservation-component"]],viewQuery:function(t,s){if(1&t&&e.Gf(G.w,5),2&t){let n;e.iGM(n=e.CRH())&&(s.conferenceSelector=n.first)}},features:[e._Bn([Z.ez])],decls:26,vars:30,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-0","py-0"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","{first} - {last} bejegyz\xe9s a(z) {totalRecords}-b\xf3l megjelen\xedt\xe9se","selectionMode","multiple",3,"value","rows","totalRecords","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","tableStyle","rowHover","lazy","selectionChange","onLazyLoad"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["id","sidebar","position","right","styleClass","p-sidebar-md",3,"visible","transitionOptions","fullScreen","blockScroll","visibleChange","onHide","onShow"],[4,"ngIf"],["pTemplate","footer"],["header","T\xf6rl\xe9s",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[3,"autoZIndex","blocked"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0"],["placeholder","V\xe1lasszon konferenci\xe1t...",3,"ngModel","emitOnSelectFirstOption","selectionLimit","showClear","ngModelChange"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],["tooltipPosition","top",1,"border-round-xl","w-min","p-0",2,"background-color","#E2E8F0",3,"pTooltip"],[1,"flex","align-items-center","justify-content-center","py-1","px-1"],[1,"flex","align-items-center","justify-content-center","gap-2","px-2"],["width","24px","height","24px","viewBox","0 0 24 24","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#000000"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","ic_fluent_bed_24_filled","fill","#334155","fill-rule","nonzero"],["d","M19.25,11 C20.7125318,11 21.9084043,12.1417046 21.9949812,13.5824777 L22,13.75 L22,20.25 C22,20.6642136 21.6642136,21 21.25,21 C20.8703042,21 20.556509,20.7178461 20.5068466,20.3517706 L20.5,20.25 L20.5,18 L3.5,18 L3.5,20.25 C3.5,20.6296958 3.21784612,20.943491 2.85177056,20.9931534 L2.75,21 C2.37030423,21 2.05650904,20.7178461 2.00684662,20.3517706 L2,20.25 L2,13.75 C2,12.2874682 3.1417046,11.0915957 4.58247767,11.0050188 L4.75,11 L19.25,11 Z M6.75,4 L17.25,4 C18.7125318,4 19.9084043,5.1417046 19.9949812,6.58247767 L20,6.75 L20,10 L17,10 L16.9932723,9.88337887 C16.9399506,9.42429701 16.575703,9.06004937 16.1166211,9.00672773 L16,9 L14,9 C13.4871642,9 13.0644928,9.38604019 13.0067277,9.88337887 L13,10 L11,10 L10.9932723,9.88337887 C10.9399506,9.42429701 10.575703,9.06004937 10.1166211,9.00672773 L10,9 L8,9 C7.48716416,9 7.06449284,9.38604019 7.00672773,9.88337887 L7,10 L4,10 L4,6.75 C4,5.28746816 5.1417046,4.09159572 6.58247767,4.00501879 L6.75,4 Z"],[1,"text-2xl","font-normal","white-space-nowrap","vertical-align-middle"],["pButton","","pRipple","","label","\xdaj","icon","pi pi-plus",1,"p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","label","T\xf6rl\xe9s","icon","pi pi-trash",1,"p-button-danger","mr-2",3,"disabled","click"],["pSortableColumn","roomNum"],["field","roomNum"],["pSortableColumn","guests"],["field","guests"],["pSortableColumn","dateOfArrival"],["field","dateOfArrival"],["pSortableColumn","dateOfDeparture"],["field","dateOfDeparture"],["pSortableColumn","status"],["field","status"],["pSortableColumn","comment"],["field","comment"],["styleClass","w-3rem"],["pInputText","","type","text","placeholder","Szobasz\xe1m...",1,"mr-2",2,"width","8rem",3,"input"],["placeholder","\xc9p\xfclet...",1,"mr-2",3,"showClear","change"],["placeholder","\xc1gytipus...",3,"showClear","change"],["pInputText","","type","text","placeholder","Vend\xe9g...",2,"width","7rem",3,"input"],["appendTo","body","dataType","string","placeholder","Keres\xe9s...",3,"showButtonBar","onSelect","onClearClick"],["placeholder","St\xe1tusz...",3,"showClear","change"],["pInputText","","type","text","placeholder","Keres\xe9s...",2,"width","10rem",3,"input"],[3,"value"],[1,"p-column-title"],[1,"pi","pi-key","vertical-align-middle"],["tooltipPosition","top",1,"text-2xl","font-semibold","white-space-nowrap","vertical-align-middle",3,"pTooltip"],["tooltipPosition","top",1,"block","min-w-max","border-left-1","px-2",3,"pTooltip"],[1,"flex","flex-column","align-items-left","justify-content-center"],[1,"text-base","font-semibold","uppercase"],["class","font-normal text-sm uppercase",4,"ngIf"],["class","pl-1",4,"ngIf"],[1,"font-light","text-xs","uppercase"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip",4,"ngFor","ngForOf"],["shape","circle","size","large","tooltipPosition","top",3,"label","style","pTooltip",4,"ngIf"],[2,"max-width","300px"],[1,"calendar-badge"],[1,"pi","pi-calendar","mr-1"],[3,"class",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"disabled","click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"disabled","click"],[1,"font-normal","text-sm","uppercase"],[1,"pl-1"],["icon","pi pi-user","size","large","shape","circle","tooltipPosition","top",3,"pTooltip"],["shape","circle","size","large","tooltipPosition","top",3,"label","pTooltip"],[1,"text-center"],[1,"font-semibold","text-xl"],["novalidate","",1,"grid","formgrid","p-fluid",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden"],["formControlName","conference_id","type","hidden"],["formControlName","room_id","type","hidden"],["formControlName","guestIds","type","hidden"],[1,"field","mb-4","col-12"],["for","conference",1,"font-medium","text-900"],["formControlName","conference","placeholder","V\xe1lasszon konferenci\xe1t...",3,"preselectIds","selectionLimit","showClear"],["class","block p-error",4,"ngIf"],["for","room_id",1,"font-medium","text-900"],["formControlName","room","placeholder","Szoba...",3,"filter","selectionLimit","preselectIds","emitOnPreselectId","showOnlyNotReserved","showClear"],["for","guest",1,"font-medium","text-900"],["formControlName","guests","placeholder","Vend\xe9g...",3,"filter","preselectIds","emitOnPreselectId","showOnlyNotReserved","showClear"],[1,"field","mb-4","col-6"],["for","startDate",1,"font-medium","text-900"],["id","startDate","formControlName","startDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["class","p-error",4,"ngIf"],["for","endDate",1,"font-medium","text-900"],["id","endDate","formControlName","endDate","dateFormat","yy-mm-dd","dataType","string","appendTo","body",3,"ngClass"],["for","status",1,"font-medium","text-900"],["formControlName","status","placeholder","St\xe1tusz...",3,"showClear"],["for","notes",1,"font-medium","text-900"],["id","notes","type","text","formControlName","notes","pInputTextarea","","rows","5"],[1,"block","p-error"],[1,"p-error"],[1,"flex","justify-content-end","ap-2"],["pButton","","pRipple","","label","M\xe9gsem","icon","pi pi-times",1,"p-button-outlined",3,"disabled","click"],["pButton","","pRipple","","label","Ment\xe9s","icon","pi pi-check",1,"p-button","ml-2",3,"disabled","click"],["pButton","","pRipple","","label","Nem","icon","pi pi-times",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Igen","icon","pi pi-check",1,"p-button","ml-2",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(r){return s.selected=r})("onLazyLoad",function(r){return s.onLazyLoad(r)}),e.YNc(5,Be,21,11,"ng-template",5),e.YNc(6,Qe,39,5,"ng-template",6),e.YNc(7,We,55,29,"ng-template",7),e.YNc(8,Xe,3,1,"ng-template",8),e.qZA()(),e.TgZ(9,"p-sidebar",9),e.NdJ("visibleChange",function(r){return s.sidebar=r})("onHide",function(){return s.onSidebarHide()})("onShow",function(){return s.onSidebarShow()}),e.YNc(10,et,2,1,"ng-template",6),e.YNc(11,ut,45,37,"ng-container",10),e.YNc(12,dt,3,2,"ng-template",11),e.qZA(),e.TgZ(13,"p-dialog",12),e.NdJ("visibleChange",function(r){return s.deleteDialog=r}),e.TgZ(14,"div",13),e._UZ(15,"i",14),e.qZA(),e.YNc(16,pt,2,0,"ng-template",11),e.qZA(),e.TgZ(17,"p-dialog",12),e.NdJ("visibleChange",function(r){return s.bulkDeleteDialog=r}),e.TgZ(18,"div",13),e._UZ(19,"i",14),e.TgZ(20,"span"),e._uU(21,"Biztosan t\xf6r\xf6lni akarja a kiv\xe1lasztott foglal\xe1sokat?"),e.qZA()(),e.YNc(22,mt,2,0,"ng-template",11),e.qZA()()(),e.TgZ(23,"p-blockUI",15),e._UZ(24,"p-progressSpinner"),e.qZA(),e._UZ(25,"p-toast")),2&t&&(e.xp6(3),e.Q6J("value",s.tableData)("rows",s.rowsPerPage)("totalRecords",s.totalRecords)("globalFilterFields",e.DdM(26,ht))("paginator",!0)("rowsPerPageOptions",s.rowsPerPageOptions)("showCurrentPageReport",!0)("selection",s.selected)("tableStyle",e.DdM(27,gt))("rowHover",!0)("lazy",!0),e.xp6(6),e.Q6J("visible",s.sidebar)("transitionOptions",".3s cubic-bezier(0, 0, 0.2, 1)")("fullScreen",s.isMobile)("blockScroll",!0),e.xp6(2),e.Q6J("ngIf",s.sidebar),e.xp6(2),e.Akn(e.DdM(28,ne)),e.Q6J("visible",s.deleteDialog)("modal",!0),e.xp6(4),e.Akn(e.DdM(29,ne)),e.Q6J("visible",s.bulkDeleteDialog)("modal",!0),e.xp6(6),e.Q6J("autoZIndex",!0)("blocked",s.loading))},dependencies:[h.mk,h.sg,h.O5,N.iA,Z.jx,N.lQ,N.fz,N.UA,N.Mo,d._Y,d.Fj,d.JJ,d.JL,d.On,d.sg,d.u,J.Hq,j.H,B.FN,Q.o,Y.V,V.G,q.b,P.Y,G.w,fe.n,_e.p,Te,Me,Je,D.u,X.q,ee.H,te.f,se.g,h.uU,A.X$],encapsulation:2})};U=(0,I.gn)([(0,re.k)()],U);let ft=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#s=this.\u0275inj=e.cJS({imports:[y.Bz.forChild([{path:"",component:U}]),y.Bz]})}return o})();var _t=l(6263),vt=l(9502),bt=l(5609),Ct=l(6651),St=l(7902),yt=l(1865),xt=l(2169),Tt=l(2285);let It=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#s=this.\u0275inj=e.cJS({providers:[k],imports:[h.ez,ft,N.U$,d.u5,d.UX,J.hJ,j.T,B.EV,Q.j,K.kW,Y.S,_t.W,vt.$,V.L,q.u,P.l,Tt.L,bt.Iu,D.z,Ct.q,X.F,ee.Q,St.JH,yt.cc,A.aw,te._8,xt.o,se.A]})}return o})()},746:(M,T,l)=>{l.d(T,{Q:()=>_});var h=l(5619),d=l(9397),y=l(6306),I=l(7398),S=l(2096),v=l(2029),w=l(8814);let _=(()=>{class b{constructor(a){this.apiService=a,this.apiURL=a.apiURL,this.data$=new h.X(null),this.createdGuest$=new h.X(null),this.message$=new h.X(null)}get guestObs(){return this.data$.asObservable()}get createdGuestObs(){return this.createdGuest$.asObservable()}get messageObs(){return this.message$.asObservable()}get(a,c,p,m){let f="";""!==p&&(f=""!=p.sortField?`sort=${p.sortField}&order=${1===p.sortOrder?"ASC":"DESC"}`:"");const F=""!==f&&""!==m?f+"&"+m:""!==f&&""===m?f:""===f&&""!==m?m:"";this.apiService.get(`guest/get/${a}/${c}${""!==F?"?"+F:""}`).subscribe({next:E=>{this.data$.next(E)},error:E=>{this.message$.next(E)}})}getBySearch(a,c,p){let m={};c&&c.sortField&&(m.sort=c.sortField,m.order=1===c.sortOrder?"ASC":"DESC"),p&&p.length>0&&(m.conferenceIds=p.join(",")),this.apiService.get(`guest/search/${encodeURIComponent(a)}`,{params:m}).subscribe({next:f=>{this.data$.next(f)},error:f=>{this.message$.next(f)}})}getBySearchQuery(a){this.apiService.get(`guest/searchquery?${a}`).subscribe({next:c=>{this.data$.next(c)},error:c=>{this.message$.next(c)}})}getBySearchQuery$(a){return this.apiService.get(`guest/searchquery?${a}`)}getByConferenceName(a){return this.apiService.get(`guest/searchquery?conferenceName=${a}`)}getByRFID(a){return this.apiService.get(`guest/getbyrfid/${a}`)}updateLastTagUsage(a){this.apiService.get(`guest/updatelasttagusage/${a}`).subscribe({next:c=>{},error:c=>{this.message$.next(c)}})}create(a,c){const p=new FormData;if(p.append("guest",JSON.stringify(a)),c&&c.length>0)for(const m of c){if(!m)return;p.append("idcard",m,m.name)}this.apiService.post("guest/create/",p).subscribe({next:m=>{this.createdGuest$.next(m.guest);const f=this.registrationToast(m.guest),F=this.emailStatusToast(m.email);this.message$.next(f),this.message$.next(F)},error:m=>{this.message$.next({severity:"error",summary:"Vend\xe9g r\xf6gz\xedt\xe9s sikertelen",detail:m?.errorMessage||m?.message||"Ismeretlen hiba t\xf6rt\xe9nt."})}})}update(a,c=[]){const p={...a};if(delete p.idcard,c&&c.length>0){const m=new FormData;m.append("guest",JSON.stringify(p));for(const f of c)f&&m.append("idcard",f,f.name);this.apiService.put(`guest/update/${a.id}`,m).subscribe({next:()=>{this.message$.next("success")},error:f=>{this.message$.next(f)}})}else p.idCardUploaded=0,this.apiService.put(`guest/update/${a.id}`,p).subscribe({next:()=>{this.message$.next("success")},error:m=>{this.message$.next(m)}})}updateGuest2(a){return this.apiService.put(`guest/update/${a.id}`,a).pipe((0,d.b)(()=>console.log(`updated guest id=${a.id}`)),(0,y.K)(this.handleError("updateGuest2")))}delete(a){this.apiService.delete(`guest/delete/${a.id}`).subscribe({next:c=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${a.lastName} ${a.firstName} t\xf6r\xf6lve`})},error:c=>{this.message$.next(c)}})}bulkdelete(a){let c={ids:a.map(p=>p.id)};this.apiService.post("guest/bulkdelete",c).subscribe({next:p=>{this.message$.next({severity:"success",summary:"Sikeres vend\xe9g t\xf6rl\xe9s",detail:`${a.length} vend\xe9g t\xf6r\xf6lve`})},error:p=>{this.message$.next(p)}})}searchGuestsForSelector$(a={}){const c=this.buildGuestQS(a);return this.apiService.get(`guest/searchquery?${c}`).pipe((0,I.U)(p=>p?p.rows??[]:[]))}buildGuestQS(a={}){const c=[];return null!=a.conferenceId&&c.push(`conferenceid=${encodeURIComponent(String(a.conferenceId))}`),"number"==typeof a.minBeds&&c.push(`minBeds=${a.minBeds}`),"boolean"==typeof a.climate&&c.push("climate="+(a.climate?1:0)),a.onlyNotReserved&&c.push("onlyNotReserved=true"),a.includeGuestIds?.length&&c.push(`includeGuestIds=${a.includeGuestIds.join(",")}`),a.enabled&&c.push("enabled=1"),c.join("&")}handleError(a="operation",c){return p=>(console.error(p),console.error(`${a} failed: ${p.message}`),(0,S.of)(c))}emailStatusToast(a){if(!a)return{severity:"warn",summary:"E-mail",detail:"E-mail st\xe1tusz ismeretlen."};switch(a.status){case"sent":return{severity:"success",summary:"E-mail",detail:"Visszaigazol\xf3 e-mail elk\xfcldve."};case"timeout":return{severity:"warn",summary:"E-mail",detail:"Az e-mail k\xfcld\xe9s id\u0151korl\xe1tot \xe9rt el."};case"failed":return{severity:"error",summary:"E-mail hiba",detail:a.message||"Az e-mail k\xfcld\xe9s nem siker\xfclt."};default:return{severity:"info",summary:"E-mail",detail:"E-mail st\xe1tusz: ismeretlen."}}}registrationToast(a){return{severity:"success",summary:"Vend\xe9g r\xf6gz\xedtve",detail:(a?.lastName&&a?.firstName?`${a.lastName} ${a.firstName}`:"Vend\xe9g")+" sikeresen r\xf6gz\xedtve."}}static#e=this.\u0275fac=function(c){return new(c||b)(v.LFG(w.s))};static#t=this.\u0275prov=v.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"})}return b})()},1116:(M,T,l)=>{function h(d,y){return I=>{const S=I.get(d)?.value,v=I.get(y)?.value;return S&&v&&(new Date(S)>new Date(v)||new Date(v)<new Date(S))?{dateRangeInvalid:!0}:null}}l.d(T,{W:()=>h})},6218:(M,T,l)=>{l.d(T,{A:()=>S,g:()=>I});var h=l(2029),d=l(6814),y=l(6223);let I=(()=>{class v{el;ngModel;control;cd;autoResize;onResize=new h.vpe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(_,b,x,a){this.el=_,this.ngModel=b,this.control=x,this.cd=a}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(_){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(_){this.autoResize&&this.resize(_)}onBlur(_){this.autoResize&&this.resize(_)}resize(_){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(_||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(b){return new(b||v)(h.Y36(h.SBq),h.Y36(y.On,8),h.Y36(y.a5,8),h.Y36(h.sBO))};static \u0275dir=h.lG2({type:v,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(b,x){1&b&&h.NdJ("input",function(c){return x.onInput(c)})("focus",function(c){return x.onFocus(c)})("blur",function(c){return x.onBlur(c)}),2&b&&h.ekj("p-filled",x.filled)("p-inputtextarea-resizable",x.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}})}return v})(),S=(()=>{class v{static \u0275fac=function(b){return new(b||v)};static \u0275mod=h.oAB({type:v});static \u0275inj=h.cJS({imports:[d.ez]})}return v})()}}]);