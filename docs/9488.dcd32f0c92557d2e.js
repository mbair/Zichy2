"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[9488],{9488:(Y,c,n)=>{n.r(c),n.d(c,{FoodCounterModule:()=>G});var u=n(6814),d=n(258),h=n(5219),o=n(6676),e=n(5879),f=n(746),v=n(3139),p=n(3763),m=n(4104);function C(a,g){1&a&&(e.TgZ(0,"button",16)(1,"span",17),e._uU(2," \xc9tel kiadva "),e.qZA()())}function b(a,g){1&a&&(e.TgZ(0,"button",18)(1,"span",17),e._uU(2," Nincs el\u0151fizetve "),e.qZA()())}function y(a,g){1&a&&(e.TgZ(0,"button",18)(1,"span",17),e._uU(2," M\xe1r \xe1tvett \xe9tel "),e.qZA()())}function M(a,g){1&a&&(e.TgZ(0,"button",18)(1,"span",17),e._uU(2," Jelenleg nincs \xe9tkeztet\xe9s "),e.qZA()())}o.locale("hu");let Z=(()=>{class a{constructor(i,t,s,r,l){this.router=i,this.guestService=t,this.mealService=s,this.logService=r,this.messageService=l,this.mealsNumber=0,this.loading=!1,this.alreadyRecievedFood=!1,this.canEat=!1,this.ageGroup="",this.scanTemp="",this.scannedCode="",this.backgroundColor="surface-ground",this.windowWidth=window.innerWidth||document.documentElement.clientWidth,this.windowHeight=window.innerHeight||document.documentElement.clientHeight}ngOnInit(){this.guestsObs$=this.guestService.guestObs,this.guestsObs$.subscribe(i=>{this.loading=!1,i&&(this.guests=i,this.setCurrentMealsNumber())}),this.mealService.mealChanged.subscribe(()=>{this.updateCurrentMeal()}),this.updateCurrentMeal(),this.resetGuest()}resetGuest(){this.ageGroup="",this.guest={lastName:"",firstName:"",diet:"",conferenceName:""}}keyEvent(i){if("Enter"===i.key)this.scannedCode=this.scanTemp,this.scanTemp="",console.log("scannedCode",this.scannedCode),this.logService.createLog({name:"FoodCounter scannedCode: "+this.scannedCode+" | Lang: "+navigator.language,capacity:0}),this.resetGuest(),this.getGuestByRFID(this.scannedCode);else if("\xf6"===i.key)this.scanTemp+="0";else{if(!/^[0-9]$/i.test(i.key))return;this.scanTemp+=i.key}}onResize(i){this.windowWidth=window.innerWidth||document.documentElement.clientWidth,this.windowHeight=window.innerHeight||document.documentElement.clientHeight}updateCurrentMeal(){this.isOpen=this.mealService.isOpen();let i=this.mealService.getMealNameByTime(new Date);i!==this.currentMeal&&(this.currentMeal=i,this.mealsNumber=0)}getGuestByRFID(i){this.guestService.getByRFID(i).subscribe({next:t=>{this.guest=t,this.setAgeGroup(this.guest.birthDate);let s=o(),r=o(new Date(t.dateOfArrival).setHours(0)),l=o(new Date(t.dateOfDeparture).setHours(24));if(r<=s&&s<=l&&(r.isSame(s,"day")&&("reggeli"==this.currentMeal?"reggeli"==t.firstMeal&&(this.canEat=!0):"eb\xe9d"==this.currentMeal?("reggeli"==t.firstMeal||"eb\xe9d"==t.firstMeal)&&(this.canEat=!0):"vacsora"==this.currentMeal&&("reggeli"==t.firstMeal||"eb\xe9d"==t.firstMeal||"vacsora"==t.firstMeal)&&(this.canEat=!0)),r!==s&&s!==l&&(this.canEat=!0),l.isSame(s,"day")&&("reggeli"==this.currentMeal&&("reggeli"==t.lastMeal||"eb\xe9d"==t.lastMeal||"vacsora"==t.lastMeal)&&(this.canEat=!0),"eb\xe9d"==this.currentMeal?("eb\xe9d"==t.lastMeal||"vacsora"==t.lastMeal)&&(this.canEat=!0):"vacsora"==this.currentMeal&&"vacsora"==t.lastMeal&&(this.canEat=!0))),this.alreadyRecievedFood=!1,t.lastRfidUsage){let H=new Date(t.lastRfidUsage),J=this.mealService.getMealNameByTime(H);this.currentMeal==J&&(this.alreadyRecievedFood=!0,this.logService.createLog({name:"FoodCounter Already received food: "+this.guest.lastName+" "+this.guest.firstName+" "+this.scannedCode+" | Lang: "+navigator.language,capacity:0}))}this.mealsNumber++,this.guest.lastRfidUsage=o().format("YYYY-MM-DD HH:mm:ss"),this.guestService.updateGuest(this.guest),this.backgroundColor=this.getDietColor(this.guest.diet)},error:t=>{console.error("Error:",t),404===t.status&&(this.guest={lastName:"ISMERETLEN",firstName:"ESZK\xd6Z"},this.logService.createLog({name:"FoodCounter Unknown Device: "+this.scannedCode+" | Lang: "+navigator.language,capacity:0}))}})}setAgeGroup(i){if(i){let t=o(new Date(i)),r=o.duration(o(new Date).diff(t)).asYears();this.ageGroup=r>=10?"feln\u0151tt":"gyermek"}else this.ageGroup="Hib\xe1s d\xe1tum"}setCurrentMealsNumber(){this.guests.map(i=>{if("G\xe1bris"!==i.lastName&&i.lastRfidUsage){let t=o(new Date(i.lastRfidUsage)),s=o();if(t.isSame(s,"day")){let r=this.mealService.getMealNameByTime(new Date(i.lastRfidUsage));this.currentMeal==r&&this.mealsNumber++}}})}getDietColor(i){switch(this.guest.diet){case"tejmentes":case"lakt\xf3zmentes":return"blue-400";case"glut\xe9nmentes":return"yellow-300";case"glut\xe9n-, lakt\xf3z-, tejmentes":return"red-500";case"veget\xe1ri\xe1nus":return"teal-500";case"nem k\xe9r \xe9tkez\xe9st":return"gray-300";default:return"gray-700"}}ngOnDestroy(){}static#e=this.\u0275fac=function(t){return new(t||a)(e.Y36(d.F0),e.Y36(f.Q),e.Y36(v.Q),e.Y36(p.$),e.Y36(h.ez))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["food-counter"]],hostBindings:function(t,s){1&t&&e.NdJ("keypress",function(l){return s.keyEvent(l)},!1,e.Jf7)("resize",function(l){return s.onResize(l)},!1,e.Jf7)},features:[e._Bn([h.ez])],decls:59,vars:16,consts:[[1,"relative","overflow-hidden","flex","flex-column","justify-content-center"],[1,"header",3,"ngClass"],[1,"p-1","font-medium","text-center","text-2xl","text-white","white-space-nowrap"],[1,"absolute","top-0","right-0","p-2","text-white","text-sm"],[1,"px-4","py-4",3,"ngClass"],[1,"grid"],[1,"col-12","md:col-12","lg:col-6","p-2"],[1,"info-box","surface-card","shadow-2","p-3","border-round","border-teal-500"],[1,"flex","justify-content-between"],[1,"block","text-500","text-xl","font-medium","mb-3"],[1,"text-900","font-medium","text-2xl"],[1,"grid","mt-1"],[1,"surface-card","shadow-2","border-round"],[1,"flex","align-items-center","justify-content-center","gap-2"],["class","flex align-items-center justify-content-center w-full h-fullgap-2 bg-teal-500 shadow-1 border-round-sm border-none cursor-pointer hover:bg-teal-600 transition-duration-200","style","min-height: 80px;",4,"ngIf"],["class","flex align-items-center justify-content-center w-full h-fullgap-2 bg-red-500 shadow-1 border-round-sm border-none cursor-pointer hover:bg-red-600 transition-duration-200","style","min-height: 80px;",4,"ngIf"],[1,"flex","align-items-center","justify-content-center","w-full","h-fullgap-2","bg-teal-500","shadow-1","border-round-sm","border-none","cursor-pointer","hover:bg-teal-600","transition-duration-200",2,"min-height","80px"],[1,"font-medium","text-2xl","text-white","white-space-nowrap"],[1,"flex","align-items-center","justify-content-center","w-full","h-fullgap-2","bg-red-500","shadow-1","border-round-sm","border-none","cursor-pointer","hover:bg-red-600","transition-duration-200",2,"min-height","80px"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"titlecase"),e.qZA(),e.TgZ(5,"div",3),e._uU(6),e.qZA()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div")(13,"span",9),e._uU(14,"Vend\xe9g"),e.qZA(),e.TgZ(15,"div",10),e._uU(16),e.qZA()()()()(),e.TgZ(17,"div",6)(18,"div",7)(19,"div",8)(20,"div")(21,"span",9),e._uU(22,"\xc9trend"),e.qZA(),e.TgZ(23,"div",10),e._uU(24),e.qZA()()()()()(),e.TgZ(25,"div",11)(26,"div",6)(27,"div",7)(28,"div",8)(29,"div")(30,"span",9),e._uU(31,"Koroszt\xe1ly"),e.qZA(),e.TgZ(32,"div",10),e._uU(33),e.qZA()()()()(),e.TgZ(34,"div",6)(35,"div",7)(36,"div",8)(37,"div")(38,"span",9),e._uU(39,"Konferencia"),e.qZA(),e.TgZ(40,"div",10),e._uU(41),e.qZA()()()()()(),e.TgZ(42,"div",11)(43,"div",6)(44,"div",7)(45,"div",8)(46,"div")(47,"span",9),e._uU(48,"M\xe1r kiadott \xe9telek sz\xe1ma"),e.qZA(),e.TgZ(49,"div",10),e._uU(50),e.qZA()()()()(),e.TgZ(51,"div",6)(52,"div",12)(53,"div",13),e.YNc(54,C,3,0,"button",14),e.YNc(55,b,3,0,"button",15),e.YNc(56,y,3,0,"button",15),e.YNc(57,M,3,0,"button",15),e.qZA()()()()()(),e._UZ(58,"p-toast")),2&t&&(e.xp6(1),e.Q6J("ngClass",s.isOpen?"bg-teal-500":"bg-red-500"),e.xp6(2),e.hij(" ",s.isOpen?e.lcZ(4,14,s.currentMeal):"Jelenleg nincs \xe9tkeztet\xe9s!"," "),e.xp6(3),e.hij(" ",s.scannedCode," "),e.xp6(1),e.Q6J("ngClass","bg-"+s.backgroundColor),e.xp6(9),e.AsE(" ",s.guest.lastName," ",s.guest.firstName,"\xa0 "),e.xp6(8),e.hij("",s.guest.diet,"\xa0"),e.xp6(9),e.hij("",s.ageGroup,"\xa0"),e.xp6(8),e.hij("",s.guest.conferenceName,"\xa0"),e.xp6(9),e.Oqu(s.mealsNumber),e.xp6(4),e.Q6J("ngIf",s.isOpen&&s.canEat&&!s.alreadyRecievedFood),e.xp6(1),e.Q6J("ngIf",s.isOpen&&!s.canEat),e.xp6(1),e.Q6J("ngIf",s.isOpen&&s.canEat&&s.alreadyRecievedFood),e.xp6(1),e.Q6J("ngIf",!s.isOpen))},dependencies:[u.mk,u.O5,m.FN,u.rS]})}return a})();var A=n(9502);let T=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275mod=e.oAB({type:a});static#s=this.\u0275inj=e.cJS({imports:[d.Bz.forChild([{path:"",component:Z}]),A.$,d.Bz]})}return a})();var N=n(707),w=n(1913),x=n(1567),F=n(6223),U=n(3714),D=n(8057),S=n(6760),O=n(3965),R=n(4532),z=n(3722),j=n(1865),B=n(3259);let G=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275mod=e.oAB({type:a});static#s=this.\u0275inj=e.cJS({imports:[u.ez,T,F.UX,U.j,D.nD,S._8,O.kW,R.d,z.O,N.hJ,j.cc,d.Bz,w.l,x.h,m.EV,B.z]})}return a})()}}]);