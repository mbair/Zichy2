"use strict";(self.webpackChunknfc_reserve=self.webpackChunknfc_reserve||[]).push([[9474],{9474:(b,_,a)=>{a.d(_,{w:()=>s});var o=a(2029),f=a(6223),S=a(7394),g=a(219),C=a(5219),u=a(6814),p=a(4055),O=a(9515);const y=["conferenceSelector"];function d(r,c){1&r&&o._uU(0),2&r&&o.hij(" ",c.$implicit.name," ")}function v(r,c){1&r&&o._uU(0),2&r&&o.hij(" ",c.$implicit.name," ")}const e={id:-1,name:"\u2014 Nincs, vagy nincs enged\xe9lyezett konferenci\xe1ja \u2014",__none__:!0};let s=(()=>{class r{set preselectIds(t){const n=(Array.isArray(t)?t:null!=t?[t]:[]).map(l=>"string"==typeof l?Number(l):l).filter(l=>Number.isFinite(l));this._pendingSelectIds=n.length?n:void 0,this.preselectByIds()}runSilently(t){this.suppress++;try{return t()}finally{this.suppress--}}constructor(t,i,n){this.conferenceService=t,this.messageService=i,this.cdr=n,this.selectFirstOption=!1,this.showClear=!0,this.showNoneOption=!0,this.style={},this.styleClass="",this.panelStyleClass="",this.disabledOptions=[],this.emitOnSelectFirstOption=!1,this.emitOnPreselectId=!1,this.emitOnWriteValue=!1,this.change=new o.vpe,this.loading=!0,this.disabled=!1,this.conferences=[],this.originalConferences=[],this.selectedConferences=[],this.subscriptions=new S.w0,this.suppress=0,this.isNone=l=>!!l?.__none__||-1===l?.id,this.getNone=()=>e,this.onChange=l=>{},this.onTouched=()=>{}}ngOnInit(){const t=this.conferenceService.getSelector$({sort:"beginDate",order:"asc",enabled:1}).subscribe({next:i=>{const n=i??[],l=this.showNoneOption?[e,...n]:[...n];this.conferences=l,this.originalConferences=[...l],this.syncSelectedConferences(),this.handleSelectFirstOption(),this.updateDisabledFlags(),this.preselectByIds(),this.loading=!1},error:()=>{this.conferences=[],this.originalConferences=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load conferences. Please try again later."})}});this.subscriptions.add(t)}ngOnChanges(t){t.disabledOptions&&this.originalConferences.length>0&&this.updateDisabledFlags(),t.preselectIds&&this.preselectByIds()}ngOnDestroy(){this.subscriptions.unsubscribe()}updateDisabledFlags(){const t=Array.isArray(this.disabledOptions)?this.disabledOptions:[];this.conferences=this.originalConferences.map(i=>({...i,disabled:!this.isNone(i)&&t.some(n=>n?.id===i.id)})),this.cdr.markForCheck()}setSelection(t,i){const n=i?.source??"programmatic";this.runSilently(()=>{this.selectedConferences=this.normalizeSelection(t)}),i?.emit?this.emit(this.selectedConferences,n,!0):this.cdr.markForCheck()}handleSelectFirstOption(){if(!this.selectFirstOption||this.selectedConferences.length||!this.conferences.length)return;const t=this.conferences.find(i=>!this.isNone(i)&&!i.disabled);t?(this.runSilently(()=>{this.selectedConferences=[t]}),this.emitOnSelectFirstOption?this.emit(this.selectedConferences,"auto-select-first",!0):this.cdr.markForCheck()):this.cdr.markForCheck()}preselectByIds(){if(!this.conferences?.length||!this._pendingSelectIds?.length)return;const t=new Set(this._pendingSelectIds),i=this.conferences.filter(n=>!this.isNone(n)&&t.has(Number(n.id)));this.runSilently(()=>{this.selectedConferences=i.slice(0,this.selectionLimit??i.length),this.conferenceSelectorRef?.writeValue(this.selectedConferences)}),this.emitOnPreselectId?this.emit(this.selectedConferences,"preselect-id",!0):this.cdr.markForCheck()}setDisabledState(t){this.disabled=t}syncSelectedConferences(){const t=Array.isArray(this.selectedConferences)?this.selectedConferences:[];this.selectedConferences=this.conferences.filter(i=>t.some(n=>n?.id===i?.id)),this.onChange(this.selectedConferences),this.cdr.markForCheck()}onSelectionChange(t){const i=Array.isArray(t?.value)?t.value:[];this.selectedConferences=this.normalizeSelection(i),this.emit(this.selectedConferences,"user"),1==this.selectionLimit&&this.selectedConferences?.length>=1&&setTimeout(()=>this.conferenceSelectorRef?.hide())}onSelectionClear(){this.runSilently(()=>{this.selectedConferences=[],this.conferenceSelectorRef?.writeValue([])}),this.emit(this.selectedConferences,"user",!0)}normalizeSelection(t){const i=Array.isArray(t)?t:[];return i.some(m=>this.isNone(m))?[this.getNone()]:i.slice(0,this.selectionLimit??i.length)}emit(t,i,n=!1){this.suppress&&!n||(this.onChange(t),this.onTouched(),this.change.emit({value:t,source:i}),this.cdr.markForCheck())}writeValue(t){const i=Array.isArray(t)?t:t?[t]:[];this.runSilently(()=>{this.selectedConferences=this.normalizeSelection(i)}),this.emitOnWriteValue?this.emit(this.selectedConferences,"programmatic",!0):this.cdr.markForCheck()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}static#e=this.\u0275fac=function(i){return new(i||r)(o.Y36(g.Z),o.Y36(C.ez),o.Y36(o.sBO))};static#t=this.\u0275cmp=o.Xpm({type:r,selectors:[["app-conference-selector"]],viewQuery:function(i,n){if(1&i&&o.Gf(y,5),2&i){let l;o.iGM(l=o.CRH())&&(n.conferenceSelectorRef=l.first)}},inputs:{selectionLimit:"selectionLimit",selectFirstOption:"selectFirstOption",placeholder:"placeholder",showClear:"showClear",showNoneOption:"showNoneOption",style:"style",styleClass:"styleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",disabledOptions:"disabledOptions",emitOnSelectFirstOption:"emitOnSelectFirstOption",emitOnPreselectId:"emitOnPreselectId",emitOnWriteValue:"emitOnWriteValue",preselectIds:"preselectIds"},outputs:{change:"change"},features:[o._Bn([{provide:f.JU,useExisting:(0,o.Gpc)(()=>r),multi:!0}]),o.TTD],decls:6,vars:16,consts:[[1,"w-full",3,"ngStyle","ngClass"],["dataKey","id","optionLabel","name","optionDisabled","disabled","scrollHeight","400px","appendTo","body","display","chip",1,"multiselect-custom-virtual-scroll",3,"options","ngModel","disabled","selectionLimit","placeholder","emptyMessage","virtualScroll","virtualScrollItemSize","showClear","resetFilterOnHide","ngModelChange","onChange","onClear"],["conferenceSelector",""],["pTemplate","item"],["pTemplate","selectedItem"]],template:function(i,n){1&i&&(o.TgZ(0,"div",0)(1,"p-multiSelect",1,2),o.NdJ("ngModelChange",function(m){return n.selectedConferences=m})("onChange",function(m){return n.onSelectionChange(m)})("onClear",function(){return n.onSelectionClear()}),o.ALo(3,"translate"),o.YNc(4,d,1,1,"ng-template",3),o.YNc(5,v,1,1,"ng-template",4),o.qZA()()),2&i&&(o.Q6J("ngStyle",n.style)("ngClass",n.styleClass),o.xp6(1),o.Akn(n.style),o.s9C("emptyMessage",o.lcZ(3,14,"Nincs tal\xe1lat...")),o.Q6J("options",n.conferences)("ngModel",n.selectedConferences)("disabled",n.disabled)("selectionLimit",n.selectionLimit)("placeholder",n.placeholder)("virtualScroll",!0)("virtualScrollItemSize",43)("showClear",n.showClear)("resetFilterOnHide",!0))},dependencies:[u.mk,u.PC,f.JJ,f.On,C.jx,p.NU,O.X$],encapsulation:2,changeDetection:0})}return r})()},219:(b,_,a)=>{a.d(_,{Z:()=>y});var o=a(5619),f=a(7398),S=a(6306),g=a(2096),C=a(940),u=a(9862),p=a(2029),O=a(8814);let y=(()=>{class d{constructor(e,s){this.apiService=e,this.http=s,this.apiURL=e.apiURL,this.data$=new o.X(null),this.message$=new o.X(null)}get conferenceObs(){return this.data$.asObservable()}get messageObs(){return this.message$.asObservable()}get(e,s,r,c){const t=localStorage.getItem("userrole"),i=localStorage.getItem("userid");if("Szervezo"===t&&i){const h=`organizer_user_id=${i}`;c=c?`${c}&${h}`:h}c.includes("enabled=")||(c=c?`${c}&enabled=1`:"enabled=1");let n="";""!==r&&(n=`sort=${r.sortField&&""!==r.sortField?r.sortField:"beginDate"}&order=${1===r.sortOrder?"ASC":"DESC"}`);const l=""!==n&&""!==c?n+"&"+c:""!==n&&""===c?n:""===n&&""!==c?c:"";this.apiService.get(`conference/get/${e}/${s}${""!==l?"?"+l:""}`).subscribe({next:h=>{this.data$.next(h)},error:h=>{this.message$.next(h)}})}getBySearch(e,s){let r="";""!==s&&(r=""!=s.sortField?`?sort=${s.sortField}&order=${1===s.sortOrder?"ASC":"DESC"}`:""),this.apiService.get(`conference/search/${e}${r}`).subscribe({next:c=>{this.data$.next(c)},error:c=>{this.message$.next(c)}})}getBySearchQuery(e){this.apiService.get(`conference/searchquery?${e}`).subscribe({next:s=>{this.data$.next(s)},error:s=>{this.message$.next(s)}})}create(e){this.apiService.post("conference/create/",e).subscribe({next:s=>{this.message$.next({severity:"success",summary:"Sikeres konferencia r\xf6gz\xedt\xe9s",detail:`${e.name} r\xf6gz\xedtve`})},error:s=>{this.message$.next(s)}})}update(e){this.apiService.put(`conference/update/${e.id}`,e).subscribe({next:()=>{this.message$.next({severity:"success",summary:"Sikeres konferencia m\xf3dos\xedt\xe1s",detail:`${e.name} m\xf3dos\xedtva`})},error:s=>{this.message$.next(s)}})}delete(e){this.apiService.delete(`conference/delete/${e.id}`).subscribe({next:s=>{this.message$.next({severity:"success",summary:"Sikeres konferencia t\xf6rl\xe9s",detail:`${e.name} t\xf6r\xf6lve`})},error:s=>{this.message$.next(s)}})}bulkdelete(e){let s={ids:e.map(r=>r.id)};this.apiService.post("conference/bulkdelete",s).subscribe({next:r=>{this.message$.next({severity:"success",summary:"Sikeres konferencia t\xf6rl\xe9s",detail:`${e.length} konferencia t\xf6r\xf6lve`})},error:r=>{this.message$.next(r)}})}getById(e){return this.apiService.get(`conference/getbyid/${e}`)}isSlugValid(e){return this.get(0,20,"slug=","sort"),this.data$.pipe((0,f.U)(s=>s&&s.data&&s.rows.length>0),(0,S.K)(()=>(0,g.of)(!1)))}assignRoomsToConference(e,s){return this.apiService.post(`conferencesroom/addroom/${e.id}`,{roomIds:s})}removeRoomsFromConference(e,s){return this.apiService.post(`conferencesroom/removeroom/${e}`,{roomIds:s})}saveFormFieldInfos(e){this.apiService.post(`conference/saveFormFieldInfos/${e.conferenceId}`,e.fields).subscribe({next:s=>{this.message$.next({severity:"success",summary:"Mez\u0151 inform\xe1ci\xf3k mentve",detail:"\u0170rlap mez\u0151 inform\xe1ci\xf3k sikeresen mentve"})},error:s=>{this.message$.next(s)}})}getSelector$(e={}){const r=this.buildSelectorParams(e).toString();return this.apiService.get("conference/selector"+(r?`?${r}`:"")).pipe((0,C.d)(1))}clearSelectorCache(){this.selectorCache$=void 0}buildSelectorParams(e){let s=new u.LE;if(void 0!==e.enabled){const r="boolean"==typeof e.enabled?e.enabled?"1":"0":String(e.enabled);s=s.set("enabled",r)}else s=s.set("enabled","1");return e.sort&&(s=s.set("sort",e.sort)),e.order&&(s=s.set("order",e.order)),s}getConferenceStatsByIds(e){if(!e||0===e.length)return(0,g.of)({});const r=(new u.LE).set("ids",e.join(",")).toString();return this.apiService.get(`conference/stats?${r}`)}getConferenceStat(e){return this.getConferenceStatsByIds([e]).pipe((0,f.U)(s=>s[e]??s[String(e)]??{guests:0,beds:0}))}static#e=this.\u0275fac=function(s){return new(s||d)(p.LFG(O.s),p.LFG(u.eN))};static#t=this.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);